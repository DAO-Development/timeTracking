(function(e){function t(t){for(var n,r,o=t[0],l=t[1],c=t[2],d=0,m=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&m.push(s[r][0]),s[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(m.length)m.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,o=1;o<a.length;o++){var l=a[o];0!==s[l]&&(n=!1)}n&&(i.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},s={app:0},i=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/static/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0226":function(e,t){throw new Error("Module parse failed: Unexpected character '�' (1:0)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n(Source code omitted for this binary file)")},"034f":function(e,t,a){"use strict";a("85ec")},"0798":function(e,t,a){e.exports=a.p+"img/logo.png"},"0b79":function(e,t,a){e.exports=a.p+"img/A3DPhhAL6Zg.png"},1577:function(e,t,a){e.exports=a.p+"img/user1.png"},"18f3":function(e,t){throw new Error("Module parse failed: Unexpected token (1:0)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n(Source code omitted for this binary file)")},"1c9a":function(e,t){throw new Error("Module parse failed: Unexpected token (1:0)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n(Source code omitted for this binary file)")},2254:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIcAAABmCAYAAADh/4ItAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAS6SURBVHgB7d3RddNIFAbge0fSObwhkgJWCexz0gGiAuhgsxVkqQDogFSw2Q6WCvB2kC1g12oAUN44x9ZcZmTLUcDX9oNGZpz/OyexLI+kY83v0cgj25w9OfkozOdMVJP/E/a3LWaq/K2Q3MricXLlvljm23a64WpVlrhOaNaW+erL1tVqPRBYXuSP3P/u7pzSwt9KIn5eO9+IPHZ1+MRPuzrMXX09bgsL5dIty1Ks1ulmpi4MH1wISror0H98hXvTbkPdBPU1ZNrbzP87Ou3WUS+Dt1zpXaDa9S4DuCh7F8LlNldBXKpdIH8IXUrz6vt5YwX0UV4U6+Z3FdTnKuvevH6FefcqrV3gXsWtKnrxkC97d7/prZfJLhe5v/1+HUpXu0zrMV2xT13GZuru5ASwJNa+MP7V5VI0IYCOUDWvq8niOCByRQAdpsniZik5Li66aWP50nUGzgkeBtdSWGPfdXezhiZf66pKuxnNp+q6mzb5ae5ig3A8EML0V7/+u86tWVd4RvbapQmnog8EW/v3uvlrw9F2Ul2aCA6fO6TM6upm3UNGXUhJExyYZedzHTUc/lTGncVMCA6a3dAIpJsWFJF37qzlHxqYe+fucvubbnIjxB8oEBZ57p5buaHIVf/d2uG3v8s+8MLuh6au1HUz7UF2dDJ1my42l+Lr2ef/fqdA0qPTt+7Jv9EeT6w98adzFMhu+8ALux82MQSgQDhAhXCACuEAFcIBKoQDVAgHqNKdSuVFkSRJSUOxkm99h0VskRw/vaBQrD3z1yhqGjIv3fZvKZRd9oEXYD9w07QX82wtRztI82clG/uR4DC4YZHZl+mLbcVwWAEVwgEqhANUCAeodjpbYZrXIjyhgTDx+abhahHxVyYd/GWK7YeStlzILe3lmnJDQ26X+d+dytEebBuuDj1c/rPY7SzwoQ3ZC+PTdRHYTzjw0csooEMKKoQDVAgHqBAOUCEcoBo9HNo34cDPBy0HqBAOUCEcoEI4QDV6OBrCW+exGD0c4sYiCaKAwwqoEA5QIRygQjhANX6HdPFN/hCBPbQcDcIRCRxWQIVwgArhABXCAarRw2Eagw5pJMY/lTUYeIsFDiugQjhAhXCACuEA1T7CgQ5pJEYPBxMG3mKBwwqoEA5QIRygQjhANX44xPxCEAW0HKBCOECFcIAK4QAVwgGq8cPBtiCIAloOUCEcoEI4QIVwgArhANUewsEFQRTQcoAK4QAVwgEqhANUCAeoRg0Hfk4jLmg5QIVwgArhABXCAapRw4Gf04jLqOHAz2nEBYcVUCEcoEI4QIVwgGrcDil+TiMqKQWS5b+ey3df8cRiy12WnRGdpfmzoj9vTvMbqquaYuXGlVJKi/4sJnu2bTG3z3K3L8r+vLH2BVMIbkdkxkxpWK9nn/9/T5HKjk6mA14i+d7ti9cUWJDDSpZQSUMTeUmRyo6Li4Gvnf2DRhjhDhIOsTx8RTKXaV6UFCPhNzSwjPlPCixIOJi4pADYmFcUmeT46asgV9yP8GIZPBxt54mDjaH85prTqM54jKVLCoR5+Bapb/iWw9iQr+7cdXQvKBa+X8BSUiiBW4/Bw+FOf55TSBF1TDPDbykwd6gN1vf4BngtQpdVOF3ZAAAAAElFTkSuQmCC"},2977:function(e,t,a){e.exports=a.p+"img/avatar.jpg"},"3abd":function(e,t){throw new Error("Module parse failed: Unexpected token (1:0)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n(Source code omitted for this binary file)")},4131:function(e,t){throw new Error("Module parse failed: Unexpected character '' (1:2)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n(Source code omitted for this binary file)")},"44b9":function(e,t,a){e.exports=a.p+"img/dao-logo-black.png"},"462e":function(e,t){throw new Error("Module parse failed: Unexpected token (1:11)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n> Django==3.1.7\n| django-cors-headers==3.7.0\n| django-rest-swagger==2.2.0")},"536c":function(e,t){throw new Error("Module parse failed: Unexpected token (1:0)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n(Source code omitted for this binary file)")},5469:function(e,t,a){var n={"./media/accounting/TZ.pdf":"3abd","./media/accounting/TimeTracking.vpp":"c5df","./media/accounting/clients/TZ.pdf":"bc3f","./media/accounting/clients/questions.txt":"8396","./media/accounting/clients/Календарный план.xlsx":"4131","./media/accounting/clients/Схема переходов TimeTrack.PNG":"0226","./media/accounting/requirements.txt":"462e","./media/accounting/отчет 1.zip":"75a7","./media/cheque/20211226_153257 - Гендальф Серый.jpg":"98c6","./media/cheque/TZ.pdf":"1c9a","./media/cheque/_DSC0121.JPG":"6d44","./media/cheque/itmo_logo_white_rus.png":"b700","./media/cheque/pic_1.jpg":"a0e2","./media/clients/dao-logo-black.png":"44b9","./media/clients/number.png":"2254","./media/contacts/9445bb5d2187e2812c79db70cf.jpg":"a637","./media/contacts/avatar.jpg":"937c","./media/documents/TZ.pdf":"18f3","./media/documents/test1.pdf":"536c","./media/news/9445bb5d2187e2812c79db70cf.jpg":"c887","./media/news/about.png":"7f19","./media/news/avatar.jpg":"2977","./media/news/dao_simple-page.png":"a42f","./media/news/reviews1.png":"8083","./media/objects/A3DPhhAL6Zg.png":"0b79","./media/users/9445bb5d2187e2812c79db70cf.jpg":"8b2d","./media/users/admin@mail.ru.pdf":"d40c","./media/users/ivanov@mail.ru.pdf":"b153","./media/users/logo.png":"0798","./media/users/user1.png":"1577"};function s(e){var t=i(e);return a(t)}function i(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=i,e.exports=s,s.id="5469"},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-container",{staticClass:"flex-main"},[e.auth?a("Menu",{staticClass:"flex-sidebar"}):e._e(),a("router-view",{key:e.$route.path,on:{"set-auth":e.setAuth,"set-not-auth":e.setNotAuth,"set-admin":e.setAdmin,"load-functions":e.loadFunctions,"load-settings":e.loadSettings}})],1)],1)},i=[],r=a("1157"),o=a.n(r),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"menu"},[n("div",{staticClass:"menu-burger",on:{click:e.showMobileMenu}},[n("div",{staticClass:"menu-burger__item"}),n("div",{staticClass:"menu-burger__item"}),n("div",{staticClass:"menu-burger__item"})]),n("div",{staticClass:"menu__profile",on:{click:function(t){return e.goPage(0)}}},[null!=e.user.photo_path?n("v-img",{attrs:{"lazy-src":a("5469")("./media"+e.user.photo_path),src:a("5469")("./media"+e.user.photo_path)}}):e._e()],1),n("v-navigation-drawer",{staticClass:"menu-list",attrs:{permanent:"",color:"primary"}},[n("v-list",[n("v-list-item-group",{model:{value:e.selectedItem,callback:function(t){e.selectedItem=t},expression:"selectedItem"}},[n("v-list-item",{on:{click:function(t){return e.goPage(0)}}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-home")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Главная")])],1)],1),n("v-list-item",{on:{click:function(t){return e.goPage(1)}}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-bullhorn")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Новости")])],1),n("v-list-item-icon",[n("v-icon",[e._v("$tile")])],1)],1),n("v-list-item",{on:{click:function(t){return e.goPage(2)}}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-account")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Профиль")])],1),n("v-list-item-icon",[n("v-icon",[e._v("mdi-pencil")])],1)],1),-1!==e.$parent.$parent.read.indexOf("Работники")?n("v-list-item",{on:{click:function(t){return e.goPage(3)}}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-account-group")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Работники")])],1),n("v-list-item-icon",[n("v-icon",[e._v("$tile")])],1)],1):e._e(),-1!==e.$parent.$parent.read.indexOf("Клиенты")?n("v-list-item",{on:{click:function(t){return e.goPage(4)}}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-handshake")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Клиенты")])],1),n("v-list-item-icon",[n("v-icon",[e._v("$tile")])],1)],1):e._e(),-1!==e.$parent.$parent.read.indexOf("Контакты")?n("v-list-item",{on:{click:function(t){return e.goPage(5)}}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-account-box")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Контакты")])],1),n("v-list-item-icon",[n("v-icon",[e._v("$tile")])],1)],1):e._e(),-1!==e.$parent.$parent.read.indexOf("Объекты")?n("v-list-item",{on:{click:function(t){return e.goPage(6)}}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-crane")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Объекты")])],1),n("v-list-item-icon",[n("v-icon",[e._v("$tile")])],1)],1):e._e(),-1!==e.$parent.$parent.read.indexOf("Бухгалтерия")?n("v-list-group",{scopedSlots:e._u([{key:"activator",fn:function(){return[n("v-list-item-icon",[n("v-icon",[e._v("mdi-cash")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Бухгалтерия")])],1)]},proxy:!0}],null,!1,2187881917)},[n("v-list-item",{on:{click:function(t){return e.$router.push({name:"Purchases"})}}},[n("v-list-item-content",[n("v-list-item-title",[e._v("Покупки")])],1)],1),n("v-list-item",{on:{click:function(t){return e.$router.push({name:"Sales"})}}},[n("v-list-item-content",[n("v-list-item-title",[e._v("Продажи")])],1)],1),n("v-list-item",{on:{click:function(t){return e.$router.push({name:"Accounting",params:{type:"reports"}})}}},[n("v-list-item-content",[n("v-list-item-title",[e._v("Отчеты")])],1)],1),n("v-list-item",{on:{click:function(t){return e.$router.push({name:"Accounting",params:{type:"extracts"}})}}},[n("v-list-item-content",[n("v-list-item-title",[e._v("Выписки")])],1)],1),n("v-list-item",{on:{click:function(t){return e.$router.push({name:"Accounting",params:{type:"documents"}})}}},[n("v-list-item-content",[n("v-list-item-title",[e._v("Документы")])],1)],1),n("v-list-item",{on:{click:function(t){return e.$router.push({name:"Accounting",params:{type:"contracts"}})}}},[n("v-list-item-content",[n("v-list-item-title",[e._v("Договора с клиентами")])],1)],1),n("v-list-item",{on:{click:function(t){return e.$router.push({name:"Accounting",params:{type:"property"}})}}},[n("v-list-item-content",[n("v-list-item-title",[e._v("Документы на собственность")])],1)],1),n("v-list-item",{on:{click:function(t){return e.$router.push({name:"Offers"})}}},[n("v-list-item-content",[n("v-list-item-title",[e._v("Ценовые предложения")])],1)],1),n("v-list-item",{on:{click:function(t){return e.$router.push({name:"Waybill"})}}},[n("v-list-item-content",[n("v-list-item-title",[e._v("Путевые листы")])],1)],1)],1):e._e(),n("v-list-item",{on:{click:function(t){return e.$router.push({name:"Calendar"})}}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-calendar")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Календарь")])],1)],1),n("v-list-item",{on:{click:function(t){return e.goPage(8)}}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-cog-outline")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Настройки")])],1)],1),n("v-list-item",{on:{click:function(t){return e.goPage(9)}}},[n("v-list-item-icon",[n("v-icon",[e._v("$support")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Поддержка")])],1)],1),n("v-list-item",{on:{click:function(t){return e.goPage(10)}}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-calendar-range")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Календарь")])],1)],1),n("v-list-item",{on:{click:function(t){return e.goPage(11)}}},[n("v-list-item-icon",[n("v-icon",[e._v("mdi-exit-to-app")])],1),n("v-list-item-content",[n("v-list-item-title",[e._v("Выход")])],1)],1)],1)],1)],1)],1)},c=[],u=(a("b0c0"),{name:"Menu",created:function(){switch(console.log("init Menu"),o()(window).width()<="568"&&this.loadUser(),console.log(this.$router.getMatchedComponents()[0].name),this.$router.getMatchedComponents()[0].name){case"Index":this.selectedItem=0,this.page="Главная";break;case"News":this.selectedItem=1,this.page="Новости";break;case"Profile":this.selectedItem=2,this.page="Профиль";break;case"Workers":this.selectedItem=this.$parent.$parent.read.indexOf("Работники")+1+2,this.page="Работники";break;case"Clients":this.selectedItem=this.$parent.$parent.read.indexOf("Клиенты")+1+2,this.page="Клиенты";break;case"Contacts":this.selectedItem=this.$parent.$parent.read.indexOf("Контакты")+1+2,this.page="Контакты";break;case"Objects":this.selectedItem=this.$parent.$parent.read.indexOf("Объекты")+1+2,this.page="Объекты";break;case"Accounting":this.selectedItem=this.$parent.$parent.read.indexOf("Бухгалтерия")+1+2,this.page="Бухгалтерия";break;case"Settings":this.selectedItem=this.$parent.$parent.read.length+3,this.page="Настройки";break;case"Support":this.selectedItem=this.$parent.$parent.read.length+4,this.page="Поддержка";break;case"Calendar":this.selectedItem=this.$parent.$parent.read.length+5,this.page="Календарь";break}console.log(this.selectedItem),console.log(this.page)},data:function(){return{user:{},selectedItem:0,items:[{text:"Объекты",name:"Objects"},{text:"Работники",name:"Workers"},{text:"Клиенты",name:"Clients"},{text:"Контакты",name:"Contacts"}],page:""}},methods:{goPage:function(e){if(console.log("go page"),e!==this.selectedItem)switch(o()(".menu").hasClass("open")&&o()(".menu").removeClass("open"),e){case 0:this.$router.push({name:"Index"});break;case 1:this.$router.push({name:"News"});break;case 2:this.$router.push({name:"Profile"});break;case 3:this.$router.push({name:"Workers"});break;case 4:this.$router.push({name:"Clients"});break;case 5:this.$router.push({name:"Contacts"});break;case 6:this.$router.push({name:"Objects"});break;case 7:break;case 8:this.$router.push({name:"Settings"});break;case 9:break;case 10:break;case 11:this.logout();break}},logout:function(){var e=this;o.a.ajax({url:this.$hostname+"auth/token/logout/",type:"POST",headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))},success:function(){localStorage.clear(),sessionStorage.clear(),window.location="/"},error:function(t){e.alertError=!0,e.alertMsg="Непредвиденная ошибка",console.log(t.data)}})},showMobileMenu:function(){console.log("open menu"),o()(".menu").hasClass("open")?o()(".menu").removeClass("open"):o()(".menu").addClass("open")},loadUser:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/user",type:"GET",headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))},success:function(t){e.user=t.data.data,console.log(e.user.photo_path)},error:function(t){500===t.status?console.log("Ошибка соединения с сервером"):401===t.status?e.$refresh():console.log("Непредвиденная ошибка")}})}}}),d=u,m=a("2877"),f=a("6544"),v=a.n(f),h=a("132d"),p=a("adda"),_=a("8860"),b=a("56b0"),g=a("da13"),k=a("5d23"),w=a("1baa"),x=a("34c3"),C=a("f774"),y=Object(m["a"])(d,l,c,!1,null,"045c3571",null),$=y.exports;v()(y,{VIcon:h["a"],VImg:p["a"],VList:_["a"],VListGroup:b["a"],VListItem:g["a"],VListItemContent:k["a"],VListItemGroup:w["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VNavigationDrawer:C["a"]}),n["a"].prototype.$hostname="https://shielded-plateau-96200.herokuapp.com/",n["a"].prototype.$refresh=function(){localStorage.clear(),sessionStorage.clear(),this.$emit("set-not-auth"),o.a.ajaxSetup({headers:{Authorization:""}}),this.$router.push({name:"Index"})},n["a"].prototype.$toggleTheme=function(e,t){switch(console.log("toggleTheme global"),this.$vuetify.lang.current=t,e){case"dark":this.$vuetify.theme.light=!1,this.$vuetify.theme.dark=!0;break;case"light":this.$vuetify.theme.dark=!1,this.$vuetify.theme.light=!0,this.$vuetify.theme.themes.light.primary="#3D6FB6";break;default:this.$vuetify.theme.dark=!1,this.$vuetify.theme.light=!0,this.$vuetify.theme.themes.light.primary=e;break}};var D={name:"App",components:{Menu:$},created:function(){console.log("init App"),(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))&&(this.auth=!0,this.loadFunctions(),this.loadUser(),this.loadSettings())},data:function(){return{auth:!1,admin:!1,read:["Работники","Клиенты","Контакты","Объекты","Бухгалтерия"],edit:["Работники","Клиенты","Контакты","Объекты","Бухгалтерия"]}},methods:{setAuth:function(){console.log("auth"),this.auth=!0},setNotAuth:function(){this.auth=!1},setAdmin:function(){this.admin=!0},loadFunctions:function(){var e=this;console.log("loadFunctions"),o.a.ajax({url:this.$hostname+"time-tracking/group",type:"GET",headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))},success:function(t){e.read=t.data.read,e.edit=t.data.edit,e.admin=t.data.admin},error:function(t){500===t.status?console.log("Ошибка соединения с сервером"):401===t.status?e.$refresh():console.log("Непредвиденная ошибка")},async:!1})},loadUser:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/user",type:"GET",headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))},success:function(e){console.log(e.data)},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0},async:!1})},loadSettings:function(){var e=this;console.log("loadSettings"),o.a.ajax({url:this.$hostname+"time-tracking/user-settings",type:"GET",headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))},success:function(t){console.log(t.data.data.theme),e.$toggleTheme(t.data.data.theme)},error:function(t){500===t.status?console.log("Ошибка соединения с сервером"):401===t.status?e.$refresh():console.log("Непредвиденная ошибка")},async:!1})}}},P=D,E=(a("034f"),a("7496")),M=a("a523"),I=Object(m["a"])(P,s,i,!1,null,null,null),S=I.exports;v()(I,{VApp:E["a"],VContainer:M["a"]});var T=a("8c4f"),V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"index news flex-content"},[a("Header"),a("div",{staticClass:"summary-box"},[a("h1",[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.h1Label")))]),e.auth?a("section",[a("div",{staticClass:"index__hello"},[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.index.hello"))+" "+e._s(e.user.name)+" "+e._s(e.user.lastname)+" ")]),a("div",{staticClass:"index__today"},[a("h2",[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.todayLabel")))]),a("ul",{staticClass:"today-list"},[a("li",[a("span",{staticClass:"today__unit bold-text"},[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.statistics.news.label")))]),a("span",{staticClass:"today__quantity"},[e._v(e._s(e.statistics.news)+" "+e._s(e.$vuetify.lang.t("$vuetify.index.statistics.news.text")))])]),a("li",[a("span",{staticClass:"today__unit bold-text"},[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.statistics.workers.label")))]),a("span",{staticClass:"today__quantity"},[e._v(e._s(e.statistics.workers.all)+" "+e._s(e.$vuetify.lang.t("$vuetify.index.statistics.workers.all")))]),a("span",{staticClass:"today__now"},[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.statistics.workers.new"))+": "+e._s(e.statistics.workers.today))]),a("span",{staticClass:"today__now"},[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.statistics.workers.text"))+" "+e._s(e.statistics.workers.in_work))])]),a("li",[a("span",{staticClass:"today__unit bold-text"},[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.statistics.clients.label")))]),a("span",{staticClass:"today__quantity"},[e._v(e._s(e.statistics.clients.all)+" "+e._s(e.$vuetify.lang.t("$vuetify.index.statistics.clients.all")))]),a("span",{staticClass:"today__now"},[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.statistics.clients.new"))+": "+e._s(e.statistics.clients.today))])]),a("li",[a("span",{staticClass:"today__unit bold-text"},[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.statistics.objects.label")))]),a("span",{staticClass:"today__quantity"},[e._v(e._s(e.statistics.objects.all)+" "+e._s(e.$vuetify.lang.t("$vuetify.index.statistics.objects.all")))]),a("span",{staticClass:"today__now"},[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.statistics.objects.text"))+": "+e._s(e.statistics.objects.in_work))])]),a("li",[a("span",{staticClass:"today__unit bold-text"},[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.statistics.calendar.label")))]),a("span",{staticClass:"today__quantity"},[e._v(e._s(e.statistics.calendar.all)+" "+e._s(e.$vuetify.lang.t("$vuetify.index.statistics.calendar.all")))]),a("span",{staticClass:"today__now"},[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.statistics.calendar.week"))+": "+e._s(e.statistics.calendar.week))]),a("span",{staticClass:"today__now"},[e._v(e._s(e.$vuetify.lang.t("$vuetify.index.statistics.calendar.today"))+": "+e._s(e.statistics.calendar.today))])])])])]):e._e(),e.auth?a("section",{staticClass:"widgets"},[a("div",{staticClass:"unit-title"},[a("h1",[e._v(e._s(e.$vuetify.lang.t("$vuetify.widgets.h1Label")))]),a("v-btn",{attrs:{color:"primary",fab:"","x-small":""},on:{click:function(t){e.addWidgetForm=!0}}},[a("v-icon",[e._v("mdi-plus")])],1)],1),a("div",{staticClass:"index__widgets"},[e._l(e.notes,(function(t,n){return[a("div",{key:t.id,staticClass:"widgets-single"},[a("div",{staticClass:"widgets-single__header"},[a("h3",[e._v(e._s(e.$vuetify.lang.t("$vuetify.widgets.noteLabel"))+" "+e._s(n+1))]),a("div",{staticClass:"widgets-single__actions"},[a("v-btn",{attrs:{color:"error",fab:"","x-small":""},on:{click:function(a){return e.deleteNote(t.id)}}},[a("v-icon",[e._v("mdi-delete")])],1),a("v-btn",{attrs:{color:"primary",fab:"","x-small":""}},[a("v-icon",[e._v("mdi-autorenew")])],1)],1)]),a("div",{staticClass:"widgets-single__content"},[a("div",{staticClass:"note__header"},[e._v(" "+e._s(e.$vuetify.lang.t("$vuetify.widgets.lastSave"))+": "),a("span",[e._v(e._s(t.last_save))]),a("div",{staticClass:"widgets-single__actions"},[a("v-btn",{attrs:{color:"secondary",fab:"","x-small":""},on:{click:function(a){e.newNote=t,e.addNoteForm=!0}}},[a("v-icon",[e._v("mdi-pencil")])],1)],1)]),a("div",{staticClass:"note__content",style:"background: "+t.color},[a("pre",[e._v(e._s(t.text))])])])])]}))],2)]):e._e(),e.auth?e._e():a("div",{staticClass:"news-all all"},[a("div",{staticClass:"news-all__grid"},[e._l(e.news,(function(t){return[t.photo_path?a("v-card",{key:t.id,staticClass:"news-single",style:{"background-image":"url("+e.$hostname+"media"+t.photo_path+")","background-size":"cover","background-position":"center"},attrs:{color:"primary"},on:{click:function(a){return e.$router.push({name:"NewOpen",params:{id:t.id}})}}},[a("div",{staticClass:"news-single__title"},[e._v(e._s(t.title))]),a("div",{staticClass:"news-single__text",domProps:{innerHTML:e._s(t.text)}})]):a("v-card",{key:t.id,staticClass:"news-single",attrs:{color:"primary"},on:{click:function(a){return e.$router.push({name:"NewOpen",params:{currentNew:t,id:t.id}})}}},[a("div",{staticClass:"news-single__title"},[e._v(e._s(t.title))]),a("div",{staticClass:"news-single__text",domProps:{innerHTML:e._s(t.text)}})])]}))],2)])]),e.auth?e._e():a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.goLogin}},[e._v("Войти")]),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.addWidgetForm,callback:function(t){e.addWidgetForm=t},expression:"addWidgetForm"}},[a("v-card",[a("v-card-title",[e._v(" Выберите виджет ")]),a("v-card-text",[a("v-list",{attrs:{dense:""}},[a("v-list-item-group",[a("v-list-item",{on:{click:e.openAddNote}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-text")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Блокнот")])],1)],1)],1)],1)],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.addNoteForm,callback:function(t){e.addNoteForm=t},expression:"addNoteForm"}},[a("v-card",[a("v-card-text",[a("h2",[e._v("Блокнот")]),a("v-textarea",{style:"background: "+e.color,attrs:{filled:""},model:{value:e.newNote.text,callback:function(t){e.$set(e.newNote,"text",t)},expression:"newNote.text"}}),a("v-color-picker",{model:{value:e.color,callback:function(t){e.color=t},expression:"color"}})],1),a("v-card-actions",[a("v-btn",{attrs:{color:"secondary"},on:{click:e.closeNoteForm}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary"},on:{click:e.saveNote}},[e._v("Сохранить")])],1)],1)],1)],1)},j=[],F=(a("159b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header"},[e._m(0),a("div",{staticClass:"header__right"},[a("div",{staticClass:"header__datetime"},[a("span",[e._v(e._s(e.date))]),e._v(" "),a("span",{staticClass:"line"}),e._v(" "),a("span",[e._v(e._s(e.time))])])])])}),O=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header__left"},[n("img",{staticClass:"header__logo",attrs:{src:a("cf05"),alt:"logo.png"}})])}],A={name:"Header",created:function(){var e=this;this.refreshTime(),setInterval((function(){e.refreshTime()}),1e3)},computed:{date:function(){var e=new Date;return e.getDate()+"."+(e.getMonth()+1)+"."+e.getFullYear()}},data:function(){return{time:""}},methods:{refreshTime:function(){var e=new Date,t=e.getMinutes();t<10&&(t="0"+t),this.time=e.getHours()+":"+t}}},q=A,L=Object(m["a"])(q,F,O,!1,null,"cff4b776",null),R=L.exports,W={name:"Index",components:{Header:R},created:function(){console.log("init Index"),(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))&&(this.auth=!0,this.$emit("load-functions"),this.$emit("load-settings")),this.loadData()},data:function(){return{auth:!1,news:{},user:{},statistics:{news:0,workers:{},clients:{},objects:{},calendar:{}},widgets:[],notes:[],newNote:{id:0,color:"",text:"",last_save:""},addWidgetForm:!1,addNoteForm:!1,hex:"#FFC6C6"}},computed:{color:{get:function(){return this["hex"]},set:function(e){this["hex"]=e}}},methods:{goLogin:function(){this.$router.push({name:"Login"})},loadData:function(){var e=this;this.auth?(o.a.ajax({url:this.$hostname+"time-tracking/user",type:"GET",headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))},success:function(t){e.user=t.data.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}}),this.loadStatistics(),this.loadNotes()):o.a.ajax({url:this.$hostname+"time-tracking/news",type:"GET",success:function(t){e.news=t.data.data},error:function(t){e.alertError=!0,e.alertMsg="Непредвиденная ошибка",console.log(t.data)}})},loadStatistics:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/statistics",type:"GET",headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))},success:function(t){e.statistics=t.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadNotes:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/notes",type:"GET",headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))},success:function(t){e.notes=t.data.data,e.notes.forEach((function(e){var t=new Date(e.last_save),a="";switch(t.getDay()){case 1:a+="Понедельник";break;case 2:a+="Вторник";break;case 3:a+="Среда";break;case 4:a+="Четверг";break;case 5:a+="Пятница";break;case 6:a+="Суббота";break;case 7:a+="Воскресенье";break}e.last_save=a+" "+t.toISOString().substring(0,10)+" "+t.getHours()+":"+t.getMinutes()}))},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},saveNote:function(){var e=this;this.newNote.color=this.color,this.newNote.last_save=(new Date).toISOString(),0===this.newNote.id?o.a.ajax({url:this.$hostname+"time-tracking/notes",type:"POST",headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))},data:this.newNote,success:function(){e.closeNoteForm(),e.loadNotes()},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}}):this.putNote()},putNote:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/notes",type:"PUT",headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))},data:this.newNote,success:function(){e.closeNoteForm(),e.loadNotes()},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},deleteNote:function(e){var t=this;o.a.ajax({url:this.$hostname+"time-tracking/notes",type:"DELETE",headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))},data:{id:e},success:function(){t.loadNotes()},error:function(e){500===e.status?t.alertMsg="Ошибка соединения с сервером":401===e.status?t.$refresh():t.alertMsg="Непредвиденная ошибка",t.alertError=!0}})},closeNoteForm:function(){this.addNoteForm=!1,this.newNote={id:0,color:"",text:""}},openAddNote:function(){this.addWidgetForm=!1,this.addNoteForm=!0}}},N=W,G=a("8336"),B=a("b0af"),z=a("99d9"),U=a("03a4"),H=a("169a"),Q=a("a844"),Z=Object(m["a"])(N,V,j,!1,null,"09167d66",null),Y=Z.exports;v()(Z,{VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VColorPicker:U["a"],VDialog:H["a"],VIcon:h["a"],VList:_["a"],VListItem:g["a"],VListItemContent:k["a"],VListItemGroup:w["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VTextarea:Q["a"]});var K=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"profile flex-content"},[a("div",{staticClass:"summary-box"},[a("div",{staticClass:"profile__image"},[null!=e.user.photo_path?a("v-img",{attrs:{"lazy-src":e.$hostname+"media"+e.user.photo_path,src:e.$hostname+"media"+e.user.photo_path}}):e._e(),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(t){return e.$router.push({name:"Timing"})}}},[e._v("Часовая отчетность")])],1),a("div",{staticClass:"profile__info"},[a("h3",[e._v("Личная информация")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Имя")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.name))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Фамилия")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.lastname))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Дата рождения")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.birthdate))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Гражданство")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.citizenship))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Должность")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.position.name))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Номер соц. страхования")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.social_code_own))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Финский номер соц. страхования")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.social_code_fin))])])]),a("h3",[e._v("Контакты")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Телефон")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.phone))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Телефон в Финляндии")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.phone_fin))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("E-mail")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.auth_user_id.email))])])]),a("h3",[e._v("Банковская информация")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Налоговый номер")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.tax_number))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Счет в банке")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.bank_account))])])]),a("div",{staticClass:"open__actions"},[a("div",{staticClass:"addition-btn",on:{click:function(t){e.full=!e.full}}},[e.full?a("span",[e._v("Скрыть полную информацию")]):e._e(),e.full?e._e():a("span",[e._v("Показать полную информацию")])]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.push({name:"DocumentsOwn",params:{type:"worker"}})}}},[e._v(" Документы ")])]),e.full?a("div",{staticClass:"profile__info profile__info-full"},[a("h3",[e._v("Адреса")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Адрес в своей стране")]),""!==e.user.address_own.city&&void 0!==e.user.address_own.city&&void 0!==e.user.address_own?a("span",{staticClass:"profile__info-content"},[e._v(" "+e._s(e.user.address_own.city)+", "+e._s(e.user.address_own.street)+", д."+e._s(e.user.address_own.house)+", кв."+e._s(e.user.address_own.flat)+" ")]):e._e()]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Адрес в Финляндии")]),""!==e.user.address_fin.city&&void 0!==e.user.address_fin.city&&void 0!==e.user.address_fin?a("span",{staticClass:"profile__info-content"},[e._v(" "+e._s(e.user.address_fin.city)+", "+e._s(e.user.address_fin.street)+", д."+e._s(e.user.address_fin.house)+", кв."+e._s(e.user.address_fin.flat)+" ")]):e._e()])]),a("h3",[e._v("Одежда (размеры)")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Ботинки")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.boots))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Куртка")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.jacket))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Штаны")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.pants))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Футболка")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.shirt))])])]),a("h3",[e._v("Языки")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Русский")]),a("v-checkbox",{staticClass:"profile__info-content",attrs:{disabled:""},model:{value:e.user.russian,callback:function(t){e.$set(e.user,"russian",t)},expression:"user.russian"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Английский")]),a("v-checkbox",{staticClass:"profile__info-content",attrs:{disabled:""},model:{value:e.user.english,callback:function(t){e.$set(e.user,"english",t)},expression:"user.english"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Эстонский")]),a("v-checkbox",{staticClass:"profile__info-content",attrs:{disabled:""},model:{value:e.user.estonian,callback:function(t){e.$set(e.user,"estonian",t)},expression:"user.estonian"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Финский")]),a("v-checkbox",{staticClass:"profile__info-content",attrs:{disabled:""},model:{value:e.user.finnish,callback:function(t){e.$set(e.user,"finnish",t)},expression:"user.finnish"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Другие")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.other_language))])])]),a("h3",[e._v("Другое")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Свой автомобиль")]),a("v-checkbox",{staticClass:"profile__info-content",attrs:{disabled:""},model:{value:e.user.auto,callback:function(t){e.$set(e.user,"auto",t)},expression:"user.auto"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Свой инструмент")]),a("v-checkbox",{staticClass:"profile__info-content",attrs:{disabled:""},model:{value:e.user.tool,callback:function(t){e.$set(e.user,"tool",t)},expression:"user.tool"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Навыки")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.user.skills))])])])]):e._e()])]),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1)},X=[],J={name:"Profile",data:function(){return{page:"profile",user:{auth_user_id:{email:""}},groups:[],full:!1,alertError:!1,alertMsg:""}},created:function(){console.log("init Profile"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/user",type:"GET",success:function(t){e.user=t.data.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})}}},ee=J,te=a("07987"),ae=a("ac7c"),ne=Object(m["a"])(ee,K,X,!1,null,null,null),se=ne.exports;v()(ne,{VAlert:te["a"],VBtn:G["a"],VCheckbox:ae["a"],VImg:p["a"]});var ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login"},[a("div",{staticClass:"logo"},[e._v("logo")]),a("v-form",{ref:"form",staticClass:"mu-demo-form",attrs:{model:e.authForm}},[a("h1",[e._v("Авторизация")]),a("v-text-field",{attrs:{placeholder:"Логин",rules:e.usernameRules,required:"","append-icon":"$login",outlined:""},model:{value:e.authForm.login,callback:function(t){e.$set(e.authForm,"login",t)},expression:"authForm.login"}}),a("v-text-field",{attrs:{placeholder:"Пароль",type:"password",rules:e.passwordRules,required:"","append-icon":"$password",outlined:""},model:{value:e.authForm.password,callback:function(t){e.$set(e.authForm,"password",t)},expression:"authForm.password"}}),a("v-checkbox",{attrs:{label:"Запомнить меня"},model:{value:e.checkbox,callback:function(t){e.checkbox=t},expression:"checkbox"}}),a("v-btn",{attrs:{color:"primary"},on:{click:e.setLogin}},[e._v("Войти")])],1),a("button",{staticClass:"login__recover-btn",on:{click:e.goRecover}},[e._v("Забыли пароль?")]),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")]),a("v-alert",{attrs:{"close-text":"Закрыть",color:"success",dismissible:""},model:{value:e.alertSuccess,callback:function(t){e.alertSuccess=t},expression:"alertSuccess"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1)},re=[],oe={name:"Login",data:function(){return{authForm:{login:"",password:""},checkbox:!1,usernameRules:[function(e){return!!e||"Необходимо заполнить почту пользователя"},function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||"Некорректный E-mail"}],passwordRules:[function(e){return!!e||"Необходимо заполнить пароль"}],alertError:!1,alertSuccess:!1,alertMsg:""}},created:function(){(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))&&this.$router.push({name:"Index"})},methods:{setLogin:function(){var e=this;this.$refs.form.validate()&&o.a.ajax({url:this.$hostname+"auth/token/login",type:"POST",data:{email:this.authForm.login,password:this.authForm.password},success:function(t){e.$emit("set-auth"),e.$emit("load-functions"),e.checkbox?localStorage.setItem("auth_token",t.data.attributes.auth_token):sessionStorage.setItem("auth_token",t.data.attributes.auth_token),e.$router.push({name:"Index"})},error:function(t){switch(console.log(t),e.alertError=!0,e.alertMsg="Непредвиденная ошибка",t.status){case 400:e.alertMsg="Пользователя с такой почтой не существует";break;case 403:e.alertMsg="Неверный пароль";break;case 404:e.alertMsg="Страница не найдена";break}}})},goRecover:function(){this.$router.push({name:"RecoverPassword"})}}},le=oe,ce=a("4bd4"),ue=a("8654"),de=Object(m["a"])(le,ie,re,!1,null,"defbaa34",null),me=de.exports;v()(de,{VAlert:te["a"],VBtn:G["a"],VCheckbox:ae["a"],VForm:ce["a"],VTextField:ue["a"]});var fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login"},[a("div",{staticClass:"logo"},[e._v("logo")]),a("v-form",{ref:"form",staticClass:"mu-demo-form",attrs:{model:e.authForm}},[a("h1",[e._v("Восстановление пароля")]),a("v-text-field",{attrs:{placeholder:"Логин",rules:e.usernameRules,required:"","append-icon":"$login",outlined:""},model:{value:e.authForm.login,callback:function(t){e.$set(e.authForm,"login",t)},expression:"authForm.login"}}),a("v-btn",{attrs:{color:"primary"},on:{click:e.sendMessage}},[e._v("Восстановить пароль")])],1),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")]),a("v-alert",{attrs:{"close-text":"Закрыть",color:"success",dismissible:""},model:{value:e.alertSuccess,callback:function(t){e.alertSuccess=t},expression:"alertSuccess"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1)},ve=[],he={name:"RecoverPassword",data:function(){return{authForm:{login:""},usernameRules:[function(e){return!!e||"Необходимо заполнить имя пользователя"}],alertError:!1,alertSuccess:!1,alertMsg:""}}},pe=he,_e=Object(m["a"])(pe,fe,ve,!1,null,"9a2018f2",null),be=_e.exports;v()(_e,{VAlert:te["a"],VBtn:G["a"],VForm:ce["a"],VTextField:ue["a"]});var ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"news flex-content"},[a("div",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h3",[e._v("Новости")]),e.all?e._e():a("div",{staticClass:"addition-btn",on:{click:function(t){e.all=!0}}},[a("span",[e._v("К списку новостей")]),a("back-icon")],1)]),e.all?a("div",{staticClass:"news-all all"},[a("div",{staticClass:"news-all__grid"},[e._l(e.news,(function(t){return[t.photo_path?a("v-card",{key:t.id,staticClass:"news-single",style:{"background-image":"url("+e.$hostname+"media"+t.photo_path+")","background-size":"cover","background-position":"center"},attrs:{color:"primary"},on:{click:function(a){return e.openNew(t)}}},[a("div",{staticClass:"news-single__actions"},[a("v-icon",{on:{click:function(a){return e.deleteNew(t.id)}}},[e._v("$waste")]),a("v-icon",{on:{click:function(a){return e.openEditForm(t.id,t.title,t.text)}}},[e._v("$edit")])],1),a("div",{staticClass:"news-single__title"},[e._v(e._s(t.title))]),a("div",{staticClass:"news-single__text",domProps:{innerHTML:e._s(t.text)}})]):a("v-card",{key:t.id,staticClass:"news-single",attrs:{color:"primary"},on:{click:function(a){return e.openNew(t)}}},[a("div",{staticClass:"news-single__actions"},[a("v-icon",{on:{click:function(a){return e.deleteNew(t.id)}}},[e._v("$waste")]),a("v-icon",{on:{click:function(a){return e.openEditForm(t.id,t.title,t.text)}}},[e._v("$edit")])],1),a("div",{staticClass:"news-single__title"},[e._v(e._s(t.title))]),a("div",{staticClass:"news-single__text",domProps:{innerHTML:e._s(t.text)}})])]}))],2),a("v-list",[e.$parent.$parent.admin?a("v-list-item",{staticClass:"content-list__btns-add",on:{click:e.openAddForm}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Добавить новость")])],1)],1):e._e()],1)],1):a("div",{staticClass:"news-open"},[a("h4",[e._v(e._s(e.currentNew.title))]),a("div",{staticClass:"news-open__image"},[e.currentNew.photo_path?a("v-img",{attrs:{src:e.$hostname+"media"+e.currentNew.photo_path}}):e._e()],1),a("div",{staticClass:"news-open__text",domProps:{innerHTML:e._s(e.currentNew.text)}}),e.$parent.$parent.admin?a("div",{staticClass:"news-open__actions open__actions"},[a("div",{staticClass:"addition-btn",on:{click:function(t){return e.openEditForm(e.currentNew.id,e.currentNew.title,e.currentNew.text)}}},[a("edit-icon"),e._v(" Редактировать новость ")],1),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.deleteNew(e.currentNew.id)}}},[a("waste-icon"),e._v(" Удалить новость ")],1)]):e._e()])]),a("v-dialog",{staticClass:"news__dialog",model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:e.closeForm}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"form"},[a("v-text-field",{attrs:{placeholder:"Заголовок",rules:e.titleRules,required:"",outlined:""},model:{value:e.newNew.title,callback:function(t){e.$set(e.newNew,"title",t)},expression:"newNew.title"}}),a("v-editor",{attrs:{config:e.editorConfig},model:{value:e.newNew.text,callback:function(t){e.$set(e.newNew,"text",t)},expression:"newNew.text"}})],1),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1),a("v-card-actions",[a("div",{staticClass:"addition-btn",on:{click:function(t){e.photoDialog=!0}}},[a("add-photo-icon"),null==e.photoField?a("span",[e._v("Загрузить обложку")]):e._e(),null!=e.photoField?a("span",[e._v("Сменить обложку")]):e._e()],1),a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.addNew}},[e._v(e._s(e.formBtnText))])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.photoDialog,callback:function(t){e.photoDialog=t},expression:"photoDialog"}},[a("v-card",[a("v-card-title",[e._v(" Сменить фото ")]),a("v-card-text",[a("v-file-input",{attrs:{placeholder:"Обложка новости",accept:"image/*","prepend-icon":"",outlined:""},model:{value:e.photoField,callback:function(t){e.photoField=t},expression:"photoField"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.closePhotoForm}},[e._v("Сохранить")])],1)],1)],1)],1)},ke=[],we=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M8 5.6C8 5.17565 8.16857 4.76869 8.46863 4.46863C8.76869 4.16857 9.17565 4 9.6 4H14.4C14.8243 4 15.2313 4.16857 15.5314 4.46863C15.8314 4.76869 16 5.17565 16 5.6V7.2H19.2C19.4122 7.2 19.6157 7.28429 19.7657 7.43431C19.9157 7.58434 20 7.78783 20 8C20 8.21217 19.9157 8.41566 19.7657 8.56569C19.6157 8.71571 19.4122 8.8 19.2 8.8H18.3448L17.6512 18.5136C17.6225 18.9173 17.4418 19.2951 17.1457 19.5709C16.8495 19.8467 16.4599 20 16.0552 20H7.944C7.53931 20 7.14965 19.8467 6.85351 19.5709C6.55736 19.2951 6.37673 18.9173 6.348 18.5136L5.656 8.8H4.8C4.58783 8.8 4.38434 8.71571 4.23431 8.56569C4.08429 8.41566 4 8.21217 4 8C4 7.78783 4.08429 7.58434 4.23431 7.43431C4.38434 7.28429 4.58783 7.2 4.8 7.2H8V5.6ZM9.6 7.2H14.4V5.6H9.6V7.2ZM7.2592 8.8L7.9448 18.4H16.056L16.7416 8.8H7.2592ZM10.4 10.4C10.6122 10.4 10.8157 10.4843 10.9657 10.6343C11.1157 10.7843 11.2 10.9878 11.2 11.2V16C11.2 16.2122 11.1157 16.4157 10.9657 16.5657C10.8157 16.7157 10.6122 16.8 10.4 16.8C10.1878 16.8 9.98434 16.7157 9.83431 16.5657C9.68429 16.4157 9.6 16.2122 9.6 16V11.2C9.6 10.9878 9.68429 10.7843 9.83431 10.6343C9.98434 10.4843 10.1878 10.4 10.4 10.4ZM13.6 10.4C13.8122 10.4 14.0157 10.4843 14.1657 10.6343C14.3157 10.7843 14.4 10.9878 14.4 11.2V16C14.4 16.2122 14.3157 16.4157 14.1657 16.5657C14.0157 16.7157 13.8122 16.8 13.6 16.8C13.3878 16.8 13.1843 16.7157 13.0343 16.5657C12.8843 16.4157 12.8 16.2122 12.8 16V11.2C12.8 10.9878 12.8843 10.7843 13.0343 10.6343C13.1843 10.4843 13.3878 10.4 13.6 10.4Z",fill:"white"}})])},xe=[],Ce={name:"wasteIcon"},ye=Ce,$e=Object(m["a"])(ye,we,xe,!1,null,"f0835c60",null),De=$e.exports,Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M19.4042 7.29413L16.6642 4.5442C16.3066 4.20708 15.838 4.01365 15.3475 4.0007C14.8571 3.98774 14.379 4.15617 14.0042 4.47395L5.0042 13.5065C4.68097 13.8337 4.47971 14.2625 4.4342 14.7209L4.0042 18.906C3.99073 19.053 4.00974 19.2012 4.05986 19.34C4.10999 19.4788 4.19001 19.6047 4.2942 19.7089C4.38764 19.8019 4.49846 19.8755 4.6203 19.9255C4.74213 19.9754 4.8726 20.0007 5.0042 20H5.0942L9.2642 19.6186C9.721 19.5729 10.1482 19.3709 10.4742 19.0465L19.4742 10.0139C19.8235 9.64357 20.0123 9.14933 19.9992 8.63952C19.9861 8.12971 19.7721 7.64591 19.4042 7.29413ZM9.0842 17.6114L6.0842 17.8924L6.3542 14.8815L12.0042 9.2813L14.7042 11.9911L9.0842 17.6114ZM16.0042 10.6462L13.3242 7.95652L15.2742 5.94928L18.0042 8.68916L16.0042 10.6462Z",fill:"white"}})])},Ee=[],Me={name:"editIcon"},Ie=Me,Se=Object(m["a"])(Ie,Pe,Ee,!1,null,"6fd27fff",null),Te=Se.exports,Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M2.5 13.75L11.25 2.5V8.75C26.1913 8.75 27.915 20.8475 27.5 27.5C26.8725 24.1438 26.5813 18.75 11.25 18.75V25L2.5 13.75Z",stroke:"#616161","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}})])},je=[],Fe={name:"backIcon"},Oe=Fe,Ae=Object(m["a"])(Oe,Ve,je,!1,null,"76f211ad",null),qe=Ae.exports,Le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M20.2869 16.6843L15.0022 11.3997L9.71753 16.6843L11.0433 18.0101L14.0647 14.9888V29.0625H15.9397V14.9888L18.9611 18.0101L20.2869 16.6843Z",fill:"#616161"}}),a("path",{attrs:{d:"M23.4375 9.46014V9.375C23.4375 4.72266 19.6523 0.9375 15 0.9375C10.3477 0.9375 6.5625 4.72266 6.5625 9.375V9.52096C5.1739 9.78301 3.89379 10.4498 2.88316 11.4375C2.26815 12.0344 1.77908 12.7486 1.44489 13.5378C1.11069 14.3271 0.938164 15.1753 0.9375 16.0324C0.9375 17.8557 1.6868 19.5926 3.04746 20.9231C4.37695 22.2231 6.17215 22.9688 7.97285 22.9688H11.7188V21.0938H7.97285C5.22387 21.0938 2.8125 18.7286 2.8125 16.0324C2.8125 13.5557 4.90078 11.467 7.56662 11.2772L8.4375 11.2151V9.375C8.4375 7.63452 9.1289 5.96532 10.3596 4.73461C11.5903 3.5039 13.2595 2.8125 15 2.8125C16.7405 2.8125 18.4097 3.5039 19.6404 4.73461C20.8711 5.96532 21.5625 7.63452 21.5625 9.375V11.2523L22.4883 11.2641C25.2112 11.2985 27.1875 13.3039 27.1875 16.0324C27.1875 18.8705 25.0984 21.0938 22.4314 21.0938H18.2812V22.9688H22.4314C23.3247 22.9717 24.2088 22.7885 25.0274 22.4308C25.846 22.0731 26.581 21.5489 27.1857 20.8914C28.396 19.5902 29.0625 17.8646 29.0625 16.0324C29.0625 12.6083 26.7021 9.92531 23.4375 9.46014Z",fill:"#616161"}})])},Re=[],We={name:"addPhotoIcon"},Ne=We,Ge=Object(m["a"])(Ne,Le,Re,!1,null,"e50887ec",null),Be=Ge.exports,ze={name:"News",components:{BackIcon:qe,EditIcon:Te,WasteIcon:De,AddPhotoIcon:Be},data:function(){return{page:"news",all:!0,news:"",newNew:{id:0,title:"",text:"",photo_path:null},photoField:null,currentNew:{id:0,title:"",text:"",photo_path:null},titleRules:[function(e){return!!e||"Необходимо ввести заголовок"}],formTitle:"Добавление новости",formBtnText:"Добавить новость",addForm:!1,photoDialog:!1,alertError:!1,alertSuccess:!1,alertMsg:"",options:{},editorConfig:{printLog:!1,uploadImgUrl:"http://localhost:2233/api/upload",menus:["source","|","bold","underline","italic","strikethrough","eraser","forecolor","bgcolor","|","quote","fontfamily","fontsize","head","unorderlist","orderlist","alignleft","aligncenter","alignright","|","link","unlink","table","|","insertcode","|","undo","redo","fullscreen"],useLang:"en",pasteText:!0},disableEditor:{printLog:!1,disable:!0}}},created:function(){console.log("init News"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{onChange:function(){console.log(this.newNew.text.text())},uploadCallback:function(e){console.log("uploaded url",e)},loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/news",type:"GET",success:function(t){e.news=t.data.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},addNew:function(){var e=this;if(this.$refs.form.validate())if(this.newNew.id>0)this.editNew();else{var t=a("bc3a"),n=new FormData,s=this.photoField;void 0!==this.photoField&&n.append("image",s),n.append("title",this.newNew.title),n.append("text",this.newNew.text),t({method:"post",url:this.$hostname+"time-tracking/news",headers:{Authorization:"Token "+(sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token"))},data:n}).then((function(t){console.log(t.data.data),e.photoDialog=!1,e.closeForm(),e.loadData()}))}else this.alertError=!0,this.alertMsg="Заполните обязательные поля"},editNew:function(){var e=this,t=a("bc3a"),n=new FormData,s=this.photoField;console.log(this.currentNew.photo_path),null!==this.photoField&&n.append("image",s),n.append("title",this.newNew.title),n.append("text",this.newNew.text),n.append("id",this.newNew.id),t({method:"put",url:this.$hostname+"time-tracking/news",headers:{Authorization:"Token "+(sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token"))},data:n}).then((function(t){console.log(t.data.data),e.photoDialog=!1,e.closeForm(),e.loadData(),null!==e.photoField&&(e.currentNew.photo_path="/news/"+e.photoField.name,e.photoField=null)}))},deleteNew:function(e){var t=this;o.a.ajax({url:this.$hostname+"time-tracking/news",type:"DELETE",data:{id:e},success:function(){t.alertMsg="Новость удалена",t.loadData(),t.all=!0},error:function(e){500===e.status?t.alertMsg="Ошибка соединения с сервером":401===e.status?t.$refresh():t.alertMsg="Непредвиденная ошибка",t.alertError=!0}})},openAddForm:function(){this.formTitle="Добавление новости",this.formBtnText="Добавить новость",this.addForm=!0},openEditForm:function(e,t,a){this.formTitle="Редактирование новости",this.formBtnText="Сохранить новость",this.newNew={id:e,title:t,text:a},this.addForm=!0},closeForm:function(){this.addForm=!1,this.newNew={id:0,title:"",text:"",photo:null}},closePhotoForm:function(){this.photoDialog=!1},openNew:function(e){this.currentNew=e,this.all=!1}}},Ue=ze,He=a("23a7"),Qe=a("2fa4"),Ze=a("71d9"),Ye=Object(m["a"])(Ue,ge,ke,!1,null,"7ba199a8",null),Ke=Ye.exports;v()(Ye,{VAlert:te["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VDialog:H["a"],VFileInput:He["a"],VForm:ce["a"],VIcon:h["a"],VImg:p["a"],VList:_["a"],VListItem:g["a"],VListItemContent:k["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VSpacer:Qe["a"],VTextField:ue["a"],VToolbar:Ze["a"]});var Xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"objects flex-content"},[a("div",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h3",[e._v("Объекты")]),e.all?e._e():a("div",{staticClass:"addition-btn",on:{click:function(t){e.all=!0}}},[a("span",[e._v("К списку объектов")]),a("back-icon")],1),e.all?a("div",{staticClass:" addition-btn content-list__filters-mobile",on:{click:e.openFilters}},[e._v("Фильтры ")]):e._e()]),e.all?a("div",{staticClass:"objects-all all"},[a("div",{staticClass:"content-list__filters"},[a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:e.closeFilters}},[e._v(" $deleteIcon ")]),a("v-text-field",{attrs:{placeholder:"Адрес",outlined:""},model:{value:e.filter.address,callback:function(t){e.$set(e.filter,"address",t)},expression:"filter.address"}}),a("v-select",{attrs:{items:e.selects,outlined:""},model:{value:e.filter.client,callback:function(t){e.$set(e.filter,"client",t)},expression:"filter.client"}}),a("v-menu",{ref:"menu_filter",attrs:{"close-on-content-click":!1,"return-value":e.filter.dates,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(t){return e.$set(e.filter,"dates",t)},"update:return-value":function(t){return e.$set(e.filter,"dates",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{placeholder:"Начало работ",readonly:"",outlined:""},model:{value:e.filter.dates,callback:function(t){e.$set(e.filter,"dates",t)},expression:"filter.dates"}},"v-text-field",s,!1),n))]}}],null,!1,240686409),model:{value:e.datePickers.menu_filter,callback:function(t){e.$set(e.datePickers,"menu_filter",t)},expression:"datePickers.menu_filter"}},[a("v-date-picker",{attrs:{"no-title":"",scrollable:"",range:"",color:"primary"},model:{value:e.filter.dates,callback:function(t){e.$set(e.filter,"dates",t)},expression:"filter.dates"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.datePickers.menu_filter=!1}}},[e._v(" Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.menu_filter.save(e.filter.dates)}}},[e._v("OK")])],1)],1)],1),a("v-list",{staticClass:"objects__list content-list",attrs:{"three-line":""}},[e._l(e.objects,(function(t){return[t.active===e.archive&&(t.city+" "+t.street+" "+t.house).includes(e.filter.address)&&("Все"===e.filter.client||t.client_id.name===e.filter.client)&&("undefined"===typeof e.filter.dates[0]||t.date_start>=e.filter.dates[0])&&(t.date_start<=e.filter.dates[1]||"undefined"===typeof e.filter.dates[1])?a("v-list-item",{key:t.id},[a("v-list-item-content",{on:{click:function(a){return e.openObject(t)}}},[a("v-list-item-title",[e._v(e._s(t.city)+" "+e._s(t.street)+" "+e._s(t.house))]),a("v-list-item-subtitle",[a("span",[e._v(e._s(t.date_start)+" - "+e._s(t.date_end))]),a("br"),a("span",[e._v(e._s(t.client_id.name))])])],1),-1!==e.$parent.$parent.edit.indexOf("Объекты")?a("v-list-item-action",[a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:function(a){return e.openConfirmDeleteDialog(t)}}},[e._v("$deleteIcon")])],1):e._e()],1):e._e()]}))],2),a("v-list",{staticClass:"content-list__btns"},[e.archive||-1===e.$parent.$parent.edit.indexOf("Объекты")?e._e():a("v-list-item",{staticClass:"content-list__btns-add",on:{click:e.openAddForm}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Добавить объект")])],1)],1),e.archive?a("v-list-item",{staticClass:"content-list__btns-add",on:{click:function(t){e.archive=!e.archive}}},[a("v-list-item-icon",[a("v-icon",[e._v("$archive")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Выйти из архива")])],1)],1):a("v-list-item",{staticClass:"content-list__btns-add",on:{click:function(t){e.archive=!e.archive}}},[a("v-list-item-icon",[a("v-icon",[e._v("$archive")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Архив")])],1)],1)],1)],1):a("div",{staticClass:"objects-open"},[a("div",{staticClass:"objects-open__info profile__info"},[a("h3",[e._v("Информация об объекте")]),-1!==e.$parent.$parent.edit.indexOf("Объекты")?a("div",{staticClass:"news-open__actions open__actions"},[a("div",{staticClass:"addition-btn",on:{click:function(t){return e.openEditForm(e.currentObject)}}},[a("edit-icon"),e._v(" Редактировать объект ")],1),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.deleteObject(e.currentObject.id)}}},[a("waste-icon"),e._v(" Удалить объект ")],1)]):e._e(),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Объект сдан")]),a("v-checkbox",{attrs:{disabled:-1===e.$parent.$parent.edit.indexOf("Объекты")},on:{change:e.openConfirmArchiveDialog},model:{value:e.currentObject.active,callback:function(t){e.$set(e.currentObject,"active",t)},expression:"currentObject.active"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Клиент")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.client_id.name))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Начало работ")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.date_start))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Окончание работ")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.date_end))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Описание работ")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.work_description))])])]),a("h3",[e._v("Адрес")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Улица")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.street))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Дом")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.house))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Подъезд")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.entrance))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Квартира")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.flat))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Город")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.city))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Индекс")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.index))])])]),a("h3",[e._v("Контактное лицо")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Фамилия")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.contact_id.lastname))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Имя")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.contact_id.name))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Телефон")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.contact_id.work_phone))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("E-mail")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.contact_id.work_email))])])]),a("h3",[e._v("Дополнительная информация")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Жилье")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.habitation))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Страховка от несчастных случаев")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.accident_insurance))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Страховка здоровья")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentObject.health_insurance))])])]),a("h3",[e._v("Работники")]),a("v-list",{staticClass:"workers__list content-list",attrs:{"three-line":""}},[e._l(e.objectWorkers,(function(t){return[a("v-list-item",{key:t.id},[a("v-list-item-content",{on:{click:function(a){return e.openWorker(t)}}},[a("v-list-item-title",[e._v(e._s(t.user_profile_id.lastname)+" "+e._s(t.user_profile_id.name)+" ("+e._s(t.user_profile_id.phone)+") ")]),a("v-list-item-subtitle",[a("span",[e._v(e._s(t.start_date)+" - "+e._s(t.end_date))]),a("br"),a("span",[e._v(e._s(t.comment))])])],1),-1!==e.$parent.$parent.edit.indexOf("Объекты")?a("v-list-item-action",[a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:function(a){return e.openEditWorkerForm(t)}}},[e._v(" $edit ")]),a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:function(a){return e.openConfirmDeleteWorkerDialog(t)}}},[e._v(" $waste ")])],1):e._e()],1)]}))],2),-1!==e.$parent.$parent.edit.indexOf("Объекты")?a("v-list",{staticClass:"content-list__btns"},[a("v-list-item",{staticClass:"content-list__btns-add",on:{click:e.openAddWorkerForm}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Добавить работника")])],1)],1)],1):e._e(),a("h3",[e._v("Комментарии")]),a("div",{staticClass:"objects-open__comments"},e._l(e.comments.comments,(function(t){return a("div",{key:t.id,staticClass:"objects-open__comments-single"},[a("h4",[e._v(" "+e._s(t.user_profile_id.lastname)+" "+e._s(t.user_profile_id.name)+" ("+e._s(t.user_profile_id.position.name)+")")]),a("div",{domProps:{innerHTML:e._s(t.text)}}),a("div",{staticClass:"open__actions"},[a("div",{staticClass:"addition-btn",on:{click:function(a){e.answer=t.text,e.newComment.object_comments_id=t.id}}},[e._v(" Ответить ")]),t.user_profile_id.id===e.comments.profile?a("div",{staticClass:"addition-btn",on:{click:function(a){return e.deleteComment(t.id)}}},[e._v(" Удалить ")]):e._e()]),a("v-divider"),e._l(e.comments.data[t.id],(function(t){return a("div",{key:t.id,staticClass:"objects-open__comments-answers"},[a("h4",[e._v(" "+e._s(t.user_profile_id.lastname)+" "+e._s(t.user_profile_id.name)+" ("+e._s(t.user_profile_id.position.name)+")")]),a("div",{domProps:{innerHTML:e._s(t.text)}}),a("div",{staticClass:"open__actions"},[t.user_profile_id.id===e.comments.profile?a("div",{staticClass:"addition-btn",on:{click:function(a){return e.deleteComment(t.id)}}},[e._v(" Удалить ")]):e._e()])])}))],2)})),0),a("div",{staticClass:"objects-open__comments-add"},[a("v-editor",{attrs:{config:e.editorConfig},model:{value:e.newComment.text,callback:function(t){e.$set(e.newComment,"text",t)},expression:"newComment.text"}}),a("div",{staticClass:"objects-open__comments-add-actions"},[null!=e.newComment.object_comments_id?a("div",{staticClass:"objects-open__comments-add-answerfor"},[a("div",[e._v("Ответ на: "),a("div",{staticClass:"comments__answer",domProps:{innerHTML:e._s(e.answer)}})]),a("v-icon",{staticStyle:{width:"16px"},on:{click:function(t){e.newComment.object_comments_id=null}}},[e._v("$deleteIcon")])],1):e._e(),a("v-btn",{staticClass:"action-btn",attrs:{color:"secondary"},on:{click:e.addComment}},[e._v(" Добавить ")])],1)],1)],1)])]),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:e.closeForm}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"form"},[a("v-text-field",{attrs:{placeholder:"Индекс*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newObject.index,callback:function(t){e.$set(e.newObject,"index",t)},expression:"newObject.index"}}),a("v-row",[a("v-text-field",{attrs:{placeholder:"Город*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newObject.city,callback:function(t){e.$set(e.newObject,"city",t)},expression:"newObject.city"}}),a("v-text-field",{attrs:{placeholder:"Улица*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newObject.street,callback:function(t){e.$set(e.newObject,"street",t)},expression:"newObject.street"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Дом*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newObject.house,callback:function(t){e.$set(e.newObject,"house",t)},expression:"newObject.house"}}),a("v-text-field",{attrs:{placeholder:"Подъезд",outlined:""},model:{value:e.newObject.entrance,callback:function(t){e.$set(e.newObject,"entrance",t)},expression:"newObject.entrance"}}),a("v-text-field",{attrs:{placeholder:"Квартира",outlined:""},model:{value:e.newObject.flat,callback:function(t){e.$set(e.newObject,"flat",t)},expression:"newObject.flat"}})],1),a("v-row",[a("v-menu",{ref:"menu_start",attrs:{"close-on-content-click":!1,"return-value":e.newObject.date_start,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(t){return e.$set(e.newObject,"date_start",t)},"update:return-value":function(t){return e.$set(e.newObject,"date_start",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{placeholder:"Начало работ*",readonly:"",outlined:"",rules:e.reqRules},model:{value:e.newObject.date_start,callback:function(t){e.$set(e.newObject,"date_start",t)},expression:"newObject.date_start"}},"v-text-field",s,!1),n))]}}]),model:{value:e.datePickers.menu_start,callback:function(t){e.$set(e.datePickers,"menu_start",t)},expression:"datePickers.menu_start"}},[a("v-date-picker",{attrs:{"no-title":"",scrollable:"",color:"primary"},model:{value:e.newObject.date_start,callback:function(t){e.$set(e.newObject,"date_start",t)},expression:"newObject.date_start"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.datePickers.menu_start=!1}}},[e._v(" Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.menu_start.save(e.newObject.date_start)}}},[e._v("OK")])],1)],1),a("v-menu",{ref:"menu_end",attrs:{"close-on-content-click":!1,"return-value":e.newObject.date_end,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(t){return e.$set(e.newObject,"date_end",t)},"update:return-value":function(t){return e.$set(e.newObject,"date_end",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{placeholder:"Окончание работ",readonly:"",outlined:"",rules:e.reqRules},model:{value:e.newObject.date_end,callback:function(t){e.$set(e.newObject,"date_end",t)},expression:"newObject.date_end"}},"v-text-field",s,!1),n))]}}]),model:{value:e.datePickers.menu_end,callback:function(t){e.$set(e.datePickers,"menu_end",t)},expression:"datePickers.menu_end"}},[a("v-date-picker",{attrs:{"no-title":"",scrollable:"",color:"primary"},model:{value:e.newObject.date_end,callback:function(t){e.$set(e.newObject,"date_end",t)},expression:"newObject.date_end"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.datePickers.menu_end=!1}}},[e._v(" Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.menu_end.save(e.newObject.date_end)}}},[e._v("OK")])],1)],1)],1),a("v-row",[a("v-select",{attrs:{items:e.clients,"item-text":"name","item-value":"id",rules:e.reqRules,placeholder:"Клиент*",outlined:"",dense:""},on:{change:function(t){return e.loadContacts(e.newObject.client_id)}},model:{value:e.newObject.client_id,callback:function(t){e.$set(e.newObject,"client_id",t)},expression:"newObject.client_id"}}),a("v-select",{attrs:{items:e.contacts,"item-value":"id","item-text":"label","no-data-text":"Выберите клиента",placeholder:"Контактное лицо*",rules:e.reqRules,outlined:"",dense:""},model:{value:e.newObject.contact_id,callback:function(t){e.$set(e.newObject,"contact_id",t)},expression:"newObject.contact_id"}})],1),a("v-text-field",{attrs:{placeholder:"Жилье",outlined:""},model:{value:e.newObject.habitation,callback:function(t){e.$set(e.newObject,"habitation",t)},expression:"newObject.habitation"}}),a("v-row",[a("v-text-field",{attrs:{placeholder:"Страховка от несчастных случаев",outlined:""},model:{value:e.newObject.accident_insurance,callback:function(t){e.$set(e.newObject,"accident_insurance",t)},expression:"newObject.accident_insurance"}}),a("v-text-field",{attrs:{placeholder:"Страховка здоровья",outlined:""},model:{value:e.newObject.health_insurance,callback:function(t){e.$set(e.newObject,"health_insurance",t)},expression:"newObject.health_insurance"}})],1),a("v-textarea",{attrs:{placeholder:"Описание работ",outlined:""},model:{value:e.newObject.work_description,callback:function(t){e.$set(e.newObject,"work_description",t)},expression:"newObject.work_description"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.addObject}},[e._v(e._s(e.formBtnText))])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.addWorkerForm,callback:function(t){e.addWorkerForm=t},expression:"addWorkerForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:e.closeForm}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"workerForm"},[a("v-select",{attrs:{items:e.workers,"item-value":"id","item-text":"label","no-data-text":"Нет свободных работников",placeholder:"Выберите работника*",rules:e.reqRules,outlined:"",dense:""},model:{value:e.addWorker.user_profile_id,callback:function(t){e.$set(e.addWorker,"user_profile_id",t)},expression:"addWorker.user_profile_id"}}),a("v-row",[a("v-menu",{ref:"worker_start",attrs:{"close-on-content-click":!1,"return-value":e.addWorker.start_date,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(t){return e.$set(e.addWorker,"start_date",t)},"update:return-value":function(t){return e.$set(e.addWorker,"start_date",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{placeholder:"Начало работ*",readonly:"",outlined:"",rules:e.reqRules},model:{value:e.addWorker.start_date,callback:function(t){e.$set(e.addWorker,"start_date",t)},expression:"addWorker.start_date"}},"v-text-field",s,!1),n))]}}]),model:{value:e.datePickers.worker_start,callback:function(t){e.$set(e.datePickers,"worker_start",t)},expression:"datePickers.worker_start"}},[a("v-date-picker",{attrs:{"no-title":"",scrollable:"",color:"primary"},model:{value:e.addWorker.start_date,callback:function(t){e.$set(e.addWorker,"start_date",t)},expression:"addWorker.start_date"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.datePickers.worker_start=!1}}},[e._v(" Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.worker_start.save(e.addWorker.start_date)}}},[e._v("OK")])],1)],1),a("v-menu",{ref:"worker_end",attrs:{"close-on-content-click":!1,"return-value":e.addWorker.end_date,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(t){return e.$set(e.addWorker,"end_date",t)},"update:return-value":function(t){return e.$set(e.addWorker,"end_date",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{placeholder:"Окончание работ",readonly:"",outlined:""},model:{value:e.addWorker.end_date,callback:function(t){e.$set(e.addWorker,"end_date",t)},expression:"addWorker.end_date"}},"v-text-field",s,!1),n))]}}]),model:{value:e.datePickers.worker_end,callback:function(t){e.$set(e.datePickers,"worker_end",t)},expression:"datePickers.worker_end"}},[a("v-date-picker",{attrs:{"no-title":"",scrollable:"",color:"primary"},model:{value:e.addWorker.end_date,callback:function(t){e.$set(e.addWorker,"end_date",t)},expression:"addWorker.end_date"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.datePickers.worker_end=!1}}},[e._v(" Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.worker_end.save(e.addWorker.end_date)}}},[e._v("OK")])],1)],1)],1),a("v-textarea",{attrs:{placeholder:"Комментарий",outlined:""},model:{value:e.addWorker.comment,callback:function(t){e.$set(e.addWorker,"comment",t)},expression:"addWorker.comment"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.putObjectUser}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление объекта ")]),a("v-card-text",[e._v("Вы действительно хотите удалить объект? Отменить это действие будет невозможно")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteObject}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteWorkerDialog,callback:function(t){e.confirmDeleteWorkerDialog=t},expression:"confirmDeleteWorkerDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление работника с объекта ")]),a("v-card-text",[e._v("Вы действительно хотите удалить работника с объекта? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteWorkerDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteObjectUser}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmArchiveDialog,callback:function(t){e.confirmArchiveDialog=t},expression:"confirmArchiveDialog"}},[a("v-card",[a("v-card-title",[e._v(" Сдача объекта ")]),a("v-card-text",[e._v(" Вы действительно хотите сдать объект? После подтверждения объект будет перемещен в архив ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:e.cancelConfirmArchiveDialog}},[e._v(" Отменить ")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.editObject}},[e._v("Подтвердить")])],1)],1)],1)],1)},Je=[],et=(a("0481"),{name:"Objects",components:{EditIcon:Te,WasteIcon:De,BackIcon:qe},data:function(){return{page:"objects",objects:[],objectWorkers:[],all:!0,archive:!1,newObject:{id:0,index:"",city:"",street:"",house:"",entrance:"",flat:"",date_start:"",date_end:"",active:!1,client_id:"",contact_id:"",work_description:null,habitation:null,accident_insurance:null,health_insurance:null},currentObject:{id:0,index:"",city:"",street:"",house:"",entrance:"",flat:"",date_start:"",date_end:"",active:!1,client_id:"",contact_id:{email:""},work_description:null,habitation:null,accident_insurance:null,health_insurance:null},addWorker:{id:0,user_profile_id:0,object_id:0,start_date:null,end_date:null,comment:null},newComment:{text:"",object_comments_id:null,objects_id:null},answer:"",photos:"",comments:{comments:[],data:{}},clients:[],contacts:[],workers:[],selects:["Все",'ООО "Праздник"','ООО "Цветы"'],filter:{address:"",client:"Все",dates:[]},datePickers:{menu_filter:!1,menu_start:!1,menu_end:!1,worker_start:!1,worker_end:!1},formTitle:"Добавление объекта",formBtnText:"Добавить объект",addForm:!1,addWorkerForm:!1,confirmArchiveDialog:!1,confirmDeleteDialog:!1,confirmDeleteWorkerDialog:!1,reqRules:[function(e){return!!e||"Необходимо заполнить поле"}],alertError:!1,alertSuccess:!1,alertMsg:"",editorConfig:{printLog:!1,uploadImgUrl:"http://localhost:8000/time-tracking/images/upload",menus:["source","|","bold","underline","italic","strikethrough","eraser","forecolor","bgcolor","|","quote","fontfamily","fontsize","head","unorderlist","orderlist","alignleft","aligncenter","alignright","|","link","unlink","table","|","insertcode","|","undo","redo","fullscreen"],useLang:"en",pasteText:!0}}},created:function(){console.log("init Objects"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(-1===this.$parent.$parent.read.indexOf("Объекты")&&this.$router.push({name:"Index"}),this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadClients()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{initSocket:function(){},loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/objects",type:"GET",success:function(t){e.objects=t.data.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadClients:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"GET",success:function(t){e.clients=t.data.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadContacts:function(e){var t=this;this.newObject.contact_id=null,this.contacts=[],o.a.ajax({url:this.$hostname+"time-tracking/clients/employees/"+e,type:"GET",success:function(e){t.contacts=e.data.data,t.contacts.forEach((function(e){e.label=e.lastname+" "+e.name+", "+e.position.name,console.log(e.label)}))},error:function(e){500===e.status?t.alertMsg="Ошибка соединения с сервером":401===e.status?t.$refresh():t.alertMsg="Непредвиденная ошибка",t.alertError=!0}})},addObject:function(){var e=this;this.$refs.form.validate()&&(0===this.newObject.id?o.a.ajax({url:this.$hostname+"time-tracking/objects",type:"POST",data:{index:this.newObject.index,city:this.newObject.city,street:this.newObject.street,house:this.newObject.house,entrance:this.newObject.entrance,flat:this.newObject.flat,date_start:this.newObject.date_start,date_end:this.newObject.date_end,active:this.newObject.active,client_id:this.newObject.client_id,contact_id:this.newObject.contact_id,work_description:this.newObject.work_description,habitation:this.newObject.habitation,accident_insurance:this.newObject.accident_insurance,health_insurance:this.newObject.health_insurance},success:function(){console.log("Объект добавлен "),e.loadData(),e.closeForm()},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}}):this.editObject())},editObject:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/objects",type:"PUT",data:this.currentObject,success:function(){console.log("Объект изменен "),e.addForm?(e.loadData(),e.closeForm()):e.confirmArchiveDialog=!1},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},deleteObject:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/objects",type:"DELETE",data:{id:this.currentObject.id},success:function(){console.log("Объект удален"),e.loadData()},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},openObject:function(e){this.currentObject=e,this.loadPhoto(e.id),this.all=!1,this.loadWorkers(),this.loadComments(!1)},loadPhoto:function(e){var t=this;o.a.ajax({url:this.$hostname+"time-tracking/objects/photos/"+e,type:"GET",success:function(e){t.photos=e.data.data},error:function(e){500===e.status?t.alertMsg="Ошибка соединения с сервером":401===e.status?t.$refresh():t.alertMsg="Непредвиденная ошибка",t.alertError=!0}})},loadWorkers:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/objects/employees/"+this.currentObject.id,type:"GET",success:function(t){e.objectWorkers=t.data.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}}),o.a.ajax({url:this.$hostname+"time-tracking/objects/employees",type:"GET",success:function(t){e.workers=t.data.data,e.workers.forEach((function(e){e.label=e.lastname+" "+e.name+", "+e.position}))},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadComments:function(e){var t=this;o.a.ajax({url:this.$hostname+"time-tracking/objects/comments/"+this.currentObject.id,type:"GET",success:function(a){e||(t.comments=a.data)},error:function(e){500===e.status?t.alertMsg="Ошибка соединения с сервером":401===e.status?t.$refresh():t.alertMsg="Непредвиденная ошибка",t.alertError=!0}})},putObjectUser:function(){var e=this;this.$refs.workerForm.validate()&&(this.addWorker.object_id=this.currentObject.id,o.a.ajax({url:this.$hostname+"time-tracking/objects/employees",type:"PUT",data:{id:this.addWorker.id,user_profile_id:this.addWorker.user_profile_id,objects_id:this.addWorker.object_id,start_date:this.addWorker.start_date,end_date:this.addWorker.end_date,comment:this.addWorker.comment},success:function(t){console.log(t),e.loadWorkers(),e.addWorkerForm=!1},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}}))},deleteObjectUser:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/objects/employees",type:"DELETE",data:{id:this.addWorker.id},success:function(t){console.log(t),e.loadWorkers(),e.confirmDeleteWorkerDialog=!1},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},openWorker:function(e){console.log(e)},addComment:function(){var e=this;this.newComment.objects_id=this.currentObject.id,o.a.ajax({url:this.$hostname+"time-tracking/objects/comments",type:"POST",data:this.newComment,success:function(){e.loadComments(!1),e.newComment={text:"",object_comments_id:null,objects_id:null}},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},deleteComment:function(e){var t=this;o.a.ajax({url:this.$hostname+"time-tracking/objects/comments/"+e,type:"DELETE",data:this.newComment,success:function(){t.loadComments(!1)},error:function(e){500===e.status?t.alertMsg="Ошибка соединения с сервером":401===e.status?t.$refresh():t.alertMsg="Непредвиденная ошибка",t.alertError=!0}})},openAddForm:function(){this.formTitle="Добавление объекта",this.formBtnText="Добавить объект",this.addForm=!0},openEditForm:function(e){this.formTitle="Редактирование объекта",this.formBtnText="Сохранить объект",this.newObject=e,this.addForm=!0},openAddWorkerForm:function(){this.formTitle="Добавление работника на объект",this.addWorkerForm=!0},openEditWorkerForm:function(e){this.addWorker=e,this.formTitle="Редактирование работника на объекте",this.addWorkerForm=!0},openConfirmArchiveDialog:function(){this.currentObject.active&&!this.all||!this.currentObject.active&&this.all?(this.currentObject.active=!0,this.confirmArchiveDialog=!0):this.editObject()},cancelConfirmArchiveDialog:function(){this.currentObject.active=!1,this.confirmArchiveDialog=!1},openConfirmDeleteDialog:function(e){this.currentObject=e,this.archive||!this.all?this.confirmDeleteDialog=!0:this.openConfirmArchiveDialog()},openConfirmDeleteWorkerDialog:function(e){this.addWorker=e,this.confirmDeleteWorkerDialog=!0},closeForm:function(){this.addForm=!1,this.newObject={id:0,index:"",city:"",street:"",house:"",entrance:"",flat:"",date_start:"",date_end:"",active:!1,client_id:"",contact_id:"",work_description:null,habitation:null,accident_insurance:null,health_insurance:null},this.addWorker={id:0,user_profile_id:0,object_id:0,start_date:null,end_date:null,comment:null},this.addWorkerForm=!1},openFilters:function(){console.log("open filters"),o()(".content-list__filters").addClass("open"),o()(".content-list__btns").addClass("hidden")},closeFilters:function(){console.log("open filters"),o()(".content-list__filters").removeClass("open"),o()(".content-list__btns").removeClass("hidden")}}}),tt=et,at=a("2e4b"),nt=a("ce7e"),st=a("1800"),it=a("e449"),rt=a("0fd9"),ot=a("b974"),lt=Object(m["a"])(tt,Xe,Je,!1,null,"4b81026e",null),ct=lt.exports;v()(lt,{VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCheckbox:ae["a"],VDatePicker:at["a"],VDialog:H["a"],VDivider:nt["a"],VForm:ce["a"],VIcon:h["a"],VList:_["a"],VListItem:g["a"],VListItemAction:st["a"],VListItemContent:k["a"],VListItemIcon:x["a"],VListItemSubtitle:k["b"],VListItemTitle:k["c"],VMenu:it["a"],VRow:rt["a"],VSelect:ot["a"],VSpacer:Qe["a"],VTextField:ue["a"],VTextarea:Q["a"],VToolbar:Ze["a"]});var ut=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"workers flex-content"},[a("div",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h3",[e._v("Работники")]),e.all?e._e():a("div",{staticClass:"addition-btn",on:{click:function(t){e.all=!0}}},[a("span",[e._v("К списку работников")]),a("back-icon")],1),e.all?a("div",{staticClass:" addition-btn content-list__filters-mobile",on:{click:e.openFilters}},[e._v("Фильтры ")]):e._e()]),e.all?a("div",{staticClass:"workers-all all"},[a("div",{staticClass:"content-list__filters"},[a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:e.closeFilters}},[e._v(" $deleteIcon ")]),a("v-text-field",{attrs:{placeholder:"Фамилия Имя",outlined:""},model:{value:e.filter.name,callback:function(t){e.$set(e.filter,"name",t)},expression:"filter.name"}}),a("v-select",{attrs:{items:[{id:0,name:"Все"}].concat(e.positions),"item-text":"name","item-value":"name",placeholder:"Должность",outlined:""},model:{value:e.filter.position,callback:function(t){e.$set(e.filter,"position",t)},expression:"filter.position"}}),a("v-text-field",{attrs:{placeholder:"Почта",outlined:""},model:{value:e.filter.email,callback:function(t){e.$set(e.filter,"email",t)},expression:"filter.email"}})],1),a("v-list",{staticClass:"workers__list content-list",attrs:{"three-line":""}},[e._l(e.profiles,(function(t){return[t.active!==e.archive&&t.auth_user_id.email.includes(e.filter.email)&&(t.name+" "+t.lastname).includes(e.filter.name)&&(t.position.name===e.filter.position||"Все"===e.filter.position)?a("v-list-item",{key:t.id},[a("v-list-item-avatar",{staticClass:"content-list__image"},[t.photo_path?a("v-img",{attrs:{src:e.$hostname+"media"+t.photo_path}}):e._e()],1),a("v-list-item-content",{on:{click:function(a){return e.$router.push({name:"WorkerOpen",params:{id:t.id}})}}},[a("v-list-item-title",[e._v(e._s(t.lastname)+" "+e._s(t.name))]),a("v-list-item-subtitle",[null!==t.position.name?a("span",[e._v(e._s(t.position.name))]):e._e(),a("br"),a("span",[e._v(e._s(t.auth_user_id.email))])])],1),-1!==e.$parent.$parent.edit.indexOf("Работники")?a("v-list-item-action",[a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:function(a){return e.openConfirmDeleteDialog(t)}}},[e._v(" $deleteIcon ")])],1):e._e()],1):e._e()]}))],2),a("v-list",{staticClass:"content-list__btns"},[e.archive||-1===e.$parent.$parent.edit.indexOf("Работники")?e._e():a("v-list-item",{staticClass:"content-list__btns-add",on:{click:e.openAddForm}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Добавить работника")])],1)],1),e.archive?a("v-list-item",{staticClass:"content-list__btns-add",on:{click:function(t){e.archive=!e.archive}}},[a("v-list-item-icon",[a("v-icon",[e._v("$archive")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Выйти из архива")])],1)],1):a("v-list-item",{staticClass:"content-list__btns-add",on:{click:function(t){e.archive=!e.archive}}},[a("v-list-item-icon",[a("v-icon",[e._v("$archive")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Архив")])],1)],1)],1)],1):e._e()]),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:e.closeForm}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"addForm",attrs:{model:e.newProfile}},[a("v-row",[a("v-text-field",{attrs:{placeholder:"Фамилия*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newProfile.lastname,callback:function(t){e.$set(e.newProfile,"lastname",t)},expression:"newProfile.lastname"}}),a("v-text-field",{attrs:{placeholder:"Имя*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newProfile.name,callback:function(t){e.$set(e.newProfile,"name",t)},expression:"newProfile.name"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Гражданство*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newProfile.citizenship,callback:function(t){e.$set(e.newProfile,"citizenship",t)},expression:"newProfile.citizenship"}}),a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"return-value":e.newProfile.birthdate,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(t){return e.$set(e.newProfile,"birthdate",t)},"update:return-value":function(t){return e.$set(e.newProfile,"birthdate",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{readonly:"",placeholder:"Дата рождения*",rules:e.reqRules,outlined:""},model:{value:e.newProfile.birthdate,callback:function(t){e.$set(e.newProfile,"birthdate",t)},expression:"newProfile.birthdate"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("v-date-picker",{attrs:{"no-title":"",scrollable:""},model:{value:e.newProfile.birthdate,callback:function(t){e.$set(e.newProfile,"birthdate",t)},expression:"newProfile.birthdate"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.menu=!1}}},[e._v(" Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.menu.save(e.newProfile.birthdate)}}},[e._v(" OK")])],1)],1)],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Номер социального страхования",outlined:""},model:{value:e.newProfile.social_code_own,callback:function(t){e.$set(e.newProfile,"social_code_own",t)},expression:"newProfile.social_code_own"}}),a("v-text-field",{attrs:{placeholder:"Номер соц. страхования в Финляндии*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newProfile.social_code_fin,callback:function(t){e.$set(e.newProfile,"social_code_fin",t)},expression:"newProfile.social_code_fin"}})],1),a("h4",[e._v("Адрес в своей стране")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Страна",outlined:""},model:{value:e.newProfile.address_own.country,callback:function(t){e.$set(e.newProfile.address_own,"country",t)},expression:"newProfile.address_own.country"}}),a("v-text-field",{attrs:{placeholder:"Город",outlined:""},model:{value:e.newProfile.address_own.city,callback:function(t){e.$set(e.newProfile.address_own,"city",t)},expression:"newProfile.address_own.city"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Улица",outlined:""},model:{value:e.newProfile.address_own.street,callback:function(t){e.$set(e.newProfile.address_own,"street",t)},expression:"newProfile.address_own.street"}}),a("v-text-field",{attrs:{placeholder:"Индекс",outlined:""},model:{value:e.newProfile.address_own.index,callback:function(t){e.$set(e.newProfile.address_own,"index",t)},expression:"newProfile.address_own.index"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Дом",outlined:""},model:{value:e.newProfile.address_own.house,callback:function(t){e.$set(e.newProfile.address_own,"house",t)},expression:"newProfile.address_own.house"}}),a("v-text-field",{attrs:{placeholder:"Подъезд",outlined:""},model:{value:e.newProfile.address_own.entrance,callback:function(t){e.$set(e.newProfile.address_own,"entrance",t)},expression:"newProfile.address_own.entrance"}}),a("v-text-field",{attrs:{placeholder:"Квартира",outlined:""},model:{value:e.newProfile.address_own.flat,callback:function(t){e.$set(e.newProfile.address_own,"flat",t)},expression:"newProfile.address_own.flat"}})],1),a("h4",[e._v("Адрес в Финляндии")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Страна",outlined:""},model:{value:e.newProfile.address_fin.country,callback:function(t){e.$set(e.newProfile.address_fin,"country",t)},expression:"newProfile.address_fin.country"}}),a("v-text-field",{attrs:{placeholder:"Город",outlined:""},model:{value:e.newProfile.address_fin.city,callback:function(t){e.$set(e.newProfile.address_fin,"city",t)},expression:"newProfile.address_fin.city"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Улица",outlined:""},model:{value:e.newProfile.address_fin.street,callback:function(t){e.$set(e.newProfile.address_fin,"street",t)},expression:"newProfile.address_fin.street"}}),a("v-text-field",{attrs:{placeholder:"Индекс",outlined:""},model:{value:e.newProfile.address_fin.index,callback:function(t){e.$set(e.newProfile.address_fin,"index",t)},expression:"newProfile.address_fin.index"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Дом",outlined:""},model:{value:e.newProfile.address_fin.house,callback:function(t){e.$set(e.newProfile.address_fin,"house",t)},expression:"newProfile.address_fin.house"}}),a("v-text-field",{attrs:{placeholder:"Подъезд",outlined:""},model:{value:e.newProfile.address_fin.entrance,callback:function(t){e.$set(e.newProfile.address_fin,"entrance",t)},expression:"newProfile.address_fin.entrance"}}),a("v-text-field",{attrs:{placeholder:"Квартира",outlined:""},model:{value:e.newProfile.address_fin.flat,callback:function(t){e.$set(e.newProfile.address_fin,"flat",t)},expression:"newProfile.address_fin.flat"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Телефон",rules:e.phoneRules,required:"",outlined:""},model:{value:e.newProfile.phone,callback:function(t){e.$set(e.newProfile,"phone",t)},expression:"newProfile.phone"}}),a("v-text-field",{attrs:{placeholder:"Телефон в Финляндии*",rules:e.phoneFinRules,required:"",outlined:""},model:{value:e.newProfile.phone_fin,callback:function(t){e.$set(e.newProfile,"phone_fin",t)},expression:"newProfile.phone_fin"}})],1),a("v-text-field",{attrs:{placeholder:"Почта*",rules:e.emailRules,required:"",outlined:""},model:{value:e.newProfile.email,callback:function(t){e.$set(e.newProfile,"email",t)},expression:"newProfile.email"}}),a("v-text-field",{attrs:{placeholder:"Номер счета в банке*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newProfile.bank_account,callback:function(t){e.$set(e.newProfile,"bank_account",t)},expression:"newProfile.bank_account"}}),a("v-text-field",{attrs:{placeholder:"Налоговый номер*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newProfile.tax_number,callback:function(t){e.$set(e.newProfile,"tax_number",t)},expression:"newProfile.tax_number"}}),a("v-row",[a("v-checkbox",{attrs:{label:"Свой автомобиль"},model:{value:e.newProfile.auto,callback:function(t){e.$set(e.newProfile,"auto",t)},expression:"newProfile.auto"}}),a("v-checkbox",{attrs:{label:"Свой инструмент"},model:{value:e.newProfile.tool,callback:function(t){e.$set(e.newProfile,"tool",t)},expression:"newProfile.tool"}})],1),a("h4",[e._v("Языки")]),a("v-row",[a("v-checkbox",{attrs:{label:"Английский"},model:{value:e.newProfile.english,callback:function(t){e.$set(e.newProfile,"english",t)},expression:"newProfile.english"}}),a("v-checkbox",{attrs:{label:"Финский"},model:{value:e.newProfile.finnish,callback:function(t){e.$set(e.newProfile,"finnish",t)},expression:"newProfile.finnish"}}),a("v-checkbox",{attrs:{label:"Русский"},model:{value:e.newProfile.russian,callback:function(t){e.$set(e.newProfile,"russian",t)},expression:"newProfile.russian"}}),a("v-checkbox",{attrs:{label:"Эстонский"},model:{value:e.newProfile.estonian,callback:function(t){e.$set(e.newProfile,"estonian",t)},expression:"newProfile.estonian"}})],1),a("v-text-field",{attrs:{placeholder:"Другие языки",outlined:""},model:{value:e.newProfile.other_language,callback:function(t){e.$set(e.newProfile,"other_language",t)},expression:"newProfile.other_language"}}),a("v-combobox",{ref:"positionCombobox",attrs:{items:e.positions,"item-value":"id","item-text":"name",placeholder:"Должность*",outlined:"",dense:"",rules:e.reqRules},model:{value:e.newProfile.position,callback:function(t){e.$set(e.newProfile,"position",t)},expression:"newProfile.position"}}),a("v-textarea",{attrs:{placeholder:"Что умеете делать?",outlined:""},model:{value:e.newProfile.skills,callback:function(t){e.$set(e.newProfile,"skills",t)},expression:"newProfile.skills"}}),a("h4",[e._v("Одежда")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Ботинки",outlined:""},model:{value:e.newProfile.boots,callback:function(t){e.$set(e.newProfile,"boots",t)},expression:"newProfile.boots"}}),a("v-text-field",{attrs:{placeholder:"Куртка",outlined:""},model:{value:e.newProfile.jacket,callback:function(t){e.$set(e.newProfile,"jacket",t)},expression:"newProfile.jacket"}}),a("v-text-field",{attrs:{placeholder:"Штаны",outlined:""},model:{value:e.newProfile.pants,callback:function(t){e.$set(e.newProfile,"pants",t)},expression:"newProfile.pants"}}),a("v-text-field",{attrs:{placeholder:"Футболка",outlined:""},model:{value:e.newProfile.shirt,callback:function(t){e.$set(e.newProfile,"shirt",t)},expression:"newProfile.shirt"}})],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.addUser}},[e._v(e._s(e.formBtnText))])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление работника ")]),a("v-card-text",[e._v("Вы действительно хотите удалить профиль? Отменить это действие будет невозможно")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){return e.deleteUser(null)}}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmArchiveDialog,callback:function(t){e.confirmArchiveDialog=t},expression:"confirmArchiveDialog"}},[a("v-card",[a("v-card-title",[e._v(" Увольнение работника ")]),a("v-card-text",[e._v(" Вы действительно хотите уволить работника? После подтверждения профиль будет перемещен в архив ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:e.cancelConfirmArchiveDialog}},[e._v(" Отменить ")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.editProfile}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.photoDialog,callback:function(t){e.photoDialog=t},expression:"photoDialog"}},[a("v-card",[a("v-card-title",[e._v(" Сменить фото ")]),a("v-card-text",[a("v-file-input",{attrs:{placeholder:"Фото профиля",accept:"image/*","prepend-icon":"",outlined:""},model:{value:e.photoField,callback:function(t){e.photoField=t},expression:"photoField"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.savePhoto}},[e._v("Сохранить")])],1)],1)],1)],1)},dt=[],mt={name:"Workers",components:{BackIcon:qe},data:function(){return{page:"home",all:!0,full:!1,archive:!1,profiles:{},positions:[],newProfile:{id:0,lastname:"",name:"",citizenship:"",birthdate:"",social_code_own:"",social_code_fin:"",address_own:{index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""},address_fin:{index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""},phone:"",phone_fin:"",email:"",bank_account:"",tax_number:"",auto:!1,tool:!1,english:!1,estonian:!1,finnish:!1,russian:!1,other_language:"",position:"",skills:"",boots:null,jacket:null,pants:null,shirt:null,is_staff:!1,photo_path:null},currentProfile:{id:0,auth_user_id:"",lastname:"",name:"",position:"",email:"",phone:"",is_staff:!1,active:!0,photo_path:null},filter:{name:"",position:"Все",email:""},formTitle:"Добавление работника",formBtnText:"Добавить работника",addForm:!1,confirmArchiveDialog:!1,confirmDeleteDialog:!1,photoField:null,photoDialog:!1,menu:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}],emailRules:[function(e){return!!e||"Необходимо заполнить поле"},function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||"Некорректный E-mail"}],phoneRules:[function(e){return/^(\+)?((\d{2,3}) ?\d|\d)(([ -]?\d)|( ?(\d{2,3}) ?)){5,12}\d$/.test(e)||"Некорректный номер телефона"}],phoneFinRules:[function(e){return!!e||"Необходимо заполнить поле"},function(e){return/^((([+][\s]{0,1})|([0]{2}[\s-]{0,1}))([358]{3})([\s-]{0,1})|([0]{1}))(([1-9]{1}[0-9]{0,1})([\s-]{0,1})([0-9]{2,4})([\s-]{0,1})([0-9]{2,4})([\s-]{0,1}))([0-9]{0,3}){1}$/.test(e)||"Некорректный номер телефона"}]}},mounted:function(){console.log("init Workers"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),-1===this.$parent.$parent.read.indexOf("Работники")&&this.$router.push({name:"Index"}),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadPositions()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/profiles",type:"GET",success:function(t){e.profiles=t.data.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadPositions:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/profiles/positions",type:"GET",success:function(t){e.positions=t.data.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},addUser:function(){var e=this;this.$refs.addForm.validate()?0!==this.newProfile.id?this.editProfile():o.a.ajax({url:this.$hostname+"time-tracking/user",type:"POST",data:{username:this.newProfile.email,email:this.newProfile.email,is_staff:this.newProfile.is_staff,password:"12345678"},success:function(t){e.addProfile(t.data.data.id)},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}}):(this.alertError=!0,this.alertMsg="Заполните все обязательные поля")},addProfile:function(e){var t=this;o.a.ajax({url:this.$hostname+"time-tracking/profiles",type:"POST",data:{auth_user_id:e,name:this.newProfile.name,lastname:this.newProfile.lastname,citizenship:this.newProfile.citizenship,birthdate:this.newProfile.birthdate,social_code_own:this.newProfile.social_code_own,social_code_fin:this.newProfile.social_code_fin,address_own:JSON.stringify(this.newProfile.address_own),address_fin:JSON.stringify(this.newProfile.address_fin),phone:this.newProfile.phone,phone_fin:this.newProfile.phone_fin,bank_account:this.newProfile.bank_account,tax_number:this.newProfile.tax_number,auto:this.newProfile.auto,tool:this.newProfile.tool,english:this.newProfile.english,estonian:this.newProfile.estonian,finnish:this.newProfile.finnish,russian:this.newProfile.russian,other_language:this.newProfile.other_language,position:this.newProfile.position.id,skills:this.newProfile.skills,boots:this.newProfile.boots,jacket:this.newProfile.jacket,pants:this.newProfile.pants,shirt:this.newProfile.shirt,photo_path:this.currentProfile.photo_path,active:!0},success:function(){t.alertMsg="Пользователь добавлен",t.closeForm(),t.loadData()},error:function(e){t.alertError=!0,t.alertMsg="Непредвиденная ошибка",console.log(e.data)}})},editProfile:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/profiles",type:"PUT",data:this.currentProfile,success:function(){console.log("Профиль изменен"),e.addForm?e.editUser():(e.confirmArchiveDialog=!1,e.loadData())},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},editUser:function(){var e=this;this.currentProfile.auth_user_id.email=this.newProfile.email,o.a.ajax({url:this.$hostname+"time-tracking/user",type:"PUT",data:{id:this.newProfile.auth_user_id.id,username:this.newProfile.email,email:this.newProfile.email},success:function(){console.log("Пользователь изменен"),e.loadData(),e.closeForm()},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},savePhoto:function(){var e=this,t=a("bc3a"),n=new FormData,s=this.photoField;void 0!==s?(n.append("image",s),t({method:"put",url:this.$hostname+"time-tracking/profiles/"+this.currentProfile.id,headers:{Authorization:"Token "+(sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token"))},data:n}).then((function(t){console.log(t.data.data),e.photoDialog=!1,e.photoField=null,e.currentProfile.photo_path=t.data.data.name,e.loadData()}))):console.log("ERROR")},deleteUser:function(e){var t=this;null==e&&(e=this.currentProfile.email),console.log(e),o.a.ajax({url:this.$hostname+"time-tracking/user",type:"DELETE",data:{email:e},success:function(){t.alertMsg="Пользователь удален",t.loadData(),t.confirmDeleteDialog=!1},error:function(e){500===e.status?t.alertMsg="Ошибка соединения с сервером":401===e.status?t.$refresh():t.alertMsg="Непредвиденная ошибка",t.alertError=!0}})},openProfile:function(e){this.currentProfile=e,this.all=!1},closeForm:function(){this.addForm=!1,this.newProfile={id:0,lastname:"",name:"",citizenship:"",birthdate:"",social_code_own:"",social_code_fin:"",address_own:{index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""},address_fin:{index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""},phone:"",phone_fin:"",email:"",bank_account:"",tax_number:"",auto:!1,tool:!1,english:!1,estonian:!1,finnish:!1,russian:!1,other_language:"",position:"",skills:"",boots:null,jacket:null,pants:null,shirt:null,photo_path:null,is_staff:!1}},openAddForm:function(){this.formTitle="Добавление работника",this.formBtnText="Добавить работника",this.addForm=!0},openEditForm:function(e){this.formTitle="Редактирование работника",this.formBtnText="Сохранить работника",this.newProfile=e,this.newProfile.email=e.auth_user_id.email,this.addForm=!0},openConfirmArchiveDialog:function(){console.log(this.currentProfile.id),!this.currentProfile.active&&!this.all||this.currentProfile.active&&this.all?(this.currentProfile.active=!1,this.confirmArchiveDialog=!0):this.editProfile()},cancelConfirmArchiveDialog:function(){this.currentProfile.active=!0,this.confirmArchiveDialog=!1},openConfirmDeleteDialog:function(e){this.currentProfile=e,this.currentProfile.email=e.auth_user_id.email,this.archive||!this.all?this.confirmDeleteDialog=!0:this.openConfirmArchiveDialog()},openFilters:function(){console.log("open filters"),o()(".content-list__filters").addClass("open"),o()(".content-list__btns").addClass("hidden")},closeFilters:function(){console.log("open filters"),o()(".content-list__filters").removeClass("open"),o()(".content-list__btns").removeClass("hidden")}}},ft=mt,vt=a("2b5d"),ht=a("8270"),pt=Object(m["a"])(ft,ut,dt,!1,null,"758fdcc7",null),_t=pt.exports;v()(pt,{VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCheckbox:ae["a"],VCombobox:vt["a"],VDatePicker:at["a"],VDialog:H["a"],VFileInput:He["a"],VForm:ce["a"],VIcon:h["a"],VImg:p["a"],VList:_["a"],VListItem:g["a"],VListItemAction:st["a"],VListItemAvatar:ht["a"],VListItemContent:k["a"],VListItemIcon:x["a"],VListItemSubtitle:k["b"],VListItemTitle:k["c"],VMenu:it["a"],VRow:rt["a"],VSelect:ot["a"],VSpacer:Qe["a"],VTextField:ue["a"],VTextarea:Q["a"],VToolbar:Ze["a"]});var bt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"documents flex-content"},[a("div",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h3",[e._v("Документы")]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.go(-1)}}},[a("span",[e._v("Назад")]),a("back-icon")],1)]),a("div",{staticClass:"documents-all all"},[a("v-data-table",{attrs:{headers:e.headers,items:e.documents,"item-key":"id"},on:{"click:row":e.downloadFile},scopedSlots:e._u([{key:"item.actions",fn:function(t){var n=t.item;return[void 0===e.id||-1!==e.$parent.$parent.edit.indexOf("Работники")?a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.openEditForm(n)}}},[e._v(" mdi-pencil ")]):e._e(),void 0===e.id||-1!==e.$parent.$parent.edit.indexOf("Работники")?a("v-icon",{attrs:{small:""},on:{click:function(t){return e.openConfirmDeleteDialog(n)}}},[e._v(" mdi-delete ")]):e._e()]}},{key:"no-data",fn:function(){return[e._v(" Документы не загружены ")]},proxy:!0}])}),a("v-list",{staticClass:"content-list__btns"},[void 0===e.id||-1!==e.$parent.$parent.edit.indexOf("Работники")?a("v-list-item",{staticClass:"content-list__btns-add",on:{click:e.openAddForm}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Добавить документ")])],1)],1):e._e()],1)],1)]),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-card-title",[e._v(" "+e._s(e.formTitle)+" ")]),a("v-card-text",[a("v-form",{ref:"form",attrs:{model:e.currentDocument}},[a("v-text-field",{attrs:{placeholder:"Название документа*",outlined:"",rules:e.reqRules,required:""},model:{value:e.currentDocument.name,callback:function(t){e.$set(e.currentDocument,"name",t)},expression:"currentDocument.name"}}),e.editFile?e._e():a("v-btn",{attrs:{text:""},on:{click:function(t){e.editFile=!0}}},[e._v("Изменить файл")]),e.editFile?a("v-file-input",{attrs:{placeholder:"Выберите документ*",accept:"*","prepend-icon":"",outlined:"",rules:e.reqRules},on:{change:e.showDoc},model:{value:e.currentDocument.path,callback:function(t){e.$set(e.currentDocument,"path",t)},expression:"currentDocument.path"}}):e._e()],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.putDocument}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление документа ")]),a("v-card-text",[e._v(" Вы действительно хотите удалить выбранный документ? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteDocument}},[e._v("Подтвердить")])],1)],1)],1)],1)},gt=[],kt=(a("a9e3"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),{name:"Documents",components:{BackIcon:qe},props:{type:String,id:[String,Number,void 0]},data:function(){return{profile:{},documents:[],currentDocument:{id:0,name:null,create_date:null,path:null},headers:[{text:"Название",align:"start",sortable:!0,value:"name"},{text:"Дата создания",value:"create_date"},{text:"",value:"actions",sortable:!1}],formTitle:"Добавить документ",editFile:!1,addForm:!1,confirmDeleteDialog:!1,reqRules:[function(e){return!!e||"Необходимо заполнить поле"}]}},created:function(){localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(-1===this.$parent.$parent.read.indexOf("Работники")&&this.$router.push({name:"Index"}),this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{showDoc:function(){console.log(this.currentDocument.path.type)},loadData:function(){var e=this,t="";t=void 0!==this.id?"time-tracking/documents/"+this.type+"/"+this.id:"time-tracking/documents/"+this.type,o.a.ajax({url:this.$hostname+t,type:"GET",success:function(t){e.documents=t.data.documents,e.profile=t.data.profile},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},putDocument:function(){var e=this;if(this.$refs.form.validate()){var t=a("bc3a"),n=new FormData;if(this.editFile){var s=this.currentDocument.path;if(void 0===s)return void console.log("ERROR");n.append("document",s)}else n.append("path",this.currentDocument.path);n.append("id",this.currentDocument.id),n.append("create_date",this.currentDocument.create_date),n.append("name",this.currentDocument.name),n.append("user_profile_id",this.id),t({method:"put",url:this.$hostname+"time-tracking/documents/"+this.type,headers:{Authorization:"Token "+(sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token"))},data:n}).then((function(t){console.log(t.data.data),e.addForm=!1,e.loadData()}))}},deleteDocument:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/documents/"+this.type,type:"DELETE",data:{id:this.currentDocument.id},success:function(){console.log("Документ удален"),e.confirmDeleteDialog=!1,e.loadData()},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},downloadFile:function(e){var t=a("bc3a");t({url:this.$hostname+"media"+e.path,method:"GET",responseType:"blob"}).then((function(t){var a=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=a,n.setAttribute("download",e.path),document.body.appendChild(n),n.click()}))},openAddForm:function(){this.editFile=!0,this.formTitle="Добавить документ",this.currentDocument={id:0,name:null,create_date:null,path:null},this.addForm=!0},openEditForm:function(e){this.editFile=!1,this.formTitle="Редактировать документ",this.currentDocument=e,this.addForm=!0},openConfirmDeleteDialog:function(e){this.currentDocument=e,this.confirmDeleteDialog=!0}}}),wt=kt,xt=a("8fea"),Ct=Object(m["a"])(wt,bt,gt,!1,null,"42412956",null),yt=Ct.exports;v()(Ct,{VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VDataTable:xt["a"],VDialog:H["a"],VFileInput:He["a"],VForm:ce["a"],VIcon:h["a"],VList:_["a"],VListItem:g["a"],VListItemContent:k["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VSpacer:Qe["a"],VTextField:ue["a"]});var $t=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"index flex-content"},[a("div",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h3",[e._v("Новости")]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.go(-1)}}},[a("span",[e._v("К списку новостей")]),a("back-icon")],1)]),a("div",{staticClass:"news-open"},[a("h4",[e._v(e._s(e.currentNew.title))]),a("div",{staticClass:"news-open__image"},[e.currentNew.photo_path?a("v-img",{attrs:{src:e.$hostname+"media"+e.currentNew.photo_path}}):e._e()],1),a("div",{staticClass:"news-open__text",domProps:{innerHTML:e._s(e.currentNew.text)}})])])])},Dt=[],Pt={name:"NewOpen",components:{BackIcon:qe},props:{id:[String,Number]},created:function(){var e=this;console.log(this.currentNew),o.a.ajax({url:this.$hostname+"time-tracking/news/"+this.id,type:"GET",success:function(t){e.currentNew=t.data.data[0],console.log(e.currentNew)},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},data:function(){return{currentNew:null}}},Et=Pt,Mt=Object(m["a"])(Et,$t,Dt,!1,null,"1ad79586",null),It=Mt.exports;v()(Mt,{VImg:p["a"]});var St=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"clients flex-content"},[a("div",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h3",[e._v("Клиенты")]),a("div",{staticClass:" addition-btn content-list__filters-mobile",on:{click:e.openFilters}},[e._v(" Фильтры ")])]),a("div",{staticClass:"clients-all all"},[a("div",{staticClass:"content-list__filters"},[a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:e.closeFilters}},[e._v(" $deleteIcon ")]),a("v-text-field",{attrs:{placeholder:"Название",outlined:""},model:{value:e.filter.name,callback:function(t){e.$set(e.filter,"name",t)},expression:"filter.name"}}),a("v-select",{attrs:{items:["Все"].concat(e.selectsBranch),placeholder:"Отрасль",outlined:""},model:{value:e.filter.branch,callback:function(t){e.$set(e.filter,"branch",t)},expression:"filter.branch"}})],1),a("v-list",{staticClass:"clients__list content-list",attrs:{"three-line":""}},[e._l(e.clients,(function(t){return[t.active!==!e.archive||!t.name.includes(e.filter.name)||t.branch!==e.filter.branch&&"Все"!==e.filter.branch?e._e():a("v-list-item",{key:t.id},[a("v-list-item-avatar",{staticClass:"content-list__image"},[t.logo_path?a("v-img",{attrs:{src:e.$hostname+"media"+t.logo_path}}):e._e()],1),a("v-list-item-content",{on:{click:function(a){return e.$router.push({name:"ClientOpen",params:{id:t.id}})}}},[a("v-list-item-title",[e._v(e._s(t.name))]),a("v-list-item-subtitle",[a("span",[e._v(e._s(t.phone))]),a("br"),a("span",[e._v(e._s(t.email))])])],1),-1!==e.$parent.$parent.edit.indexOf("Клиенты")?a("v-list-item-action",[a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:function(a){return e.openConfirmDeleteDialog(t)}}},[e._v(" $deleteIcon ")])],1):e._e()],1)]}))],2),a("v-list",{staticClass:"content-list__btns"},[e.archive||-1===e.$parent.$parent.edit.indexOf("Клиенты")?e._e():a("v-list-item",{staticClass:"content-list__btns-add",on:{click:e.openAddForm}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Добавить клиента")])],1)],1),e.archive?a("v-list-item",{staticClass:"content-list__btns-add",on:{click:function(t){e.archive=!e.archive}}},[a("v-list-item-icon",[a("v-icon",[e._v("$archive")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Выйти из архива")])],1)],1):a("v-list-item",{staticClass:"content-list__btns-add",on:{click:function(t){e.archive=!e.archive}}},[a("v-list-item-icon",[a("v-icon",[e._v("$archive")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Архив")])],1)],1)],1)],1)]),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:e.closeForm}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"addForm",attrs:{model:e.newClient}},[a("v-row",[a("v-text-field",{attrs:{placeholder:"Название юрлица*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newClient.name,callback:function(t){e.$set(e.newClient,"name",t)},expression:"newClient.name"}}),a("v-text-field",{attrs:{placeholder:"Краткое название*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newClient.short_name,callback:function(t){e.$set(e.newClient,"short_name",t)},expression:"newClient.short_name"}})],1),a("v-row",[a("v-combobox",{attrs:{placeholder:"Отрасль*",items:e.selectsBranch,rules:e.reqRules,required:"",outlined:""},model:{value:e.newClient.branch,callback:function(t){e.$set(e.newClient,"branch",t)},expression:"newClient.branch"}}),a("v-text-field",{attrs:{placeholder:"ОГРН*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newClient.ogrn,callback:function(t){e.$set(e.newClient,"ogrn",t)},expression:"newClient.ogrn"}})],1),a("h4",[e._v("Юридический адрес")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Страна*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newClient.business_address.country,callback:function(t){e.$set(e.newClient.business_address,"country",t)},expression:"newClient.business_address.country"}}),a("v-text-field",{attrs:{placeholder:"Город*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newClient.business_address.city,callback:function(t){e.$set(e.newClient.business_address,"city",t)},expression:"newClient.business_address.city"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Улица*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newClient.business_address.street,callback:function(t){e.$set(e.newClient.business_address,"street",t)},expression:"newClient.business_address.street"}}),a("v-text-field",{attrs:{placeholder:"Индекс*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newClient.business_address.index,callback:function(t){e.$set(e.newClient.business_address,"index",t)},expression:"newClient.business_address.index"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Дом*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newClient.business_address.house,callback:function(t){e.$set(e.newClient.business_address,"house",t)},expression:"newClient.business_address.house"}}),a("v-text-field",{attrs:{placeholder:"Подъезд",outlined:""},model:{value:e.newClient.business_address.entrance,callback:function(t){e.$set(e.newClient.business_address,"entrance",t)},expression:"newClient.business_address.entrance"}}),a("v-text-field",{attrs:{placeholder:"Квартира",outlined:""},model:{value:e.newClient.business_address.flat,callback:function(t){e.$set(e.newClient.business_address,"flat",t)},expression:"newClient.business_address.flat"}})],1),a("h4",[e._v("Адрес доставки")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Страна",outlined:""},model:{value:e.newClient.warehouse_address.country,callback:function(t){e.$set(e.newClient.warehouse_address,"country",t)},expression:"newClient.warehouse_address.country"}}),a("v-text-field",{attrs:{placeholder:"Город",outlined:""},model:{value:e.newClient.warehouse_address.city,callback:function(t){e.$set(e.newClient.warehouse_address,"city",t)},expression:"newClient.warehouse_address.city"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Улица",outlined:""},model:{value:e.newClient.warehouse_address.street,callback:function(t){e.$set(e.newClient.warehouse_address,"street",t)},expression:"newClient.warehouse_address.street"}}),a("v-text-field",{attrs:{placeholder:"Индекс",outlined:""},model:{value:e.newClient.warehouse_address.index,callback:function(t){e.$set(e.newClient.warehouse_address,"index",t)},expression:"newClient.warehouse_address.index"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Дом",outlined:""},model:{value:e.newClient.warehouse_address.house,callback:function(t){e.$set(e.newClient.warehouse_address,"house",t)},expression:"newClient.warehouse_address.house"}}),a("v-text-field",{attrs:{placeholder:"Подъезд",outlined:""},model:{value:e.newClient.warehouse_address.entrance,callback:function(t){e.$set(e.newClient.warehouse_address,"entrance",t)},expression:"newClient.warehouse_address.entrance"}}),a("v-text-field",{attrs:{placeholder:"Квартира",outlined:""},model:{value:e.newClient.warehouse_address.flat,callback:function(t){e.$set(e.newClient.warehouse_address,"flat",t)},expression:"newClient.warehouse_address.flat"}})],1),a("h4",[e._v("Контакты")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Телефон*",rules:e.phoneRules,required:"",outlined:""},model:{value:e.newClient.phone,callback:function(t){e.$set(e.newClient,"phone",t)},expression:"newClient.phone"}}),a("v-text-field",{attrs:{placeholder:"Почта*",rules:e.emailReqRules,required:"",outlined:""},model:{value:e.newClient.email,callback:function(t){e.$set(e.newClient,"email",t)},expression:"newClient.email"}})],1),a("v-text-field",{attrs:{placeholder:"Сайт",outlined:""},model:{value:e.newClient.site,callback:function(t){e.$set(e.newClient,"site",t)},expression:"newClient.site"}}),a("h4",[e._v("Банковская информация")]),a("v-text-field",{attrs:{placeholder:"Номер счета в банке*",outlined:""},model:{value:e.newClient.bank_account,callback:function(t){e.$set(e.newClient,"bank_account",t)},expression:"newClient.bank_account"}}),a("v-row",[a("v-text-field",{attrs:{placeholder:"Банк",outlined:""},model:{value:e.newClient.bank,callback:function(t){e.$set(e.newClient,"bank",t)},expression:"newClient.bank"}}),a("v-text-field",{attrs:{placeholder:"BIC/SWIFT",outlined:""},model:{value:e.newClient.bic,callback:function(t){e.$set(e.newClient,"bic",t)},expression:"newClient.bic"}})],1),a("v-select",{attrs:{items:e.selectsVat,placeholder:"НДС","item-text":"text","item-value":"value",outlined:""},model:{value:e.newClient.vat,callback:function(t){e.$set(e.newClient,"vat",t)},expression:"newClient.vat"}}),a("v-row",[a("v-text-field",{attrs:{placeholder:"Оператор эл. счетов",outlined:""},model:{value:e.newClient.account_operator,callback:function(t){e.$set(e.newClient,"account_operator",t)},expression:"newClient.account_operator"}}),a("v-text-field",{attrs:{placeholder:"Индекс посредника",outlined:""},model:{value:e.newClient.index_operator,callback:function(t){e.$set(e.newClient,"index_operator",t)},expression:"newClient.index_operator"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Номер эл. счетов",outlined:""},model:{value:e.newClient.electronic_number,callback:function(t){e.$set(e.newClient,"electronic_number",t)},expression:"newClient.electronic_number"}}),a("v-text-field",{attrs:{placeholder:"Email для счетов",outlined:""},model:{value:e.newClient.account_email,callback:function(t){e.$set(e.newClient,"account_email",t)},expression:"newClient.account_email"}})],1)],1),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.addClient}},[e._v(e._s(e.formBtnText))])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление клиента ")]),a("v-card-text",[e._v("Вы действительно хотите удалить фирму? Отменить это действие будет невозможно")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){return e.deleteClient(null)}}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmArchiveDialog,callback:function(t){e.confirmArchiveDialog=t},expression:"confirmArchiveDialog"}},[a("v-card",[a("v-card-title",[e._v(" Архивирование клиента ")]),a("v-card-text",[e._v(" Вы действительно хотите архивировать клиента? После подтверждения клиент будет перемещен в архив ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmArchiveDialog=!1}}},[e._v(" Отменить ")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.archiveClient}},[e._v("Подтвердить")])],1)],1)],1)],1)},Tt=[],Vt={name:"Clients",data:function(){return{page:"clients",archive:!1,clients:[],newClient:{name:"",short_name:"",ogrn:"",business_address:{index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""},warehouse_address:{index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""},phone:"",email:"",site:"",vat:0,branch:"",bank_account:"",bank:"",bic:"",account_operator:"",index_operator:"",electronic_number:"",account_email:"",logo_path:""},currentClient:{id:0,active:!0},selectsVat:[{text:"0%",value:0},{text:"10%",value:10},{text:"20%",value:20}],selectsBranch:[],filter:{name:"",branch:"Все"},photoField:null,formTitle:"Добавление клиента",formBtnText:"Добавить клиента",addForm:!1,confirmDeleteDialog:!1,confirmArchiveDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}],emailReqRules:[function(e){return!!e||"Необходимо заполнить поле"},function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||"Некорректный E-mail"}],emailRules:[function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||"Некорректный E-mail"}],phoneRules:[function(e){return!!e||"Необходимо заполнить поле"},function(e){return/^(\+)?((\d{2,3}) ?\d|\d)(([ -]?\d)|( ?(\d{2,3}) ?)){5,12}\d$/.test(e)||"Некорректный номер телефона"}]}},created:function(){console.log("init Clients"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(-1===this.$parent.$parent.read.indexOf("Клиенты")&&this.$router.push({name:"Index"}),this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"GET",success:function(t){e.clients=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}}),o.a.ajax({url:this.$hostname+"time-tracking/clients/branches",type:"GET",success:function(t){e.selectsBranch=t.data.branches},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},addClient:function(){var e=this;this.$refs.addForm.validate()?o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"POST",data:{name:this.newClient.name,short_name:this.newClient.short_name,ogrn:this.newClient.ogrn,business_address:JSON.stringify(this.newClient.business_address),warehouse_address:JSON.stringify(this.newClient.warehouse_address),phone:this.newClient.phone,email:this.newClient.email,site:this.newClient.site,vat:this.newClient.vat,branch:this.newClient.branch,bank_account:this.newClient.bank_account,bank:this.newClient.bank,bic:this.newClient.bic,account_operator:this.newClient.account_operator,index_operator:this.newClient.index_operator,electronic_number:this.newClient.electronic_number,account_email:this.newClient.account_email,logo_path:this.newClient.logo_path},success:function(){e.closeForm(),e.loadData()},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}}):(this.alertMsg="Заполните обязательные поля",this.alertError=!0)},archiveClient:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"PUT",data:{id:this.currentClient.id,active:!this.currentClient.active},success:function(){e.loadData(),e.confirmArchiveDialog=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},deleteClient:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"DELETE",data:{id:this.currentClient.id},success:function(){e.loadData(),e.confirmDeleteDialog=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},openAddForm:function(){this.formTitle="Добавление клиента",this.formBtnText="Добавить клиента",this.addForm=!0},openEditForm:function(e){this.formTitle="Редактирование клиента",this.formBtnText="Сохранить",this.newClient=e,this.addForm=!0},closeForm:function(){this.addForm=!1,this.alertError=!1,this.newClient={name:"",short_name:"",ogrn:"",business_address:{index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""},warehouse_address:{index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""},phone:"",email:"",site:"",vat:0,branch:"",bank_account:"",bank:"",bic:"",account_operator:"",index_operator:"",electronic_number:"",account_email:"",logo_path:""}},openConfirmDeleteDialog:function(e){this.currentClient.id=e.id,this.currentClient.active=e.active,this.archive?this.confirmDeleteDialog=!0:this.confirmArchiveDialog=!0},openFilters:function(){console.log("open filters"),o()(".content-list__filters").addClass("open"),o()(".content-list__btns").addClass("hidden")},closeFilters:function(){console.log("open filters"),o()(".content-list__filters").removeClass("open"),o()(".content-list__btns").removeClass("hidden")}}},jt=Vt,Ft=Object(m["a"])(jt,St,Tt,!1,null,"8ddccff4",null),Ot=Ft.exports;v()(Ft,{VAlert:te["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCombobox:vt["a"],VDialog:H["a"],VForm:ce["a"],VIcon:h["a"],VImg:p["a"],VList:_["a"],VListItem:g["a"],VListItemAction:st["a"],VListItemAvatar:ht["a"],VListItemContent:k["a"],VListItemIcon:x["a"],VListItemSubtitle:k["b"],VListItemTitle:k["c"],VRow:rt["a"],VSelect:ot["a"],VSpacer:Qe["a"],VTextField:ue["a"],VToolbar:Ze["a"]});var At=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"clients flex-content"},[a("div",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h3",[e._v("Клиенты")]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.go(-1)}}},[a("span",[e._v("К списку клиентов")]),a("back-icon")],1)]),a("div",{staticClass:"clients-open workers-open"},[a("div",{staticClass:"profile__image clients-open__image"},[e.currentClient.logo_path?a("v-img",{attrs:{"lazy-src":e.$hostname+"media"+e.currentClient.logo_path,src:e.$hostname+"media"+e.currentClient.logo_path}}):e._e(),-1!==e.$parent.$parent.edit.indexOf("Клиенты")?a("div",{staticClass:"profile__change-photo",on:{click:function(t){e.photoDialog=!0}}},[e._v("Сменить фото ")]):e._e()],1),a("div",{staticClass:"profile__info"},[a("h3",[e._v("Общая информация")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Название")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.name))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Краткое название")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.short_name))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Отрасль")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.branch))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("ОГРН")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.ogrn))])])]),a("h3",[e._v("Контакты")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Телефон")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.phone))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("E-mail")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.email))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Сайт")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.site))])])]),e.full?a("div",{staticClass:"profile__info profile__info-full"},[a("h3",[e._v("Адреса")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Юридический адрес")]),null!==e.currentClient.business_address||""!==e.currentClient.business_address.city?a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.business_address.index)+" "+e._s(e.currentClient.business_address.country)+", г."+e._s(e.currentClient.business_address.city)+", "+e._s(e.currentClient.business_address.street)+", д."+e._s(e.currentClient.business_address.house)+", "+e._s(e.currentClient.business_address.entrance)+", кв."+e._s(e.currentClient.business_address.flat))]):e._e()]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Адрес доставки")]),""!==e.currentClient.warehouse_address.city?a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.warehouse_address.index)+" "+e._s(e.currentClient.warehouse_address.country)+", г."+e._s(e.currentClient.warehouse_address.city)+", "+e._s(e.currentClient.warehouse_address.street)+", д."+e._s(e.currentClient.warehouse_address.house)+", "+e._s(e.currentClient.warehouse_address.entrance)+", кв."+e._s(e.currentClient.warehouse_address.flat))]):e._e()])]),a("h3",[e._v("Банковская информация")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Банковский счет")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.bank_account))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Банк")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.bank))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("BIC/SWIFT")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.bic))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("НДС")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.vat)+"%")])])]),a("h3",[e._v("Электронные счета")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Оператор электронных счетов")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.account_operator))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Индекс посредника")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.index_operator))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Номер электронных счетов")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.electronic_number))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Email для счетов")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentClient.account_email))])])])]):e._e(),a("div",{staticClass:"open__actions"},[a("div",{staticClass:"addition-btn",on:{click:function(t){e.full=!e.full}}},[e.full?a("span",[e._v("Скрыть полную информацию")]):e._e(),e.full?e._e():a("span",[e._v("Показать полную информацию")])]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.push({name:"ClientsEmployees",params:{idClient:e.id}})}}},[e._v(" Контакты ")])]),-1!==e.$parent.$parent.edit.indexOf("Клиенты")?a("div",{staticClass:"news-open__actions open__actions"},[a("div",{staticClass:"addition-btn",on:{click:e.openEditForm}},[a("edit-icon"),e._v(" Редактировать клиента ")],1),e.currentClient.active?a("div",{staticClass:"addition-btn",on:{click:e.archiveClientOpen}},[a("archive-icon"),e._v(" Архивировать клиента ")],1):e._e(),e.currentClient.active?e._e():a("div",{staticClass:"addition-btn",on:{click:e.archiveClientOpen}},[a("archive-icon"),e._v(" Удалить из архива клиента ")],1),e.currentClient.active?e._e():a("div",{staticClass:"addition-btn",on:{click:function(t){e.confirmDeleteDialog=!0}}},[a("waste-icon"),e._v(" Удалить клиента ")],1)]):e._e()])])]),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"addForm",attrs:{model:e.currentClient}},[a("v-row",[a("v-text-field",{attrs:{placeholder:"Название юрлица*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentClient.name,callback:function(t){e.$set(e.currentClient,"name",t)},expression:"currentClient.name"}}),a("v-text-field",{attrs:{placeholder:"Краткое название*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentClient.short_name,callback:function(t){e.$set(e.currentClient,"short_name",t)},expression:"currentClient.short_name"}})],1),a("v-row",[a("v-combobox",{attrs:{placeholder:"Отрасль*",items:e.selectsBranch,rules:e.reqRules,required:"",outlined:""},model:{value:e.currentClient.branch,callback:function(t){e.$set(e.currentClient,"branch",t)},expression:"currentClient.branch"}}),a("v-text-field",{attrs:{placeholder:"ОГРН*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentClient.ogrn,callback:function(t){e.$set(e.currentClient,"ogrn",t)},expression:"currentClient.ogrn"}})],1),a("h4",[e._v("Юридический адрес")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Страна*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentClient.business_address.country,callback:function(t){e.$set(e.currentClient.business_address,"country",t)},expression:"currentClient.business_address.country"}}),a("v-text-field",{attrs:{placeholder:"Город*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentClient.business_address.city,callback:function(t){e.$set(e.currentClient.business_address,"city",t)},expression:"currentClient.business_address.city"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Улица*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentClient.business_address.street,callback:function(t){e.$set(e.currentClient.business_address,"street",t)},expression:"currentClient.business_address.street"}}),a("v-text-field",{attrs:{placeholder:"Индекс*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentClient.business_address.index,callback:function(t){e.$set(e.currentClient.business_address,"index",t)},expression:"currentClient.business_address.index"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Дом*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentClient.business_address.house,callback:function(t){e.$set(e.currentClient.business_address,"house",t)},expression:"currentClient.business_address.house"}}),a("v-text-field",{attrs:{placeholder:"Подъезд",outlined:""},model:{value:e.currentClient.business_address.entrance,callback:function(t){e.$set(e.currentClient.business_address,"entrance",t)},expression:"currentClient.business_address.entrance"}}),a("v-text-field",{attrs:{placeholder:"Квартира",outlined:""},model:{value:e.currentClient.business_address.flat,callback:function(t){e.$set(e.currentClient.business_address,"flat",t)},expression:"currentClient.business_address.flat"}})],1),a("h4",[e._v("Адрес доставки")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Страна",outlined:""},model:{value:e.currentClient.warehouse_address.country,callback:function(t){e.$set(e.currentClient.warehouse_address,"country",t)},expression:"currentClient.warehouse_address.country"}}),a("v-text-field",{attrs:{placeholder:"Город",outlined:""},model:{value:e.currentClient.warehouse_address.city,callback:function(t){e.$set(e.currentClient.warehouse_address,"city",t)},expression:"currentClient.warehouse_address.city"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Улица",outlined:""},model:{value:e.currentClient.warehouse_address.street,callback:function(t){e.$set(e.currentClient.warehouse_address,"street",t)},expression:"currentClient.warehouse_address.street"}}),a("v-text-field",{attrs:{placeholder:"Индекс",outlined:""},model:{value:e.currentClient.warehouse_address.index,callback:function(t){e.$set(e.currentClient.warehouse_address,"index",t)},expression:"currentClient.warehouse_address.index"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Дом",outlined:""},model:{value:e.currentClient.warehouse_address.house,callback:function(t){e.$set(e.currentClient.warehouse_address,"house",t)},expression:"currentClient.warehouse_address.house"}}),a("v-text-field",{attrs:{placeholder:"Подъезд",outlined:""},model:{value:e.currentClient.warehouse_address.entrance,callback:function(t){e.$set(e.currentClient.warehouse_address,"entrance",t)},expression:"currentClient.warehouse_address.entrance"}}),a("v-text-field",{attrs:{placeholder:"Квартира",outlined:""},model:{value:e.currentClient.warehouse_address.flat,callback:function(t){e.$set(e.currentClient.warehouse_address,"flat",t)},expression:"currentClient.warehouse_address.flat"}})],1),a("h4",[e._v("Контакты")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Телефон*",rules:e.phoneRules,required:"",outlined:""},model:{value:e.currentClient.phone,callback:function(t){e.$set(e.currentClient,"phone",t)},expression:"currentClient.phone"}}),a("v-text-field",{attrs:{placeholder:"Почта*",rules:e.emailRules,required:"",outlined:""},model:{value:e.currentClient.email,callback:function(t){e.$set(e.currentClient,"email",t)},expression:"currentClient.email"}})],1),a("v-text-field",{attrs:{placeholder:"Сайт",outlined:""},model:{value:e.currentClient.site,callback:function(t){e.$set(e.currentClient,"site",t)},expression:"currentClient.site"}}),a("h4",[e._v("Банковская информация")]),a("v-text-field",{attrs:{placeholder:"Номер счета в банке*",outlined:""},model:{value:e.currentClient.bank_account,callback:function(t){e.$set(e.currentClient,"bank_account",t)},expression:"currentClient.bank_account"}}),a("v-row",[a("v-text-field",{attrs:{placeholder:"Банк",outlined:""},model:{value:e.currentClient.bank,callback:function(t){e.$set(e.currentClient,"bank",t)},expression:"currentClient.bank"}}),a("v-text-field",{attrs:{placeholder:"BIC/SWIFT",outlined:""},model:{value:e.currentClient.bic,callback:function(t){e.$set(e.currentClient,"bic",t)},expression:"currentClient.bic"}})],1),a("v-select",{attrs:{items:e.selectsVat,placeholder:"НДС","item-text":"text","item-value":"value",outlined:""},model:{value:e.currentClient.vat,callback:function(t){e.$set(e.currentClient,"vat",t)},expression:"currentClient.vat"}}),a("v-row",[a("v-text-field",{attrs:{placeholder:"Оператор эл. счетов",outlined:""},model:{value:e.currentClient.account_operator,callback:function(t){e.$set(e.currentClient,"account_operator",t)},expression:"currentClient.account_operator"}}),a("v-text-field",{attrs:{placeholder:"Индекс посредника",outlined:""},model:{value:e.currentClient.index_operator,callback:function(t){e.$set(e.currentClient,"index_operator",t)},expression:"currentClient.index_operator"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Номер эл. счетов",outlined:""},model:{value:e.currentClient.electronic_number,callback:function(t){e.$set(e.currentClient,"electronic_number",t)},expression:"currentClient.electronic_number"}}),a("v-text-field",{attrs:{placeholder:"Email для счетов",outlined:""},model:{value:e.currentClient.account_email,callback:function(t){e.$set(e.currentClient,"account_email",t)},expression:"currentClient.account_email"}})],1)],1),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.editClient}},[e._v(e._s(e.formBtnText))])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление клиента ")]),a("v-card-text",[e._v("Вы действительно хотите удалить клиента? Отменить это действие будет невозможно")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteClient}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.photoDialog,callback:function(t){e.photoDialog=t},expression:"photoDialog"}},[a("v-card",[a("v-card-title",[e._v(" Сменить фото ")]),a("v-card-text",[a("v-file-input",{attrs:{placeholder:"Логотип организации",accept:"image","prepend-icon":"",outlined:""},model:{value:e.photoField,callback:function(t){e.photoField=t},expression:"photoField"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.savePhoto}},[e._v("Сохранить")])],1)],1)],1)],1)},qt=[],Lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M27.1325 6.61375L23.3838 2.86625C23.2679 2.74995 23.1301 2.65771 22.9785 2.59486C22.8268 2.532 22.6642 2.49976 22.5 2.5H7.5C7.33582 2.49976 7.17322 2.532 7.02155 2.59486C6.86988 2.65771 6.73214 2.74995 6.61625 2.86625L2.8675 6.61375C2.75071 6.72959 2.65809 6.86748 2.595 7.0194C2.53192 7.17132 2.49963 7.33425 2.5 7.49875V23.75C2.5 25.1287 3.62125 26.25 5 26.25H25C26.3788 26.25 27.5 25.1287 27.5 23.75V7.49875C27.5004 7.33425 27.4681 7.17132 27.405 7.0194C27.3419 6.86748 27.2493 6.72959 27.1325 6.61375ZM8.0175 5H21.9825L23.2313 6.24875H6.76875L8.0175 5ZM5 23.75V8.74875H25L25.0025 23.75H5Z",fill:"#616161"}}),a("path",{attrs:{d:"M18.75 15H11.25V12.5H8.75V17.5H21.25V12.5H18.75V15Z",fill:"#616161"}})])},Rt=[],Wt={name:"archiveIcon"},Nt=Wt,Gt=Object(m["a"])(Nt,Lt,Rt,!1,null,"1fd8871a",null),Bt=Gt.exports,zt={name:"ClientOpen",components:{ArchiveIcon:Bt,EditIcon:Te,WasteIcon:De,BackIcon:qe},props:{id:[String,Number]},data:function(){return{page:"clients",employees:[],currentClient:{id:0,name:"",short_name:"",ogrn:"",business_address:{index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""},warehouse_address:{index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""},phone:"",email:"",site:"",vat:0,branch:"",bank_account:"",bank:"",bic:"",account_operator:"",index_operator:"",electronic_number:"",account_email:"",logo_path:"",active:!0},selectsVat:[{text:"0%",value:0},{text:"10%",value:10},{text:"20%",value:20}],selectsBranch:[],photoField:null,full:!1,formTitle:"Редактирование клиента",formBtnText:"Сохранить",addForm:!1,confirmDeleteDialog:!1,photoDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}],emailRules:[function(e){return!!e||"Необходимо заполнить поле"},function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||"Некорректный E-mail"}],phoneRules:[function(e){return!!e||"Необходимо заполнить поле"},function(e){return/^(\+)?((\d{2,3}) ?\d|\d)(([ -]?\d)|( ?(\d{2,3}) ?)){5,12}\d$/.test(e)||"Некорректный номер телефона"}]}},created:function(){localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(-1===this.$parent.$parent.read.indexOf("Клиенты")&&this.$router.push({name:"Index"}),this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients/"+this.id,type:"GET",success:function(t){e.currentClient=t.data.data[0],null==e.currentClient.warehouse_address&&(e.currentClient.warehouse_address={index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""})},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadEmployees:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients/employees/"+this.id,type:"GET",success:function(t){e.employees=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadBranches:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients/branches",type:"GET",success:function(t){e.selectsBranch=t.data.branches},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},archiveClientOpen:function(){var e=this;this.currentClient.active=!this.currentClient.active,o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"PUT",data:this.currentClient,error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},editClient:function(){var e=this;console.log("edit"),this.$refs.addForm.validate()?(this.currentClient.business_address=JSON.stringify(this.currentClient.business_address),this.currentClient.warehouse_address=JSON.stringify(this.currentClient.warehouse_address),o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"PUT",data:this.currentClient,success:function(){e.addForm=!1,e.loadData()},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})):(console.log("Заполните обязательные поля"),this.alertMsg="Заполните обязательные поля",this.alertError=!0)},deleteClient:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"DELETE",data:{id:this.currentClient.id},success:function(){e.confirmDeleteDialog=!1,e.$router.push({name:"Clients"})},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},savePhoto:function(){var e=this,t=a("bc3a"),n=new FormData,s=this.photoField;null!==s&&void 0!==s?(n.append("image",s),n.append("id",this.currentClient.id),t({method:"put",url:this.$hostname+"time-tracking/clients",headers:{Authorization:"Token "+(sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token"))},data:n}).then((function(t){console.log(t.data.data),e.photoDialog=!1,e.photoField=null,e.loadData()}))):console.log("ERROR")},openEditForm:function(){this.formTitle="Редактирование клиента",this.formBtnText="Сохранить",this.addForm=!0,this.loadBranches()}}},Ut=zt,Ht=Object(m["a"])(Ut,At,qt,!1,null,"509b7432",null),Qt=Ht.exports;v()(Ht,{VAlert:te["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCombobox:vt["a"],VDialog:H["a"],VFileInput:He["a"],VForm:ce["a"],VIcon:h["a"],VImg:p["a"],VRow:rt["a"],VSelect:ot["a"],VSpacer:Qe["a"],VTextField:ue["a"],VToolbar:Ze["a"]});var Zt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contacts flex-content"},[a("div",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h3",[e._v("Контакты")]),a("div",{staticClass:" addition-btn content-list__filters-mobile",on:{click:e.openFilters}},[e._v(" Фильтры ")])]),a("div",{staticClass:"contacts-all all"},[a("div",{staticClass:"content-list__filters"},[a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:e.closeFilters}},[e._v(" $deleteIcon ")]),a("v-text-field",{attrs:{placeholder:"ФИО",outlined:""},model:{value:e.filter.name,callback:function(t){e.$set(e.filter,"name",t)},expression:"filter.name"}}),a("v-select",{attrs:{items:["Все"].concat(e.selectsClient),"item-text":"name",placeholder:"Клиент",outlined:""},model:{value:e.filter.client,callback:function(t){e.$set(e.filter,"client",t)},expression:"filter.client"}}),a("v-select",{attrs:{items:[{id:0,name:"Все"}].concat(e.selectsPosition),"item-text":"name","item-value":"name",placeholder:"Должность",outlined:""},model:{value:e.filter.position,callback:function(t){e.$set(e.filter,"position",t)},expression:"filter.position"}})],1),a("v-list",{staticClass:"clients__list content-list",attrs:{"three-line":""}},[e._l(e.contacts,(function(t){return[t.active!==!e.archive||!(t.lastname+" "+t.name).includes(e.filter.name)||t.client.name!==e.filter.client&&"Все"!==e.filter.client||t.position.name!==e.filter.position&&"Все"!==e.filter.position?e._e():a("v-list-item",{key:t.id},[a("v-list-item-avatar",{staticClass:"content-list__image"},[t.photo_path?a("v-img",{attrs:{src:e.$hostname+"media"+t.photo_path}}):e._e()],1),a("v-list-item-content",{on:{click:function(a){return e.$router.push({name:"ContactOpen",params:{id:t.id}})}}},[a("v-list-item-title",[e._v(e._s(t.lastname)+" "+e._s(t.name))]),a("v-list-item-subtitle",[a("span",[e._v(e._s(t.client.name)+", "),null!==t.position.name?a("span",[e._v(e._s(t.position.name))]):e._e()]),a("br"),a("span",[e._v(e._s(t.work_email)+" "+e._s(t.work_phone))])])],1),-1!==e.$parent.$parent.edit.indexOf("Контакты")?a("v-list-item-action",[a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:function(a){return e.openConfirmDeleteDialog(t)}}},[e._v(" $deleteIcon ")])],1):e._e()],1)]}))],2),a("v-list",{staticClass:"content-list__btns"},[e.archive||-1===e.$parent.$parent.edit.indexOf("Контакты")?e._e():a("v-list-item",{staticClass:"content-list__btns-add",on:{click:e.openAddForm}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Добавить контакт")])],1)],1),e.archive?a("v-list-item",{staticClass:"content-list__btns-add",on:{click:function(t){e.archive=!e.archive}}},[a("v-list-item-icon",[a("v-icon",[e._v("$archive")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Выйти из архива")])],1)],1):a("v-list-item",{staticClass:"content-list__btns-add",on:{click:function(t){e.archive=!e.archive}}},[a("v-list-item-icon",[a("v-icon",[e._v("$archive")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Архив")])],1)],1)],1)],1)]),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:e.closeForm}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"addForm",attrs:{model:e.newContact}},[a("v-row",[a("v-text-field",{attrs:{placeholder:"Фамилия*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newContact.lastname,callback:function(t){e.$set(e.newContact,"lastname",t)},expression:"newContact.lastname"}}),a("v-text-field",{attrs:{placeholder:"Имя*",rules:e.reqRules,required:"",outlined:""},model:{value:e.newContact.name,callback:function(t){e.$set(e.newContact,"name",t)},expression:"newContact.name"}})],1),a("v-row",[a("v-combobox",{attrs:{placeholder:"Фирма*",items:e.selectsClient,"item-text":"name","item-value":"id",rules:e.reqRules,required:"",outlined:""},model:{value:e.newContact.client,callback:function(t){e.$set(e.newContact,"client",t)},expression:"newContact.client"}}),a("v-combobox",{attrs:{placeholder:"Должность*",items:e.selectsPosition,"item-value":"id","item-text":"name",rules:e.reqRules,required:"",outlined:""},model:{value:e.newContact.position,callback:function(t){e.$set(e.newContact,"position",t)},expression:"newContact.position"}})],1),a("h4",[e._v("Контакты")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Телефон",rules:e.phoneRules,required:"",outlined:""},model:{value:e.newContact.phone,callback:function(t){e.$set(e.newContact,"phone",t)},expression:"newContact.phone"}}),a("v-text-field",{attrs:{placeholder:"Рабочий телефон*",rules:e.phoneRules,required:"",outlined:""},model:{value:e.newContact.work_phone,callback:function(t){e.$set(e.newContact,"work_phone",t)},expression:"newContact.work_phone"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Почта",rules:e.emailRules,required:"",outlined:""},model:{value:e.newContact.email,callback:function(t){e.$set(e.newContact,"email",t)},expression:"newContact.email"}}),a("v-text-field",{attrs:{placeholder:"Рабочая почта*",rules:e.emailRules,required:"",outlined:""},model:{value:e.newContact.work_email,callback:function(t){e.$set(e.newContact,"work_email",t)},expression:"newContact.work_email"}})],1)],1),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.addContact}},[e._v(e._s(e.formBtnText))])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление контакта ")]),a("v-card-text",[e._v("Вы действительно хотите удалить контакт и все зависящие от него объекты? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteContact}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmArchiveDialog,callback:function(t){e.confirmArchiveDialog=t},expression:"confirmArchiveDialog"}},[a("v-card",[a("v-card-title",[e._v(" Архивирование контакта ")]),a("v-card-text",[e._v(" Вы действительно хотите архивировать контакт? После подтверждения контакт будет перемещен в архив ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmArchiveDialog=!1}}},[e._v(" Отменить ")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.archiveContact}},[e._v("Подтвердить")])],1)],1)],1)],1)},Yt=[],Kt={name:"Contacts",props:{idClient:[String,Number,null]},data:function(){return{page:"contacts",archive:!1,contacts:[],newContact:{name:"",lastname:"",position:"",phone:"",work_phone:"",email:"",work_email:"",client:"",photo_path:""},currentContact:{id:0,active:!0},filter:{name:"",client:"Все",position:"Все"},selectsClient:[],selectsPosition:[],formTitle:"Добавление клиента",formBtnText:"Добавить клиента",addForm:!1,confirmDeleteDialog:!1,confirmArchiveDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}],emailRules:[function(e){return!!e||"Необходимо заполнить поле"},function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||"Некорректный E-mail"}],phoneRules:[function(e){return!!e||"Необходимо заполнить поле"},function(e){return/^(\+)?((\d{2,3}) ?\d|\d)(([ -]?\d)|( ?(\d{2,3}) ?)){5,12}\d$/.test(e)||"Некорректный номер телефона"}]}},created:function(){console.log("init Contacts"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(-1===this.$parent.$parent.read.indexOf("Контакты")&&this.$router.push({name:"Index"}),this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadPositions(),this.loadClients()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this,t="";t=null!==this.idClient&&void 0!==this.idClient?"time-tracking/clients/employees/"+this.idClient:"time-tracking/clients-employees",o.a.ajax({url:this.$hostname+t,type:"GET",success:function(t){e.contacts=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadPositions:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients-employees/positions",type:"GET",success:function(t){e.selectsPosition=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadClients:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"GET",success:function(t){e.selectsClient=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},addContact:function(){var e=this;this.$refs.addForm.validate()?(this.newContact.client=this.newContact.client.id,this.newContact.position=this.newContact.position.id,o.a.ajax({url:this.$hostname+"time-tracking/clients-employees",type:"POST",data:this.newContact,success:function(){e.closeForm(),e.loadData(),e.loadPositions()},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})):(this.alertMsg="Заполните все обязательные поля",this.alertError=!0)},archiveContact:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients-employees",type:"PUT",data:{id:this.currentContact.id,active:!this.currentContact.active},success:function(){e.loadData(),e.confirmArchiveDialog=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},deleteContact:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients-employees",type:"DELETE",data:{id:this.currentContact.id},success:function(){e.loadData(),e.confirmDeleteDialog=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},openAddForm:function(){this.formTitle="Добавление контакта",this.formBtnText="Добавить контакт",this.addForm=!0},openEditForm:function(e){this.formTitle="Редактирование контакта",this.formBtnText="Сохранить",this.newContact=e,this.addForm=!0},closeForm:function(){this.addForm=!1,this.alertError=!1,this.newContact={name:"",lastname:"",position:"",phone:"",work_phone:"",email:"",work_email:"",client:"",photo_path:""}},openConfirmDeleteDialog:function(e){this.currentContact.id=e.id,this.currentContact.active=e.active,this.archive?this.confirmDeleteDialog=!0:this.confirmArchiveDialog=!0},openFilters:function(){console.log("open filters"),o()(".content-list__filters").addClass("open"),o()(".content-list__btns").addClass("hidden")},closeFilters:function(){console.log("open filters"),o()(".content-list__filters").removeClass("open"),o()(".content-list__btns").removeClass("hidden")}}},Xt=Kt,Jt=Object(m["a"])(Xt,Zt,Yt,!1,null,"4e69dbe0",null),ea=Jt.exports;v()(Jt,{VAlert:te["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCombobox:vt["a"],VDialog:H["a"],VForm:ce["a"],VIcon:h["a"],VImg:p["a"],VList:_["a"],VListItem:g["a"],VListItemAction:st["a"],VListItemAvatar:ht["a"],VListItemContent:k["a"],VListItemIcon:x["a"],VListItemSubtitle:k["b"],VListItemTitle:k["c"],VRow:rt["a"],VSelect:ot["a"],VSpacer:Qe["a"],VTextField:ue["a"],VToolbar:Ze["a"]});var ta=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contacts flex-content"},[a("div",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h3",[e._v("Контакты")]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.go(-1)}}},[a("span",[e._v("К списку контактов")]),a("back-icon")],1)]),a("div",{staticClass:"clients-open workers-open"},[a("div",{staticClass:"profile__image clients-open__image"},[e.currentContact.photo_path?a("v-img",{attrs:{"lazy-src":e.$hostname+"media"+e.currentContact.photo_path,src:e.$hostname+"media"+e.currentContact.photo_path}}):e._e(),-1!==e.$parent.$parent.edit.indexOf("Контакты")?a("div",{staticClass:"profile__change-photo",on:{click:function(t){e.photoDialog=!0}}},[e._v("Сменить фото ")]):e._e()],1),a("div",{staticClass:"profile__info"},[a("h3",[e._v("Общая информация")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Имя")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentContact.name))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Фамилия")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentContact.lastname))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Должность")]),null!==e.currentContact.position.name?a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentContact.position.name))]):e._e()]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Фирма")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentContact.client.name))])])]),a("h3",[e._v("Контакты")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Телефон")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentContact.phone))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Рабочий телефон")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentContact.work_phone))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("E-mail")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentContact.email))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Рабочий E-mail")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentContact.work_email))])])]),-1!==e.$parent.$parent.edit.indexOf("Контакты")?a("div",{staticClass:"news-open__actions open__actions"},[a("div",{staticClass:"addition-btn",on:{click:e.openEditForm}},[a("edit-icon"),e._v(" Редактировать контакт ")],1),e.currentContact.active?a("div",{staticClass:"addition-btn",on:{click:e.archiveContactOpen}},[a("archive-icon"),e._v(" Архивировать контакт ")],1):e._e(),e.currentContact.active?e._e():a("div",{staticClass:"addition-btn",on:{click:e.archiveContactOpen}},[a("archive-icon"),e._v(" Удалить из архива ")],1),e.currentContact.active?e._e():a("div",{staticClass:"addition-btn",on:{click:function(t){e.confirmDeleteDialog=!0}}},[a("waste-icon"),e._v(" Удалить контакт ")],1)]):e._e()])])]),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"addForm",attrs:{model:e.currentContact}},[a("v-row",[a("v-text-field",{attrs:{placeholder:"Фамилия*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentContact.lastname,callback:function(t){e.$set(e.currentContact,"lastname",t)},expression:"currentContact.lastname"}}),a("v-text-field",{attrs:{placeholder:"Имя*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentContact.name,callback:function(t){e.$set(e.currentContact,"name",t)},expression:"currentContact.name"}})],1),a("v-row",[a("v-combobox",{attrs:{placeholder:"Фирма*",items:e.selectsClient,"item-text":"name",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentContact.client,callback:function(t){e.$set(e.currentContact,"client",t)},expression:"currentContact.client"}}),a("v-combobox",{attrs:{placeholder:"Должность*",items:e.selectsPosition,"item-value":"id","item-text":"name",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentContact.position,callback:function(t){e.$set(e.currentContact,"position",t)},expression:"currentContact.position"}})],1),a("h4",[e._v("Контакты")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Телефон",outlined:""},model:{value:e.currentContact.phone,callback:function(t){e.$set(e.currentContact,"phone",t)},expression:"currentContact.phone"}}),a("v-text-field",{attrs:{placeholder:"Рабочий телефон*",rules:e.phoneRules,required:"",outlined:""},model:{value:e.currentContact.work_phone,callback:function(t){e.$set(e.currentContact,"work_phone",t)},expression:"currentContact.work_phone"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Почта",required:"",outlined:""},model:{value:e.currentContact.email,callback:function(t){e.$set(e.currentContact,"email",t)},expression:"currentContact.email"}}),a("v-text-field",{attrs:{placeholder:"Рабочая почта*",rules:e.emailRules,required:"",outlined:""},model:{value:e.currentContact.work_email,callback:function(t){e.$set(e.currentContact,"work_email",t)},expression:"currentContact.work_email"}})],1)],1),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.editContact}},[e._v(e._s(e.formBtnText))])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление контакта ")]),a("v-card-text",[e._v("Вы действительно хотите удалить контакт и все зависящие от него объекты? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteContact}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.photoDialog,callback:function(t){e.photoDialog=t},expression:"photoDialog"}},[a("v-card",[a("v-card-title",[e._v(" Сменить фото ")]),a("v-card-text",[a("v-file-input",{attrs:{placeholder:"Фото",accept:"image","prepend-icon":"",outlined:""},model:{value:e.photoField,callback:function(t){e.photoField=t},expression:"photoField"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.savePhoto}},[e._v("Сохранить")])],1)],1)],1)],1)},aa=[],na={name:"ContactOpen",components:{ArchiveIcon:Bt,EditIcon:Te,WasteIcon:De,BackIcon:qe},props:{id:[String,Number]},data:function(){return{page:"contacts",currentContact:{id:0,name:"",lastname:"",position:"",phone:"",work_phone:"",email:"",work_email:"",client:{name:""},photo_path:"",active:!0},photoField:null,selectsClient:[],selectsPosition:[],formTitle:"Добавление клиента",formBtnText:"Добавить клиента",addForm:!1,confirmDeleteDialog:!1,photoDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}],emailRules:[function(e){return!!e||"Необходимо заполнить поле"},function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||"Некорректный E-mail"}],phoneRules:[function(e){return!!e||"Необходимо заполнить поле"},function(e){return/^(\+)?((\d{2,3}) ?\d|\d)(([ -]?\d)|( ?(\d{2,3}) ?)){5,12}\d$/.test(e)||"Некорректный номер телефона"}]}},created:function(){localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(-1===this.$parent.$parent.read.indexOf("Контакты")&&this.$router.push({name:"Index"}),this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients-employees/"+this.id,type:"GET",success:function(t){e.currentContact=t.data.data[0]},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadPositions:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients-employees/positions",type:"GET",success:function(t){e.selectsPosition=t.data.positions},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadClients:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"GET",success:function(t){e.selectsClient=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},archiveContactOpen:function(){var e=this;this.currentContact.active=!this.currentContact.active,o.a.ajax({url:this.$hostname+"time-tracking/clients-employees",type:"PUT",data:this.currentContact,error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},editContact:function(){var e=this;this.$refs.addForm.validate()?(this.currentContact.client=this.currentContact.client.id,this.currentContact.position=this.currentContact.position.id,o.a.ajax({url:this.$hostname+"time-tracking/clients-employees",type:"PUT",data:this.currentContact,success:function(){e.addForm=!1,e.loadData()},error:function(t){switch(console.log(t),t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})):(this.alertMsg="Заполните все обязательные поля",this.alertError=!0)},deleteContact:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients-employees",type:"DELETE",data:{id:this.currentContact.id},success:function(){e.confirmDeleteDialog=!1,e.$router.push({name:"Contacts"})},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},savePhoto:function(){var e=this,t=a("bc3a"),n=new FormData,s=this.photoField;null!==s&&void 0!==s?(n.append("image",s),n.append("id",this.currentContact.id),t({method:"put",url:this.$hostname+"time-tracking/clients-employees",headers:{Authorization:"Token "+(sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token"))},data:n}).then((function(t){console.log(t.data.data),e.photoDialog=!1,e.photoField=null,e.loadData()}))):console.log("ERROR")},openAddForm:function(){this.formTitle="Добавление контакта",this.formBtnText="Добавить контакт",this.addForm=!0},openEditForm:function(){this.loadClients(),this.loadPositions(),this.formTitle="Редактирование контакта",this.formBtnText="Сохранить",this.addForm=!0},openConfirmDeleteDialog:function(){this.confirmDeleteDialog=!0}}},sa=na,ia=Object(m["a"])(sa,ta,aa,!1,null,"66621312",null),ra=ia.exports;v()(ia,{VAlert:te["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCombobox:vt["a"],VDialog:H["a"],VFileInput:He["a"],VForm:ce["a"],VIcon:h["a"],VImg:p["a"],VRow:rt["a"],VSpacer:Qe["a"],VTextField:ue["a"],VToolbar:Ze["a"]});var oa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"groups flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("h1",[e._v("Управление группами пользователей")]),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(t){e.addGroupForm=!0}}},[e._v("Добавить группу")]),a("v-list",{staticClass:"groups__list"},e._l(e.groups,(function(t){return a("v-list-group",{key:t.id,attrs:{"no-action":""},scopedSlots:e._u([{key:"activator",fn:function(){return[a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:e._s(t.name)}})],1)]},proxy:!0}],null,!0),model:{value:t.active,callback:function(a){e.$set(t,"active",a)},expression:"group.active"}},[e._l(e.functions[t.name],(function(t){return[a("div",{key:t.text,staticClass:"groups-single__functions"},[a("span",{staticClass:"bold-text"},[e._v(e._s(t.name))]),a("v-checkbox",{attrs:{label:"Чтение"},on:{change:function(a){return e.putFunction(t.data)}},model:{value:t.data.read,callback:function(a){e.$set(t.data,"read",a)},expression:"func.data.read"}}),a("v-checkbox",{attrs:{label:"Редактирование"},on:{change:function(a){return e.putFunction(t.data)}},model:{value:t.data.edit,callback:function(a){e.$set(t.data,"edit",a)},expression:"func.data.edit"}})],1)]})),a("div",{staticClass:"groups-single__action"},[a("v-btn",{staticClass:"action-btn",attrs:{color:"error"},on:{click:function(a){e.currentGroup=t.id,e.confirmDeleteGroup=!0}}},[e._v(" Удалить группу ")]),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(a){e.addGroupForm=!0,e.newGroup=t}}},[e._v(" Переименовать группу ")])],1)],2)})),1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.addGroupForm,callback:function(t){e.addGroupForm=t},expression:"addGroupForm"}},[a("v-card",[a("v-card-title",[e._v(" Введите название новой группы ")]),a("v-card-text",[a("v-form",{ref:"addForm"},[a("v-text-field",{attrs:{placeholder:"Название*",outlined:"",rules:e.reqRules},model:{value:e.newGroup.name,callback:function(t){e.$set(e.newGroup,"name",t)},expression:"newGroup.name"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.addGroupForm=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.addGroup}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteGroup,callback:function(t){e.confirmDeleteGroup=t},expression:"confirmDeleteGroup"}},[a("v-card",[a("v-card-title",[e._v(" Удаление группы пользователей ")]),a("v-card-text",[e._v("Вы действительно хотите удалить выбранную группу пользователей? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteGroup=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteGroup}},[e._v("Подтвердить")])],1)],1)],1)],1)},la=[],ca={name:"Groups",components:{Header:R},created:function(){console.log("init Groups"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},data:function(){return{groups:[],functions:[],newGroup:{id:0,name:""},currentGroup:0,addGroupForm:!1,confirmDeleteGroup:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}]}},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/groups",type:"GET",success:function(t){e.groups=t.data.groups,e.functions=t.data.functions},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},putFunction:function(e){var t=this;o.a.ajax({url:this.$hostname+"time-tracking/groups-functions",type:"PUT",data:e,success:function(a){console.log("Данные обновлены"),e.id=a.data.id,t.$emit("load-functions")},error:function(e){switch(e.status){case 500:t.alertMsg="Ошибка соединения с сервером";break;case 400:t.alertMsg="Ошибка в данных";break;case 401:t.$refresh();break;case 403:t.alertMsg="Нет доступа";break;default:t.alertMsg="Непредвиденная ошибка"}t.alertError=!0}})},addGroup:function(){var e=this;this.$refs.addForm.validate()?0!==this.newGroup.id?this.putGroup():o.a.ajax({url:this.$hostname+"time-tracking/group",type:"POST",data:this.newGroup,success:function(){console.log("Даннные добавлены"),e.loadData(),e.addGroupForm=!1,e.newGroup={id:0,name:""}},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}}):(console.log("Заполните обязательные поля"),this.alertMsg="Заполните обязательные поля",this.alertError=!0)},putGroup:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/group",type:"PUT",data:this.newGroup,success:function(){e.loadData(),e.addGroupForm=!1,e.newGroup={id:0,name:""}},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},deleteGroup:function(){var e=this;console.log("Удаляется группа "+this.currentGroup),o.a.ajax({url:this.$hostname+"time-tracking/group",type:"DELETE",data:{id:this.currentGroup},success:function(){console.log("Даннные удалены"),e.confirmDeleteGroup=!1,e.loadData()},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})}}},ua=ca,da=Object(m["a"])(ua,oa,la,!1,null,"63f403c1",null),ma=da.exports;v()(da,{VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCheckbox:ae["a"],VDialog:H["a"],VForm:ce["a"],VList:_["a"],VListGroup:b["a"],VListItemContent:k["a"],VListItemTitle:k["c"],VSpacer:Qe["a"],VTextField:ue["a"]});var fa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"settings flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("h1",[e._v(e._s(e.$vuetify.lang.t("$vuetify.settings.h1Label")))]),a("v-row",[a("v-select",{attrs:{label:e.$vuetify.lang.t("$vuetify.settings.selectThemeLabel"),items:e.items,"item-text":"name","item-value":"theme"},on:{change:e.putSettings},model:{value:e.settings.theme,callback:function(t){e.$set(e.settings,"theme",t)},expression:"settings.theme"}}),a("v-select",{attrs:{label:e.$vuetify.lang.t("$vuetify.settings.selectLangLabel"),items:e.languages},on:{change:e.putSettings},model:{value:e.settings.language,callback:function(t){e.$set(e.settings,"language",t)},expression:"settings.language"}})],1),a("v-list",[e.$parent.$parent.admin?a("v-list-item",{on:{click:function(t){return e.$router.push({name:"Groups"})}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Управление группами")])],1)],1):e._e(),e.$parent.$parent.admin?a("v-list-item",{on:{click:function(t){return e.$router.push({name:"Positions",params:{table:"profile"}})}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Специальности пользователей")])],1)],1):e._e(),e.$parent.$parent.admin?a("v-list-item",{on:{click:function(t){return e.$router.push({name:"Positions",params:{table:"client"}})}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Должности контактов")])],1)],1):e._e(),e.$parent.$parent.admin?a("v-list-item",{on:{click:function(t){return e.$router.push({name:"Categories",params:{table:"cheque"}})}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Категории чеков")])],1)],1):e._e(),e.$parent.$parent.admin?a("v-list-item",{on:{click:function(t){return e.$router.push({name:"Goals",params:{table:"waybill"}})}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Цели поездок")])],1)],1):e._e(),e.$parent.$parent.admin?a("v-list-item",{on:{click:function(t){return e.$router.push({name:"IntegerField",params:{table:"term"}})}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Сроки")])],1)],1):e._e(),e.$parent.$parent.admin?a("v-list-item",{on:{click:function(t){return e.$router.push({name:"IntegerField",params:{table:"tax"}})}}},[a("v-list-item-icon",[a("v-icon",[e._v("mdi-plus")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v("Налог")])],1)],1):e._e()],1)],1)],1)},va=[],ha={name:"Settings",components:{Header:R},data:function(){return{settings:{theme:"light",language:"ru"},items:[{theme:"light",name:"Светлая"},{theme:"dark",name:"Темная"},{theme:"#EA80FC",name:"Фиолетовый"},{theme:"#8BC34A",name:"Зеленый"}],languages:["ru","en"]}},created:function(){console.log("init Settings"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadSettings()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadSettings:function(){var e=this;console.log("loadSettings"),o.a.ajax({url:this.$hostname+"time-tracking/user-settings",type:"GET",success:function(t){e.settings=t.data.data,e.$toggleTheme(t.data.data.theme,t.data.data.language)},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},putSettings:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/user-settings",type:"PUT",data:this.settings,success:function(){e.$toggleTheme(e.settings.theme,e.settings.language)},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},toggleLanguage:function(){console.log(this.selectedLanguage)}}},pa=ha,_a=Object(m["a"])(pa,fa,va,!1,null,"167a5dec",null),ba=_a.exports;v()(_a,{VIcon:h["a"],VList:_["a"],VListItem:g["a"],VListItemContent:k["a"],VListItemIcon:x["a"],VListItemTitle:k["c"],VRow:rt["a"],VSelect:ot["a"]});var ga=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"clients flex-content"},[a("div",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h3",[e._v("Работники")]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.push({name:"Workers"})}}},[a("span",[e._v("К списку работников")]),a("back-icon")],1)]),a("div",{staticClass:"workers-open"},[a("div",{staticClass:"profile__image"},[e.currentProfile.photo_path?a("v-img",{attrs:{"lazy-src":e.$hostname+"media"+e.currentProfile.photo_path,src:e.$hostname+"media"+e.currentProfile.photo_path}}):e._e(),-1!==e.$parent.$parent.edit.indexOf("Работники")?a("div",{staticClass:"profile__change-photo",on:{click:function(t){e.photoDialog=!0}}},[e._v(" Сменить фото ")]):e._e(),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(t){return e.$router.push({name:"ProfileTiming",params:{id:e.currentProfile.id}})}}},[e._v("Часовая отчетность ")]),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.printProfile}},[e._v("Скачать анкету")])],1),a("div",{staticClass:"profile__info"},[a("h3",[e._v("Личная информация")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Имя")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.name))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Фамилия")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.lastname))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Дата рождения")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.birthdate))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Гражданство")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.citizenship))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Должность")]),null!==e.currentProfile.position.name?a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.position.name))]):e._e()]),a("li",{on:{click:function(t){e.changeGroupForm=!0}}},[a("span",{staticClass:"profile__info-title"},[e._v("Роль")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentGroup.name))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Номер соц. страхования")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.social_code_own))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Финский номер соц. страхования")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.social_code_fin))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Работает")]),a("v-checkbox",{attrs:{disabled:-1===e.$parent.$parent.edit.indexOf("Работники")},on:{change:e.openConfirmArchiveDialog},model:{value:e.currentProfile.active,callback:function(t){e.$set(e.currentProfile,"active",t)},expression:"currentProfile.active"}})],1)]),a("h3",[e._v("Контакты")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Телефон")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.phone))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Телефон в Финляндии")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.phone_fin))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("E-mail")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.auth_user_id.email))])])]),a("h3",[e._v("Банковская информация")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Налоговый номер")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.tax_number))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Счет в банке")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.bank_account))])])]),e.full?a("div",{staticClass:"profile__info profile__info-full"},[a("h3",[e._v("Адреса")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Адрес в своей стране")]),null!==e.currentProfile.address_own&&""!==e.currentProfile.address_own.city?a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.address_own.index)+" "+e._s(e.currentProfile.address_own.country)+", г."+e._s(e.currentProfile.address_own.city)+", "+e._s(e.currentProfile.address_own.street)+", д."+e._s(e.currentProfile.address_own.house)+", "+e._s(e.currentProfile.address_own.entrance)+", кв."+e._s(e.currentProfile.address_own.flat))]):e._e()]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Адрес в Финляндии")]),null!==e.currentProfile.address_fin&&""!==e.currentProfile.address_fin.city?a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.address_fin.index)+" "+e._s(e.currentProfile.address_fin.country)+", г."+e._s(e.currentProfile.address_fin.city)+", "+e._s(e.currentProfile.address_fin.street)+", д."+e._s(e.currentProfile.address_fin.house)+", "+e._s(e.currentProfile.address_fin.entrance)+", кв."+e._s(e.currentProfile.address_fin.flat))]):e._e()])]),a("h3",[e._v("Одежда (размеры)")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Ботинки")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.boots))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Куртка")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.jacket))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Штаны")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.pants))])]),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Футболка")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.shirt))])])]),a("h3",[e._v("Языки")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Русский")]),a("v-checkbox",{staticClass:"profile__info-content",attrs:{disabled:""},model:{value:e.currentProfile.russian,callback:function(t){e.$set(e.currentProfile,"russian",t)},expression:"currentProfile.russian"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Английский")]),a("v-checkbox",{staticClass:"profile__info-content",attrs:{disabled:""},model:{value:e.currentProfile.english,callback:function(t){e.$set(e.currentProfile,"english",t)},expression:"currentProfile.english"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Эстонский")]),a("v-checkbox",{staticClass:"profile__info-content",attrs:{disabled:""},model:{value:e.currentProfile.estonian,callback:function(t){e.$set(e.currentProfile,"estonian",t)},expression:"currentProfile.estonian"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Финский")]),a("v-checkbox",{staticClass:"profile__info-content",attrs:{disabled:""},model:{value:e.currentProfile.finnish,callback:function(t){e.$set(e.currentProfile,"finnish",t)},expression:"currentProfile.finnish"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Другие")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.other_language))])])]),a("h3",[e._v("Другое")]),a("ul",[a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Свой автомобиль")]),a("v-checkbox",{staticClass:"profile__info-content",attrs:{disabled:""},model:{value:e.currentProfile.auto,callback:function(t){e.$set(e.currentProfile,"auto",t)},expression:"currentProfile.auto"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Свой инструмент")]),a("v-checkbox",{staticClass:"profile__info-content",attrs:{disabled:""},model:{value:e.currentProfile.tool,callback:function(t){e.$set(e.currentProfile,"tool",t)},expression:"currentProfile.tool"}})],1),a("li",[a("span",{staticClass:"profile__info-title"},[e._v("Навыки")]),a("span",{staticClass:"profile__info-content"},[e._v(e._s(e.currentProfile.skills))])])])]):e._e(),a("div",{staticClass:"open__actions"},[a("div",{staticClass:"addition-btn",on:{click:function(t){e.full=!e.full}}},[e.full?a("span",[e._v("Скрыть полную информацию")]):e._e(),e.full?e._e():a("span",[e._v("Показать полную информацию")])]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.push({name:"Documents",params:{type:"worker",id:e.currentProfile.id}})}}},[e._v(" Документы ")])]),-1!==e.$parent.$parent.edit.indexOf("Работники")?a("div",{staticClass:"news-open__actions open__actions"},[a("div",{staticClass:"addition-btn",on:{click:function(t){return e.openEditForm()}}},[a("edit-icon"),e._v(" Редактировать работника ")],1),a("div",{staticClass:"addition-btn",on:{click:function(t){e.confirmDeleteDialog=!0}}},[a("waste-icon"),e._v(" Удалить работника ")],1)]):e._e()])])]),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"addForm",attrs:{model:e.currentProfile}},[a("v-row",[a("v-text-field",{attrs:{placeholder:"Фамилия*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentProfile.lastname,callback:function(t){e.$set(e.currentProfile,"lastname",t)},expression:"currentProfile.lastname"}}),a("v-text-field",{attrs:{placeholder:"Имя*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentProfile.name,callback:function(t){e.$set(e.currentProfile,"name",t)},expression:"currentProfile.name"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Гражданство*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentProfile.citizenship,callback:function(t){e.$set(e.currentProfile,"citizenship",t)},expression:"currentProfile.citizenship"}}),a("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"return-value":e.currentProfile.birthdate,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(t){return e.$set(e.currentProfile,"birthdate",t)},"update:return-value":function(t){return e.$set(e.currentProfile,"birthdate",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{readonly:"",placeholder:"Дата рождения*",rules:e.reqRules,outlined:""},model:{value:e.currentProfile.birthdate,callback:function(t){e.$set(e.currentProfile,"birthdate",t)},expression:"currentProfile.birthdate"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("v-date-picker",{attrs:{"no-title":"",scrollable:""},model:{value:e.currentProfile.birthdate,callback:function(t){e.$set(e.currentProfile,"birthdate",t)},expression:"currentProfile.birthdate"}},[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){e.menu=!1}}},[e._v(" Cancel")]),a("v-btn",{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.menu.save(e.currentProfile.birthdate)}}},[e._v(" OK")])],1)],1)],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Номер социального страхования",outlined:""},model:{value:e.currentProfile.social_code_own,callback:function(t){e.$set(e.currentProfile,"social_code_own",t)},expression:"currentProfile.social_code_own"}}),a("v-text-field",{attrs:{placeholder:"Номер соц. страхования в Финляндии*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentProfile.social_code_fin,callback:function(t){e.$set(e.currentProfile,"social_code_fin",t)},expression:"currentProfile.social_code_fin"}})],1),a("h4",[e._v("Адрес в своей стране")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Страна",outlined:""},model:{value:e.currentProfile.address_own.country,callback:function(t){e.$set(e.currentProfile.address_own,"country",t)},expression:"currentProfile.address_own.country"}}),a("v-text-field",{attrs:{placeholder:"Город",outlined:""},model:{value:e.currentProfile.address_own.city,callback:function(t){e.$set(e.currentProfile.address_own,"city",t)},expression:"currentProfile.address_own.city"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Улица",outlined:""},model:{value:e.currentProfile.address_own.street,callback:function(t){e.$set(e.currentProfile.address_own,"street",t)},expression:"currentProfile.address_own.street"}}),a("v-text-field",{attrs:{placeholder:"Индекс",outlined:""},model:{value:e.currentProfile.address_own.index,callback:function(t){e.$set(e.currentProfile.address_own,"index",t)},expression:"currentProfile.address_own.index"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Дом",outlined:""},model:{value:e.currentProfile.address_own.house,callback:function(t){e.$set(e.currentProfile.address_own,"house",t)},expression:"currentProfile.address_own.house"}}),a("v-text-field",{attrs:{placeholder:"Подъезд",outlined:""},model:{value:e.currentProfile.address_own.entrance,callback:function(t){e.$set(e.currentProfile.address_own,"entrance",t)},expression:"currentProfile.address_own.entrance"}}),a("v-text-field",{attrs:{placeholder:"Квартира",outlined:""},model:{value:e.currentProfile.address_own.flat,callback:function(t){e.$set(e.currentProfile.address_own,"flat",t)},expression:"currentProfile.address_own.flat"}})],1),a("h4",[e._v("Адрес в Финляндии")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Страна",outlined:""},model:{value:e.currentProfile.address_fin.country,callback:function(t){e.$set(e.currentProfile.address_fin,"country",t)},expression:"currentProfile.address_fin.country"}}),a("v-text-field",{attrs:{placeholder:"Город",outlined:""},model:{value:e.currentProfile.address_fin.city,callback:function(t){e.$set(e.currentProfile.address_fin,"city",t)},expression:"currentProfile.address_fin.city"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Улица",outlined:""},model:{value:e.currentProfile.address_fin.street,callback:function(t){e.$set(e.currentProfile.address_fin,"street",t)},expression:"currentProfile.address_fin.street"}}),a("v-text-field",{attrs:{placeholder:"Индекс",outlined:""},model:{value:e.currentProfile.address_fin.index,callback:function(t){e.$set(e.currentProfile.address_fin,"index",t)},expression:"currentProfile.address_fin.index"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Дом",outlined:""},model:{value:e.currentProfile.address_fin.house,callback:function(t){e.$set(e.currentProfile.address_fin,"house",t)},expression:"currentProfile.address_fin.house"}}),a("v-text-field",{attrs:{placeholder:"Подъезд",outlined:""},model:{value:e.currentProfile.address_fin.entrance,callback:function(t){e.$set(e.currentProfile.address_fin,"entrance",t)},expression:"currentProfile.address_fin.entrance"}}),a("v-text-field",{attrs:{placeholder:"Квартира",outlined:""},model:{value:e.currentProfile.address_fin.flat,callback:function(t){e.$set(e.currentProfile.address_fin,"flat",t)},expression:"currentProfile.address_fin.flat"}})],1),a("v-row",[a("v-text-field",{attrs:{placeholder:"Телефон",rules:e.phoneRules,required:"",outlined:""},model:{value:e.currentProfile.phone,callback:function(t){e.$set(e.currentProfile,"phone",t)},expression:"currentProfile.phone"}}),a("v-text-field",{attrs:{placeholder:"Телефон в Финляндии*",rules:e.phoneFinRules,required:"",outlined:""},model:{value:e.currentProfile.phone_fin,callback:function(t){e.$set(e.currentProfile,"phone_fin",t)},expression:"currentProfile.phone_fin"}})],1),a("v-text-field",{attrs:{placeholder:"Почта*",rules:e.emailRules,required:"",outlined:""},model:{value:e.currentProfile.auth_user_id.email,callback:function(t){e.$set(e.currentProfile.auth_user_id,"email",t)},expression:"currentProfile.auth_user_id.email"}}),a("v-text-field",{attrs:{placeholder:"Номер счета в банке*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentProfile.bank_account,callback:function(t){e.$set(e.currentProfile,"bank_account",t)},expression:"currentProfile.bank_account"}}),a("v-text-field",{attrs:{placeholder:"Налоговый номер*",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentProfile.tax_number,callback:function(t){e.$set(e.currentProfile,"tax_number",t)},expression:"currentProfile.tax_number"}}),a("v-row",[a("v-checkbox",{attrs:{label:"Свой автомобиль"},model:{value:e.currentProfile.auto,callback:function(t){e.$set(e.currentProfile,"auto",t)},expression:"currentProfile.auto"}}),a("v-checkbox",{attrs:{label:"Свой инструмент"},model:{value:e.currentProfile.tool,callback:function(t){e.$set(e.currentProfile,"tool",t)},expression:"currentProfile.tool"}})],1),a("h4",[e._v("Языки")]),a("v-row",[a("v-checkbox",{attrs:{label:"Английский"},model:{value:e.currentProfile.english,callback:function(t){e.$set(e.currentProfile,"english",t)},expression:"currentProfile.english"}}),a("v-checkbox",{attrs:{label:"Финский"},model:{value:e.currentProfile.finnish,callback:function(t){e.$set(e.currentProfile,"finnish",t)},expression:"currentProfile.finnish"}}),a("v-checkbox",{attrs:{label:"Русский"},model:{value:e.currentProfile.russian,callback:function(t){e.$set(e.currentProfile,"russian",t)},expression:"currentProfile.russian"}}),a("v-checkbox",{attrs:{label:"Эстонский"},model:{value:e.currentProfile.estonian,callback:function(t){e.$set(e.currentProfile,"estonian",t)},expression:"currentProfile.estonian"}})],1),a("v-text-field",{attrs:{placeholder:"Другие языки",outlined:""},model:{value:e.currentProfile.other_language,callback:function(t){e.$set(e.currentProfile,"other_language",t)},expression:"currentProfile.other_language"}}),a("v-combobox",{ref:"positionCombobox",attrs:{items:e.positions,"item-value":"id","item-text":"name",placeholder:"Должность*",outlined:"",dense:"",rules:e.reqRules},model:{value:e.currentProfile.position,callback:function(t){e.$set(e.currentProfile,"position",t)},expression:"currentProfile.position"}}),a("v-textarea",{attrs:{placeholder:"Что умеете делать?",outlined:""},model:{value:e.currentProfile.skills,callback:function(t){e.$set(e.currentProfile,"skills",t)},expression:"currentProfile.skills"}}),a("h4",[e._v("Одежда")]),a("v-row",[a("v-text-field",{attrs:{placeholder:"Ботинки",outlined:""},model:{value:e.currentProfile.boots,callback:function(t){e.$set(e.currentProfile,"boots",t)},expression:"currentProfile.boots"}}),a("v-text-field",{attrs:{placeholder:"Куртка",outlined:""},model:{value:e.currentProfile.jacket,callback:function(t){e.$set(e.currentProfile,"jacket",t)},expression:"currentProfile.jacket"}}),a("v-text-field",{attrs:{placeholder:"Штаны",outlined:""},model:{value:e.currentProfile.pants,callback:function(t){e.$set(e.currentProfile,"pants",t)},expression:"currentProfile.pants"}}),a("v-text-field",{attrs:{placeholder:"Футболка",outlined:""},model:{value:e.currentProfile.shirt,callback:function(t){e.$set(e.currentProfile,"shirt",t)},expression:"currentProfile.shirt"}})],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.editProfile}},[e._v(e._s(e.formBtnText))])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление работника ")]),a("v-card-text",[e._v("Вы действительно хотите удалить профиль? Отменить это действие будет невозможно")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteUser}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmArchiveDialog,callback:function(t){e.confirmArchiveDialog=t},expression:"confirmArchiveDialog"}},[a("v-card",[a("v-card-title",[e._v(" Увольнение работника ")]),a("v-card-text",[e._v(" Вы действительно хотите уволить работника? После подтверждения профиль будет перемещен в архив ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:e.cancelConfirmArchiveDialog}},[e._v(" Отменить ")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.editProfile}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.photoDialog,callback:function(t){e.photoDialog=t},expression:"photoDialog"}},[a("v-card",[a("v-card-title",[e._v(" Сменить фото ")]),a("v-card-text",[a("v-file-input",{attrs:{placeholder:"Фото профиля",accept:"image/*","prepend-icon":"",outlined:""},model:{value:e.photoField,callback:function(t){e.photoField=t},expression:"photoField"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.savePhoto}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.changeGroupForm,callback:function(t){e.changeGroupForm=t},expression:"changeGroupForm"}},[a("v-card",[a("v-card-title",[e._v("Поменять роль пользователя ")]),a("v-card-text",[a("v-select",{attrs:{items:e.groups,"item-text":"name","item-value":"id",outlined:""},model:{value:e.currentGroup.id,callback:function(t){e.$set(e.currentGroup,"id",t)},expression:"currentGroup.id"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.changeGroupForm=!1}}},[e._v("Отмена")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.putUserGroup}},[e._v("Сохранить")])],1)],1)],1)],1)},ka=[],wa={name:"WorkerOpen",components:{WasteIcon:De,EditIcon:Te,BackIcon:qe},props:{id:[String,Number]},data:function(){return{page:"workers",currentProfile:{id:0,lastname:"",name:"",citizenship:"",birthdate:"",social_code_own:"",social_code_fin:"",address_own:{index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""},address_fin:{index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""},phone:"",phone_fin:"",email:"",bank_account:"",tax_number:"",auto:!1,tool:!1,english:!1,estonian:!1,finnish:!1,russian:!1,other_language:"",position:"",skills:"",boots:null,jacket:null,pants:null,shirt:null,photo_path:null,auth_user_id:{email:"",is_staff:"",groups:{id:0,name:""}}},currentGroup:{id:0,name:""},groups:[],positions:[],full:!1,formTitle:"Добавление работника",formBtnText:"Сохранить",addForm:!1,confirmDeleteDialog:!1,confirmArchiveDialog:!1,photoField:null,photoDialog:!1,changeGroupForm:!1,menu:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}],emailRules:[function(e){return!!e||"Необходимо заполнить поле"},function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)||"Некорректный E-mail"}],phoneRules:[function(e){return/^(\+)?((\d{2,3}) ?\d|\d)(([ -]?\d)|( ?(\d{2,3}) ?)){5,12}\d$/.test(e)||"Некорректный номер телефона"}],phoneFinRules:[function(e){return!!e||"Необходимо заполнить поле"},function(e){return/^((([+][\s]{0,1})|([0]{2}[\s-]{0,1}))([358]{3})([\s-]{0,1})|([0]{1}))(([1-9]{1}[0-9]{0,1})([\s-]{0,1})([0-9]{2,4})([\s-]{0,1})([0-9]{2,4})([\s-]{0,1}))([0-9]{0,3}){1}$/.test(e)||"Некорректный номер телефона"}]}},created:function(){localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),-1===this.$parent.$parent.read.indexOf("Работники")&&this.$router.push({name:"Index"}),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadPositions()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/profiles/"+this.id,type:"GET",success:function(t){e.currentProfile=t.data.data[0],null==e.currentProfile.address_fin&&(e.currentProfile.address_fin={index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""}),null==e.currentProfile.address_own&&(e.currentProfile.address_own={index:"",country:"",city:"",street:"",house:"",entrance:"",flat:""}),e.loadGroups()},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadPositions:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/profiles/positions",type:"GET",success:function(t){e.positions=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadGroups:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/groups",type:"GET",success:function(t){e.groups=t.data.groups,e.groups.forEach((function(t){e.currentProfile.auth_user_id.groups[0]===t.id&&(e.currentGroup.name=t.name,e.currentGroup.id=t.id)}))},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},editProfile:function(){var e=this;this.$refs.addForm.validate()&&(this.currentProfile.position=this.currentProfile.position.id,o.a.ajax({url:this.$hostname+"time-tracking/profiles",type:"PUT",data:this.currentProfile,success:function(){console.log("Профиль изменен"),e.addForm?e.editUser():(e.confirmArchiveDialog=!1,e.loadData())},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}}))},editUser:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/user",type:"PUT",data:{id:this.currentProfile.auth_user_id.id,username:this.currentProfile.auth_user_id.email,email:this.currentProfile.auth_user_id.email},success:function(){console.log("Пользователь изменен"),e.loadData(),e.addForm=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},savePhoto:function(){var e=this,t=a("bc3a"),n=new FormData,s=this.photoField;void 0!==s?(n.append("image",s),t({method:"put",url:this.$hostname+"time-tracking/profiles/"+this.currentProfile.id,headers:{Authorization:"Token "+(sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token"))},data:n}).then((function(t){console.log(t.data.data),e.photoDialog=!1,e.photoField=null,e.currentProfile.photo_path=t.data.data.name,e.loadData()}))):console.log("ERROR")},putUserGroup:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/user-groups",type:"PUT",data:{auth_user_id:this.currentProfile.auth_user_id.id,group_id:this.currentGroup.id},success:function(t){console.log(t.data.data),e.currentGroup.name=t.data.data[0],e.changeGroupForm=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},deleteUser:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/user",type:"DELETE",data:{email:this.currentProfile.auth_user_id.email},success:function(){e.alertMsg="Пользователь удален",e.loadData(),e.confirmDeleteDialog=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},openEditForm:function(){this.formTitle="Редактирование работника",this.formBtnText="Сохранить работника",this.addForm=!0},openConfirmArchiveDialog:function(){this.currentProfile.active?this.editProfile():(this.currentProfile.active=!1,this.confirmArchiveDialog=!0)},cancelConfirmArchiveDialog:function(){this.currentProfile.active=!0,this.confirmArchiveDialog=!1},printProfile:function(){var e=this,t="";if(o.a.ajax({url:this.$hostname+"time-tracking/print-profiles/"+this.id,type:"GET",success:function(e){t=e.data.path},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0},async:!1}),""!==t){var n=a("bc3a");n({url:this.$hostname+t,method:"GET",responseType:"blob"}).then((function(e){var a=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=a,n.setAttribute("download",t.substr(t.lastIndexOf("/")+1)),document.body.appendChild(n),n.click()}))}}}},xa=wa,Ca=Object(m["a"])(xa,ga,ka,!1,null,"7defaf36",null),ya=Ca.exports;v()(Ca,{VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCheckbox:ae["a"],VCombobox:vt["a"],VDatePicker:at["a"],VDialog:H["a"],VFileInput:He["a"],VForm:ce["a"],VIcon:h["a"],VImg:p["a"],VMenu:it["a"],VRow:rt["a"],VSelect:ot["a"],VSpacer:Qe["a"],VTextField:ue["a"],VTextarea:Q["a"],VToolbar:Ze["a"]});var $a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"positions flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("h1",[e._v(e._s(e.title))]),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(t){e.addForm=!0}}},[e._v("Добавить")]),a("v-list",{staticClass:"content-list"},[e._l(e.positions,(function(t){return[a("v-list-item",{key:t.id},[a("v-list-item-content",["term"===e.table?a("v-list-item-title",[e._v(e._s(t.days))]):"tax"===e.table?a("v-list-item-title",[e._v(e._s(t.tax))]):a("v-list-item-title",[e._v(e._s(t.name))])],1),-1!==e.$parent.$parent.edit.indexOf("Работники")||-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("v-list-item-action",[a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:function(a){e.currentPosition=t.id,e.confirmDeleteDialog=!0}}},[e._v(" $deleteIcon ")])],1):e._e()],1)]}))],2),a("v-dialog",{attrs:{"max-width":"520"},model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-card-title",[e._v(" Добавление ")]),a("v-card-text",[a("v-form",{ref:"addForm"},["term"===e.table||"tax"===e.table?a("v-text-field",{attrs:{label:"Значение*",outlined:"",rules:e.reqRules,type:"number"},model:{value:e.newPosition,callback:function(t){e.newPosition=t},expression:"newPosition"}}):a("v-text-field",{attrs:{label:"Название*",outlined:"",rules:e.reqRules},model:{value:e.newPosition,callback:function(t){e.newPosition=t},expression:"newPosition"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.addForm=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.addPosition}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление ")]),a("v-card-text",[e._v("Вы действительно хотите удалить выбранный элемент? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deletePosition}},[e._v("Подтвердить")])],1)],1)],1)],1)],1)},Da=[],Pa={name:"Positions",props:{table:String},components:{Header:R},data:function(){return{title:"",url:"",positions:[],newPosition:"",currentPosition:0,addForm:!1,confirmDeleteDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}]}},created:function(){if(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")){switch(this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.table){case"profile":this.url="time-tracking/profiles/positions",this.title="Специальности профилей";break;case"client":this.url="time-tracking/clients-employees/positions",this.title="Должности контактов";break;case"cheque":this.url="time-tracking/cheque/categories",this.title="Категории чеков";break;case"waybill":this.url="time-tracking/waybill/goal",this.title="Цели для поездок";break;case"term":this.url="time-tracking/accounting/terms",this.title="Сроки предложений и счетов";break;case"tax":this.url="time-tracking/accounting/taxes",this.title="Налог на добавленную стоимость";break}this.loadData()}else this.$emit("set-not-auth"),this.$router.push({name:"Index"})},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+this.url,type:"GET",success:function(t){e.positions=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},addPosition:function(){var e=this;this.$refs.addForm.validate()&&o.a.ajax({url:this.$hostname+this.url,type:"POST",data:{name:this.newPosition},success:function(){e.addForm=!1,e.loadData(),e.newPosition=""},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},deletePosition:function(){var e=this;o.a.ajax({url:this.$hostname+this.url,type:"DELETE",data:{id:this.currentPosition},success:function(){e.confirmDeleteDialog=!1,e.loadData()},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})}}},Ea=Pa,Ma=Object(m["a"])(Ea,$a,Da,!1,null,"05a95d89",null),Ia=Ma.exports;v()(Ma,{VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VDialog:H["a"],VForm:ce["a"],VIcon:h["a"],VList:_["a"],VListItem:g["a"],VListItemAction:st["a"],VListItemContent:k["a"],VListItemTitle:k["c"],VSpacer:Qe["a"],VTextField:ue["a"]});var Sa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"accounting flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("h1",[e._v(e._s(e.title))]),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(t){e.addForm=!0}}},[e._v("Добавить документ")]),a("div",{staticClass:"documents-all"},[a("v-data-table",{attrs:{headers:e.headers,items:e.documents,"item-key":"id"},scopedSlots:e._u([{key:"item.actions",fn:function(t){var n=t.item;return[-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("v-icon",{attrs:{small:""},on:{click:function(t){e.currentDocument=n.id,e.confirmDeleteDialog=!0}}},[e._v(" mdi-delete ")]):e._e()]}},{key:"item.name",fn:function(t){var n=t.item;return[a("span",{on:{click:function(t){return e.$router.push({name:"AccountingOpen",params:{type:e.type,id:n.id}})}}},[e._v(" "+e._s(n.name)+" ")])]}},{key:"no-data",fn:function(){return[e._v(" Документы не загружены ")]},proxy:!0}])})],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-card-title",[e._v(" Новый документ ")]),a("v-card-text",[a("v-form",{ref:"form",attrs:{model:e.newDocument}},[a("v-text-field",{attrs:{label:"Название*",outlined:"",rules:e.reqRules,required:""},model:{value:e.newDocument.name,callback:function(t){e.$set(e.newDocument,"name",t)},expression:"newDocument.name"}}),a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата создания",readonly:"",outlined:""},model:{value:e.newDocument.create_date,callback:function(t){e.$set(e.newDocument,"create_date",t)},expression:"newDocument.create_date"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("v-date-picker",{on:{input:function(t){e.menu=!1}},model:{value:e.newDocument.create_date,callback:function(t){e.$set(e.newDocument,"create_date",t)},expression:"newDocument.create_date"}})],1),"contracts"===e.type||"property"===e.type?a("v-combobox",{attrs:{placeholder:"Фирма*",items:e.clients,"item-text":"name","item-value":"id",rules:e.reqRules,required:"",outlined:""},model:{value:e.newDocument.client,callback:function(t){e.$set(e.newDocument,"client",t)},expression:"newDocument.client"}}):e._e(),a("v-file-input",{attrs:{placeholder:"Выберите документ*",accept:"*","prepend-icon":"",outlined:"",multiple:"",counter:"",rules:e.reqRules},model:{value:e.newDocument.path,callback:function(t){e.$set(e.newDocument,"path",t)},expression:"newDocument.path"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.addForm=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.addDocument}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление документа ")]),a("v-card-text",[e._v("Вы действительно хотите удалить выбранный документ? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteDocument}},[e._v("Подтвердить")])],1)],1)],1)],1)],1)},Ta=[],Va={name:"Accounting",components:{Header:R},props:{type:String},data:function(){return{title:"",url:"",mode:0,documents:[],clients:[],newDocument:{id:0,name:"",create_date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),path:"",client:""},currentDocument:0,headers:[{text:"Название",align:"start",sortable:!0,value:"name"},{text:"Дата создания",value:"create_date"},{text:"",value:"actions",sortable:!1}],menu:!1,addForm:!1,confirmDeleteDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}]}},created:function(){if(console.log("init Accounting "+this.type),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")){switch(this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.type){case"reports":this.title="Бухгалтерские отчеты",this.url="time-tracking/accounting/documents",this.mode=1;break;case"extracts":this.title="Бухгалтерские выписки",this.url="time-tracking/accounting/documents",this.mode=2;break;case"documents":this.title="Бухгалтерские документы",this.url="time-tracking/accounting/documents",this.mode=3;break;case"contracts":this.headers=[{text:"Название",align:"start",sortable:!0,value:"name"},{text:"Дата создания",value:"create_date"},{text:"Клиент",value:"client.name"},{text:"",value:"actions",sortable:!1}],this.title="Договора с клиентами",this.url="time-tracking/accounting/documents-client",this.mode=4,this.loadClients();break;case"property":this.headers=[{text:"Название",align:"start",sortable:!0,value:"name"},{text:"Дата создания",value:"create_date"},{text:"Клиент",value:"client.name"},{text:"",value:"actions",sortable:!1}],this.title="Документы на собственность",this.url="time-tracking/accounting/documents-client",this.mode=5,this.loadClients();break}this.loadData()}else this.$emit("set-not-auth"),this.$router.push({name:"Index"})},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+this.url+"/"+this.mode,type:"GET",success:function(t){e.documents=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadClients:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"GET",success:function(t){e.clients=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},addDocument:function(){var e=this;if(console.log(this.newDocument.path),this.$refs.form.validate()){var t=a("bc3a"),n=new FormData,s=0;this.newDocument.path.forEach((function(e){console.log(e),s++,n.append("document"+s,e)})),n.append("id",this.newDocument.id),n.append("create_date",this.newDocument.create_date),n.append("name",this.newDocument.name),"contracts"!==this.type&&"property"!==this.type||n.append("client",this.newDocument.client.id),t({method:"put",url:this.$hostname+this.url+"/"+this.mode,headers:{Authorization:"Token "+(sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token"))},data:n}).then((function(t){console.log(t),e.addForm=!1,e.newDocument={id:0,name:"",create_date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),path:"",client:""},e.loadData()}))}},deleteDocument:function(){var e=this;o.a.ajax({url:this.$hostname+this.url,type:"DELETE",data:{id:this.currentDocument},success:function(){console.log("Документ удален"),e.confirmDeleteDialog=!1,e.loadData()},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})}}},ja=Va,Fa=Object(m["a"])(ja,Sa,Ta,!1,null,"24d89a90",null),Oa=Fa.exports;v()(Fa,{VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCombobox:vt["a"],VDataTable:xt["a"],VDatePicker:at["a"],VDialog:H["a"],VFileInput:He["a"],VForm:ce["a"],VIcon:h["a"],VMenu:it["a"],VSpacer:Qe["a"],VTextField:ue["a"]});var Aa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"accounting flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h1",[e._v(e._s(e.title))]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.push({name:"Accounting",params:{type:e.type}})}}},[a("span",[e._v("К списку документов")]),a("back-icon")],1)]),a("div",{staticClass:"document"},[a("h3",[e._v(e._s(e.currentDocument.name))]),a("div",{staticClass:"document_date"},[e._v("Дата создания: "+e._s(e.currentDocument.create_date))]),"contracts"===e.type||"property"===e.type?a("div",{staticClass:"document_client"},[e._v(" Клиент: "+e._s(e.currentDocument.client.name)+" ")]):e._e(),a("strong",[e._v("Документы:")]),a("ul",{staticClass:"document_path"},[e._l(e.currentDocument.path.split(";"),(function(t){return[a("li",{key:t,on:{click:function(a){return e.downloadFile(t)}}},[e._v(e._s(t.substr(t.lastIndexOf("/")+1)))])]}))],2),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.downloadAll}},[e._v("Скачать все файлы")])],1)])],1)},qa=[],La={name:"AccountingOpen",components:{BackIcon:qe,Header:R},props:{type:String,id:[String,Number]},data:function(){return{title:"",url:"",mode:0,clients:[],currentDocument:{id:0,name:"",create_date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),path:"",client:""},menu:!1,addForm:!1,confirmDeleteDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}]}},created:function(){if(console.log("init Accounting "+this.type),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")){switch(this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.type){case"reports":this.title="Бухгалтерские отчеты",this.url="time-tracking/accounting/documents",this.mode=1;break;case"extracts":this.title="Бухгалтерские выписки",this.url="time-tracking/accounting/documents",this.mode=2;break;case"documents":this.title="Бухгалтерские документы",this.url="time-tracking/accounting/documents",this.mode=3;break;case"contracts":this.title="Договора с клиентами",this.url="time-tracking/accounting/documents-client",this.mode=4,this.loadClients();break;case"property":this.title="Документы на собственность",this.url="time-tracking/accounting/documents-client",this.mode=5,this.loadClients();break}this.loadData()}else this.$emit("set-not-auth"),this.$router.push({name:"Index"})},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+this.url+"/"+this.mode+"/"+this.id,type:"GET",success:function(t){e.currentDocument=t.data.data[0]},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadClients:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"GET",success:function(t){e.clients=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},downloadFile:function(e){console.log(this.$hostname+"media"+e);var t=a("bc3a");t({url:this.$hostname+"media"+e,method:"GET",responseType:"blob"}).then((function(t){var a=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=a,n.setAttribute("download",e),document.body.appendChild(n),n.click()}))},downloadAll:function(){var e=this,t=a("bc3a");o.a.ajax({url:this.$hostname+"time-tracking/to-zip",type:"POST",data:{name:this.currentDocument.name,path:this.currentDocument.path},success:function(a){console.log(a.data.name);var n=a.data.name;t({url:e.$hostname+n,method:"GET",responseType:"blob"}).then((function(e){var t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download",n.substr(n.lastIndexOf("/")+1)),document.body.appendChild(a),a.click()}))},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})}}},Ra=La,Wa=Object(m["a"])(Ra,Aa,qa,!1,null,"7b6ec615",null),Na=Wa.exports;v()(Wa,{VBtn:G["a"]});var Ga=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"waybill flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("h1",[e._v("Путевые листы")]),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(t){e.addForm=!0}}},[e._v("Добавить")]),a("v-data-table",{attrs:{headers:e.headers,items:e.waybills,"item-key":"id"},scopedSlots:e._u([{key:"item.actions",fn:function(t){var n=t.item;return[-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("v-icon",{attrs:{small:""},on:{click:function(t){e.currentWaybill=n.id,e.confirmDeleteDialog=!0}}},[e._v(" mdi-delete ")]):e._e()]}},{key:"item.date_start",fn:function(t){var n=t.item;return[a("span",{on:{click:function(t){return e.$router.push({name:"WaybillOpen",params:{id:n.id}})}}},[e._v(" "+e._s(n.date_start)+" ")])]}},{key:"no-data",fn:function(){return[e._v(" Вы не заполнили ни одного путевого листа ")]},proxy:!0}])})],1),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"form",attrs:{model:e.newWaybill}},[a("v-row",[-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")||"Добавление"===e.formTitle?a("v-menu",{ref:"dateStartMenu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата начала поездки",readonly:"",outlined:""},model:{value:e.newWaybill.date_start,callback:function(t){e.$set(e.newWaybill,"date_start",t)},expression:"newWaybill.date_start"}},"v-text-field",s,!1),n))]}}],null,!1,4031167880),model:{value:e.menus.dateStartMenu,callback:function(t){e.$set(e.menus,"dateStartMenu",t)},expression:"menus.dateStartMenu"}},[a("v-date-picker",{on:{input:function(t){e.menus.dateStartMenu=!1}},model:{value:e.newWaybill.date_start,callback:function(t){e.$set(e.newWaybill,"date_start",t)},expression:"newWaybill.date_start"}})],1):e._e(),-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")||"Добавление"===e.formTitle?a("v-menu",{ref:"dateEndMenu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата окончания поездки",readonly:"",outlined:""},model:{value:e.newWaybill.date_end,callback:function(t){e.$set(e.newWaybill,"date_end",t)},expression:"newWaybill.date_end"}},"v-text-field",s,!1),n))]}}],null,!1,2195424620),model:{value:e.menus.dateEndMenu,callback:function(t){e.$set(e.menus,"dateEndMenu",t)},expression:"menus.dateEndMenu"}},[a("v-date-picker",{on:{input:function(t){e.menus.dateEndMenu=!1}},model:{value:e.newWaybill.date_end,callback:function(t){e.$set(e.newWaybill,"date_end",t)},expression:"newWaybill.date_end"}})],1):e._e()],1),e.$parent.$parent.admin||"Редактирование"!==e.formTitle?e._e():a("v-text-field",{attrs:{label:"Дата начала поездки",outlined:"",disabled:""},model:{value:e.newWaybill.date_start,callback:function(t){e.$set(e.newWaybill,"date_start",t)},expression:"newWaybill.date_start"}}),e.$parent.$parent.admin||"Редактирование"!==e.formTitle?e._e():a("v-text-field",{attrs:{label:"Дата окончания поездки",outlined:"",disabled:""},model:{value:e.newWaybill.date_end,callback:function(t){e.$set(e.newWaybill,"date_end",t)},expression:"newWaybill.date_end"}}),a("v-text-field",{attrs:{label:"Пункт отправления",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.departure,callback:function(t){e.$set(e.newWaybill,"departure",t)},expression:"newWaybill.departure"}}),a("v-text-field",{attrs:{label:"Пункт назначения",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.destination,callback:function(t){e.$set(e.newWaybill,"destination",t)},expression:"newWaybill.destination"}}),a("h3",[e._v("Километраж")]),a("v-row",[a("v-text-field",{attrs:{type:"number",label:"Перед поездкой",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.kilometrage_start,callback:function(t){e.$set(e.newWaybill,"kilometrage_start",t)},expression:"newWaybill.kilometrage_start"}}),a("v-text-field",{attrs:{type:"number",label:"После поездки",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.kilometrage_end,callback:function(t){e.$set(e.newWaybill,"kilometrage_end",t)},expression:"newWaybill.kilometrage_end"}}),a("div",[e._v(e._s(e.newWaybill.kilometrage_end-e.newWaybill.kilometrage_start))])],1),a("v-row",[a("v-menu",{ref:"menuStartTime",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.newWaybill.time_start,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.newWaybill,"time_start",t)},"update:return-value":function(t){return e.$set(e.newWaybill,"time_start",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Время начала поездки",readonly:"",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.time_start,callback:function(t){e.$set(e.newWaybill,"time_start",t)},expression:"newWaybill.time_start"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.timeStartMenu,callback:function(t){e.$set(e.menus,"timeStartMenu",t)},expression:"menus.timeStartMenu"}},[e.menus.timeStartMenu?a("v-time-picker",{attrs:{"full-width":"",format:"24hr"},on:{"click:minute":function(t){return e.$refs.menuStartTime.save(e.newWaybill.time_start)}},model:{value:e.newWaybill.time_start,callback:function(t){e.$set(e.newWaybill,"time_start",t)},expression:"newWaybill.time_start"}}):e._e()],1),a("v-menu",{ref:"menuEndTime",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.newWaybill.time_end,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.newWaybill,"time_end",t)},"update:return-value":function(t){return e.$set(e.newWaybill,"time_end",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Время конца поездки",readonly:"",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.time_end,callback:function(t){e.$set(e.newWaybill,"time_end",t)},expression:"newWaybill.time_end"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.timeEndMenu,callback:function(t){e.$set(e.menus,"timeEndMenu",t)},expression:"menus.timeEndMenu"}},[e.menus.timeEndMenu?a("v-time-picker",{attrs:{"full-width":"",format:"24hr"},on:{"click:minute":function(t){return e.$refs.menuEndTime.save(e.newWaybill.time_end)}},model:{value:e.newWaybill.time_end,callback:function(t){e.$set(e.newWaybill,"time_end",t)},expression:"newWaybill.time_end"}}):e._e()],1)],1),a("v-autocomplete",{attrs:{items:e.goals,"item-text":"name","item-value":"id",label:"Цель поездки",rules:e.reqRules,required:"",outlined:""},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-title",[e._v(" Искомая цель поездки не создана. Обратитесь к администратору ")])],1)]},proxy:!0}]),model:{value:e.newWaybill.goal,callback:function(t){e.$set(e.newWaybill,"goal",t)},expression:"newWaybill.goal"}}),a("h3",[e._v("Автомобиль")]),a("v-row",[a("v-text-field",{attrs:{label:"Марка",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.auto_mark,callback:function(t){e.$set(e.newWaybill,"auto_mark",t)},expression:"newWaybill.auto_mark"}}),a("v-select",{attrs:{label:"Тип коробки",outlined:"",rules:e.reqRules,required:"",items:e.selectType},model:{value:e.newWaybill.auto_type,callback:function(t){e.$set(e.newWaybill,"auto_type",t)},expression:"newWaybill.auto_type"}}),a("v-select",{attrs:{label:"Тип топлива",outlined:"",rules:e.reqRules,required:"",items:e.selectFuel},model:{value:e.newWaybill.auto_fuel,callback:function(t){e.$set(e.newWaybill,"auto_fuel",t)},expression:"newWaybill.auto_fuel"}})],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.addWaybill}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление путевого листа ")]),a("v-card-text",[e._v("Вы действительно хотите удалить путевой лист? Отменить это действие будет невозможно")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteWaybill}},[e._v("Подтвердить")])],1)],1)],1)],1)},Ba=[],za={name:"Waybill",components:{Header:R},data:function(){return{waybills:[],goals:[],newWaybill:{id:0,date_start:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),date_end:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),departure:"",destination:"",kilometrage_start:0,kilometrage_end:0,time_start:"",time_end:"",goal:"",auto_mark:"",auto_type:"",auto_fuel:""},selectType:["Автомат","Механика"],selectFuel:["Дизель","Бензин","Электро"],menus:{dateStartMenu:!1,dateEndMenu:!1,timeStartMenu:!1,timeEndMenu:!1},headers:[{text:"Дата начала",value:"date_start",align:"start"},{text:"Дата окончания",value:"date_end",align:"start"},{text:"Пункт отправления",align:"start",value:"departure"},{text:"Пункт назначения",align:"start",value:"destination"},{text:"",value:"actions",sortable:!1}],currentWaybill:0,formTitle:"Добавление",addForm:!1,confirmDeleteDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}]}},created:function(){console.log("init Waybills"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),-1===this.$parent.$parent.read.indexOf("Бухгалтерия")&&this.$router.push({name:"Index"}),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadGoals()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/waybill",type:"GET",success:function(t){e.waybills=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadGoals:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/waybill/goal",type:"GET",success:function(t){e.goals=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},addWaybill:function(){var e=this;this.$refs.form.validate()&&o.a.ajax({url:this.$hostname+"time-tracking/waybill",type:"POST",data:this.newWaybill,success:function(){e.loadData(),e.addForm=!1,e.newWaybill={date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),departure:"",destination:"",kilometrage:"",time_start:"",time_end:"",goal:"",auto_mark:"",auto_type:"",auto_fuel:""}},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},deleteWaybill:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/waybill",type:"DELETE",data:{id:this.currentWaybill},success:function(){e.loadData(),e.confirmDeleteDialog=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})}}},Ua=za,Ha=a("c6a6"),Qa=a("c964"),Za=Object(m["a"])(Ua,Ga,Ba,!1,null,"44ec5138",null),Ya=Za.exports;v()(Za,{VAutocomplete:Ha["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VDataTable:xt["a"],VDatePicker:at["a"],VDialog:H["a"],VForm:ce["a"],VIcon:h["a"],VListItem:g["a"],VListItemTitle:k["c"],VMenu:it["a"],VRow:rt["a"],VSelect:ot["a"],VSpacer:Qe["a"],VTextField:ue["a"],VTimePicker:Qa["a"],VToolbar:Ze["a"]});var Ka=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"waybill flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h1",[e._v("Путевые листы")]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.push({name:"Waybill"})}}},[a("span",[e._v("К списку путевых листов")]),a("back-icon")],1)]),a("ul",[a("li",[a("span",{staticClass:"title"},[e._v("Начало поездки")]),a("span",{staticClass:"content"},[e._v(e._s(e.newWaybill.date_start)+" "+e._s(e.newWaybill.time_start))])]),a("li",[a("span",{staticClass:"title"},[e._v("Конец поездки")]),a("span",{staticClass:"content"},[e._v(e._s(e.newWaybill.date_end)+"-"+e._s(e.newWaybill.time_end))])]),a("li",[a("span",{staticClass:"title"},[e._v("Пункт отправления")]),a("span",{staticClass:"content"},[e._v(e._s(e.newWaybill.departure))])]),a("li",[a("span",{staticClass:"title"},[e._v("Пункт назначения")]),a("span",{staticClass:"content"},[e._v(e._s(e.newWaybill.destination))])]),a("li",[a("span",{staticClass:"title"},[e._v("Километраж")]),a("span",{staticClass:"content"},[e._v(e._s(e.newWaybill.kilometrage_end-e.newWaybill.kilometrage_start))])]),a("li",[a("span",{staticClass:"title"},[e._v("Работник")]),a("span",{staticClass:"content"},[e._v(e._s(e.newWaybill.user_profile.name)+" "+e._s(e.newWaybill.user_profile.lastname)+" ("+e._s(e.newWaybill.user_profile.position.name)+")")])]),a("li",[a("span",{staticClass:"title"},[e._v("Цель поездки")]),a("span",{staticClass:"content"},[e._v(e._s(e.newWaybill.goal.name))])]),a("h3",[e._v("Автомобиль")]),a("li",[a("span",{staticClass:"title"},[e._v("Марка")]),a("span",{staticClass:"content"},[e._v(e._s(e.newWaybill.auto_mark))])]),a("li",[a("span",{staticClass:"title"},[e._v("Коробка")]),a("span",{staticClass:"content"},[e._v(e._s(e.newWaybill.auto_type))])]),a("li",[a("span",{staticClass:"title"},[e._v("Топливо")]),a("span",{staticClass:"content"},[e._v(e._s(e.newWaybill.auto_fuel))])])]),-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(t){e.loadGoals,e.addForm=!0}}},[e._v(" Редактировать ")]):e._e(),-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(t){e.confirmDeleteDialog=!0}}},[e._v(" Удалить ")]):e._e()],1),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v("Редактирование")]),a("v-card-text",[a("v-form",{ref:"form",attrs:{model:e.newWaybill}},[a("v-row",[e.$parent.$parent.admin?a("v-menu",{ref:"dateStartMenu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата начала поездки",readonly:"",outlined:""},model:{value:e.newWaybill.date_start,callback:function(t){e.$set(e.newWaybill,"date_start",t)},expression:"newWaybill.date_start"}},"v-text-field",s,!1),n))]}}],null,!1,4031167880),model:{value:e.menus.dateStartMenu,callback:function(t){e.$set(e.menus,"dateStartMenu",t)},expression:"menus.dateStartMenu"}},[a("v-date-picker",{on:{input:function(t){e.menus.dateStartMenu=!1}},model:{value:e.newWaybill.date_start,callback:function(t){e.$set(e.newWaybill,"date_start",t)},expression:"newWaybill.date_start"}})],1):e._e(),e.$parent.$parent.admin?a("v-menu",{ref:"dateEndMenu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата окончания поездки",readonly:"",outlined:""},model:{value:e.newWaybill.date_end,callback:function(t){e.$set(e.newWaybill,"date_end",t)},expression:"newWaybill.date_end"}},"v-text-field",s,!1),n))]}}],null,!1,2195424620),model:{value:e.menus.dateEndMenu,callback:function(t){e.$set(e.menus,"dateEndMenu",t)},expression:"menus.dateEndMenu"}},[a("v-date-picker",{on:{input:function(t){e.menus.dateEndMenu=!1}},model:{value:e.newWaybill.date_end,callback:function(t){e.$set(e.newWaybill,"date_end",t)},expression:"newWaybill.date_end"}})],1):e._e()],1),e.$parent.$parent.admin?e._e():a("v-text-field",{attrs:{label:"Дата начала поездки",outlined:"",disabled:""},model:{value:e.newWaybill.date_start,callback:function(t){e.$set(e.newWaybill,"date_start",t)},expression:"newWaybill.date_start"}}),e.$parent.$parent.admin?e._e():a("v-text-field",{attrs:{label:"Дата окончания поездки",outlined:"",disabled:""},model:{value:e.newWaybill.date_end,callback:function(t){e.$set(e.newWaybill,"date_end",t)},expression:"newWaybill.date_end"}}),a("v-text-field",{attrs:{label:"Пункт отправления",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.departure,callback:function(t){e.$set(e.newWaybill,"departure",t)},expression:"newWaybill.departure"}}),a("v-text-field",{attrs:{label:"Пункт назначения",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.destination,callback:function(t){e.$set(e.newWaybill,"destination",t)},expression:"newWaybill.destination"}}),a("h3",[e._v("Километраж")]),a("v-row",[a("v-text-field",{attrs:{type:"number",label:"Перед поездкой",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.kilometrage_start,callback:function(t){e.$set(e.newWaybill,"kilometrage_start",t)},expression:"newWaybill.kilometrage_start"}}),a("v-text-field",{attrs:{type:"number",label:"После поездки",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.kilometrage_end,callback:function(t){e.$set(e.newWaybill,"kilometrage_end",t)},expression:"newWaybill.kilometrage_end"}}),a("div",[e._v(e._s(e.newWaybill.kilometrage_end-e.newWaybill.kilometrage_start))])],1),a("v-row",[a("v-menu",{ref:"menuStartTime",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.newWaybill.time_start,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.newWaybill,"time_start",t)},"update:return-value":function(t){return e.$set(e.newWaybill,"time_start",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Время начала поездки",readonly:"",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.time_start,callback:function(t){e.$set(e.newWaybill,"time_start",t)},expression:"newWaybill.time_start"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.timeStartMenu,callback:function(t){e.$set(e.menus,"timeStartMenu",t)},expression:"menus.timeStartMenu"}},[e.menus.timeStartMenu?a("v-time-picker",{attrs:{"full-width":"",format:"24hr"},on:{"click:minute":function(t){return e.$refs.menuStartTime.save(e.newWaybill.time_start)}},model:{value:e.newWaybill.time_start,callback:function(t){e.$set(e.newWaybill,"time_start",t)},expression:"newWaybill.time_start"}}):e._e()],1),a("v-menu",{ref:"menuEndTime",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.newWaybill.time_end,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.newWaybill,"time_end",t)},"update:return-value":function(t){return e.$set(e.newWaybill,"time_end",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Время конца поездки",readonly:"",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.time_end,callback:function(t){e.$set(e.newWaybill,"time_end",t)},expression:"newWaybill.time_end"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.timeEndMenu,callback:function(t){e.$set(e.menus,"timeEndMenu",t)},expression:"menus.timeEndMenu"}},[e.menus.timeEndMenu?a("v-time-picker",{attrs:{"full-width":"",format:"24hr"},on:{"click:minute":function(t){return e.$refs.menuEndTime.save(e.newWaybill.time_end)}},model:{value:e.newWaybill.time_end,callback:function(t){e.$set(e.newWaybill,"time_end",t)},expression:"newWaybill.time_end"}}):e._e()],1)],1),a("v-autocomplete",{attrs:{items:e.goals,"item-text":"name","item-value":"id",label:"Цель поездки",rules:e.reqRules,required:"",outlined:""},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-title",[e._v(" Искомая цель поездки не создана. Обратитесь к администратору ")])],1)]},proxy:!0}]),model:{value:e.newWaybill.goal,callback:function(t){e.$set(e.newWaybill,"goal",t)},expression:"newWaybill.goal"}}),a("h3",[e._v("Автомобиль")]),a("v-row",[a("v-text-field",{attrs:{label:"Марка",outlined:"",rules:e.reqRules,required:""},model:{value:e.newWaybill.auto_mark,callback:function(t){e.$set(e.newWaybill,"auto_mark",t)},expression:"newWaybill.auto_mark"}}),a("v-select",{attrs:{label:"Тип коробки",outlined:"",rules:e.reqRules,required:"",items:e.selectType},model:{value:e.newWaybill.auto_type,callback:function(t){e.$set(e.newWaybill,"auto_type",t)},expression:"newWaybill.auto_type"}}),a("v-select",{attrs:{label:"Тип топлива",outlined:"",rules:e.reqRules,required:"",items:e.selectFuel},model:{value:e.newWaybill.auto_fuel,callback:function(t){e.$set(e.newWaybill,"auto_fuel",t)},expression:"newWaybill.auto_fuel"}})],1)],1)],1),a("v-card-actions",[a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.putWaybill}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление путевого листа ")]),a("v-card-text",[e._v("Вы действительно хотите удалить путевой лист? Отменить это действие будет невозможно")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteWaybill}},[e._v("Подтвердить")])],1)],1)],1)],1)},Xa=[],Ja={name:"WaybillOpen",components:{BackIcon:qe,Header:R},props:{id:[String,Number]},data:function(){return{goals:[],newWaybill:{id:0,date_start:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),date_end:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),departure:"",destination:"",kilometrage_start:"",kilometrage_end:"",time_start:"",time_end:"",goal:"",auto_mark:"",auto_type:"",auto_fuel:"",user_profile:{name:"",lastname:"",position:{name:""}}},selectType:["Автомат","Механика"],selectFuel:["Дизель","Бензин","Электро"],menus:{dateStartMenu:!1,dateEndMenu:!1,timeStartMenu:!1,timeEndMenu:!1},addForm:!1,confirmDeleteDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}]}},created:function(){console.log("init Waybills"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),-1===this.$parent.$parent.read.indexOf("Бухгалтерия")&&this.$router.push({name:"Index"}),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadGoals()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/waybill/"+this.id,type:"GET",success:function(t){e.newWaybill=t.data.data[0]},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadGoals:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/waybill/goal",type:"GET",success:function(t){e.goals=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},putWaybill:function(){var e=this;this.$refs.form.validate()&&o.a.ajax({url:this.$hostname+"time-tracking/waybill",type:"PUT",data:this.newWaybill,success:function(){e.loadData(),e.addForm=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},deleteWaybill:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/waybill",type:"DELETE",data:{id:this.id},success:function(){e.confirmDeleteDialog=!1,e.$router.push({name:"Waybill"})},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})}}},en=Ja,tn=Object(m["a"])(en,Ka,Xa,!1,null,"7ab0cf90",null),an=tn.exports;v()(tn,{VAutocomplete:Ha["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VDatePicker:at["a"],VDialog:H["a"],VForm:ce["a"],VIcon:h["a"],VListItem:g["a"],VListItemTitle:k["c"],VMenu:it["a"],VRow:rt["a"],VSelect:ot["a"],VSpacer:Qe["a"],VTextField:ue["a"],VTimePicker:Qa["a"],VToolbar:Ze["a"]});var nn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"purchases flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("h1",[e._v("Покупки")]),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(t){e.formTitle="Добавление",e.addForm=!0}}},[e._v("Добавить")]),a("v-menu",{ref:"filterMenu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Месяц","prepend-icon":"mdi-calendar",readonly:"",outlined:""},model:{value:e.filter.month,callback:function(t){e.$set(e.filter,"month",t)},expression:"filter.month"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.filterMenu,callback:function(t){e.$set(e.menus,"filterMenu",t)},expression:"menus.filterMenu"}},[a("v-date-picker",{attrs:{type:"month",max:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),min:"1950-01-01"},on:{change:function(t){e.$refs.filterMenu.save(e.filter.month),e.loadData()}},model:{value:e.filter.month,callback:function(t){e.$set(e.filter,"month",t)},expression:"filter.month"}})],1),a("div",{staticClass:"purchases__content"},[a("div",[a("h3",[e._v("Статистика")]),a("div",[e._v("Чеков "+e._s(e.purchases.length))]),a("div",[e._v("Категорий "+e._s(e.statistic.count_categories))]),a("div",[e._v("Сумма "+e._s(e.statistic.sum))]),a("strong",[e._v("По каегориям: ")]),e._l(e.statistic.by_categories,(function(t){return[a("div",{key:t.category__name},[e._v(e._s(t.category__name)+" - "+e._s(t.price__sum))])]}))],2),e._l(e.purchases,(function(t){return[a("div",{key:t.id,staticClass:"purchases-single"},[0!==e.photos[t.id].length?a("v-img",{attrs:{width:"50",height:"50",src:e.$hostname+"media"+e.photos[t.id][0].path}}):e._e(),a("div",{staticClass:"purchases-single__btns"},[a("v-btn",{attrs:{float:"",color:"primary"},on:{click:function(a){return e.$router.push({name:"PurchaseOpen",params:{id:t.id}})}}},[a("v-icon",[e._v("mdi-format-list-bulleted-square")])],1),-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("v-btn",{attrs:{float:"",color:"primary"},on:{click:function(a){e.formTitle="Редактирование",e.newPurchase=t,e.addForm=!0}}},[a("v-icon",[e._v("mdi-pencil")])],1):e._e(),-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("v-btn",{attrs:{float:"",color:"primary"},on:{click:function(a){e.currentPurchase=t.id,e.confirmDeleteDialog=!0}}},[a("v-icon",[e._v("mdi-delete")])],1):e._e()],1),a("ul",[a("li",[e._v("Способ оплаты: "+e._s(t.payment_method))]),a("li",[e._v("Налог: "+e._s(t.tax.tax))]),a("li",[e._v("Дата покупки: "+e._s(t.date))]),a("li",[e._v("Место покупки: "+e._s(t.place))]),a("li",[e._v("Категория: "+e._s(t.category.name))])])],1)]}))],2)],1),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"form",attrs:{model:e.newPurchase}},[e.$parent.$parent.admin?a("v-autocomplete",{attrs:{outlined:"",label:"Ответственный",items:e.users,"item-text":"label","item-value":"id"},model:{value:e.newPurchase.user_profile,callback:function(t){e.$set(e.newPurchase,"user_profile",t)},expression:"newPurchase.user_profile"}}):e._e(),a("v-row",[a("v-autocomplete",{attrs:{items:e.categories,"item-text":"name","item-value":"id",label:"Категория",rules:e.reqRules,required:"",outlined:""},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-title",[e._v(" Категория не найдена ")])],1)]},proxy:!0}]),model:{value:e.newPurchase.category,callback:function(t){e.$set(e.newPurchase,"category",t)},expression:"newPurchase.category"}}),a("v-autocomplete",{attrs:{items:e.taxes,"item-text":"tax","item-value":"id",label:"Налог",rules:e.reqRules,required:"",outlined:""},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-title",[e._v(" Налог не найден ")])],1)]},proxy:!0}]),model:{value:e.newPurchase.tax,callback:function(t){e.$set(e.newPurchase,"tax",t)},expression:"newPurchase.tax"}})],1),a("v-select",{attrs:{label:"Способ оплаты",items:["Банковская карта","Банковский перевод","Наличные"],outlined:""},model:{value:e.newPurchase.payment_method,callback:function(t){e.$set(e.newPurchase,"payment_method",t)},expression:"newPurchase.payment_method"}}),a("v-text-field",{attrs:{label:"Номер счета",rules:e.reqRules,required:"",outlined:""},model:{value:e.newPurchase.number,callback:function(t){e.$set(e.newPurchase,"number",t)},expression:"newPurchase.number"}}),a("v-row",[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата получения",readonly:"",outlined:""},model:{value:e.newPurchase.date_receipt,callback:function(t){e.$set(e.newPurchase,"date_receipt",t)},expression:"newPurchase.date_receipt"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.dateReceiptMenu,callback:function(t){e.$set(e.menus,"dateReceiptMenu",t)},expression:"menus.dateReceiptMenu"}},[a("v-date-picker",{on:{input:function(t){e.menus.dateReceiptMenu=!1}},model:{value:e.newPurchase.date_receipt,callback:function(t){e.$set(e.newPurchase,"date_receipt",t)},expression:"newPurchase.date_receipt"}})],1),a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата покупки",readonly:"",outlined:""},model:{value:e.newPurchase.date,callback:function(t){e.$set(e.newPurchase,"date",t)},expression:"newPurchase.date"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.dateMenu,callback:function(t){e.$set(e.menus,"dateMenu",t)},expression:"menus.dateMenu"}},[a("v-date-picker",{on:{input:function(t){e.menus.dateMenu=!1}},model:{value:e.newPurchase.date,callback:function(t){e.$set(e.newPurchase,"date",t)},expression:"newPurchase.date"}})],1)],1),a("v-text-field",{attrs:{label:"Место покупки",rules:e.reqRules,required:"",outlined:""},model:{value:e.newPurchase.place,callback:function(t){e.$set(e.newPurchase,"place",t)},expression:"newPurchase.place"}}),a("v-text-field",{attrs:{type:"number",label:"Сумма покупок",rules:e.numRules,required:"",outlined:""},model:{value:e.newPurchase.price,callback:function(t){e.$set(e.newPurchase,"price",t)},expression:"newPurchase.price"}}),a("v-select",{attrs:{label:"Набор чеков",items:["Один чек","2 и более"],outlined:""},model:{value:e.newPurchase.bundle,callback:function(t){e.$set(e.newPurchase,"bundle",t)},expression:"newPurchase.bundle"}}),"Добавление"===e.formTitle?a("v-file-input",{attrs:{multiple:"",counter:"",label:"Фото или документы",outlined:"","prepend-icon":""},model:{value:e.newPhotos,callback:function(t){e.newPhotos=t},expression:"newPhotos"}}):e._e(),a("v-textarea",{attrs:{label:"Заметки",outlined:""},model:{value:e.newPurchase.comment,callback:function(t){e.$set(e.newPurchase,"comment",t)},expression:"newPurchase.comment"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.addPurchase}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление чеков ")]),a("v-card-text",[e._v("Вы действительно хотите удалить выбранные чеки? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deletePurchase}},[e._v("Подтвердить")])],1)],1)],1)],1)},sn=[],rn=(a("4de4"),{name:"Purchases",components:{Header:R},data:function(){return{purchases:[],taxes:[],categories:[],users:[],photos:[],statistic:{count_categories:0,sum:0,by_categories:[]},newPurchase:{id:0,user_profile:"",date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),date_receipt:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),category:"",tax:"",payment_method:"",number:"",place:"",price:"",bundle:"",comment:""},newPhotos:"",currentPurchase:0,filter:{month:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,7)},menus:{filterMenu:!1,dateMenu:!1,dateReceiptMenu:!1},formTitle:"Добавление",addForm:!1,confirmDeleteDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}],numRules:[function(e){return e>=0||"Необходимо заполнить поле"}]}},created:function(){console.log("init Purchases"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),-1===this.$parent.$parent.read.indexOf("Бухгалтерия")&&this.$router.push({name:"Index"}),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadCategories(),this.loadTax(),this.loadActiveUsers()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/cheque/purchases",type:"GET",data:{year:this.filter.month.substr(0,4),month:this.filter.month.substr(5,2)},success:function(t){e.purchases=t.data.data,e.photos=t.data.photos,e.statistic=t.data.statistic},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadCategories:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/cheque/categories",type:"GET",success:function(t){e.categories=t.data.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadTax:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/accounting/taxes",type:"GET",success:function(t){e.taxes=t.data.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadActiveUsers:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/profiles/active",type:"GET",success:function(t){e.users=t.data.data,e.users.forEach((function(e){e.label=e.lastname+" "+e.name}))},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},addPurchase:function(){var e=this;this.$refs.form.validate()?0!==this.newPurchase.id?this.putPurchase():o.a.ajax({url:this.$hostname+"time-tracking/cheque/purchases",type:"POST",data:this.newPurchase,success:function(t){console.log("добавление покупки"),e.addChequeDocuments(t.data.id)},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}}):(this.alertMsg="Заполните все необходимые поля",this.alertError=!0)},addChequeDocuments:function(e){var t=this;console.log("добавление фото");var n=a("bc3a"),s=new FormData,i=0;this.newPhotos.forEach((function(e){i++,s.append("document"+i,e)})),s.append("sales",""),s.append("purchases",e),n({method:"post",url:this.$hostname+"time-tracking/cheque/documents",headers:{Authorization:"Token "+(sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token"))},data:s}).then((function(){t.loadData(),t.addForm=!1,t.newPurchase={id:0,user_profile:"",date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),date_receipt:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),category:"",tax:"",payment_method:"",number:"",place:"",price:"",bundle:"",comment:"",photo:""}}))},putPurchase:function(){var e=this;this.$refs.form.validate()?o.a.ajax({url:this.$hostname+"time-tracking/cheque/purchases",type:"PUT",data:this.newPurchase,success:function(){e.loadData(),e.addForm=!1,e.newPurchase={id:0,user_profile:"",date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),date_receipt:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),category:"",tax:"",payment_method:"",number:"",place:"",price:"",bundle:"",comment:"",photo:""}},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}}):(this.alertMsg="Заполните все необходимые поля",this.alertError=!0)},deletePurchase:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/cheque/purchases",type:"DELETE",data:{id:this.currentPurchase},success:function(){e.loadData(),e.confirmDeleteDialog=!1},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})}}}),on=rn,ln=(a("e7d2"),Object(m["a"])(on,nn,sn,!1,null,"729ee182",null)),cn=ln.exports;v()(ln,{VAutocomplete:Ha["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VDatePicker:at["a"],VDialog:H["a"],VFileInput:He["a"],VForm:ce["a"],VIcon:h["a"],VImg:p["a"],VListItem:g["a"],VListItemTitle:k["c"],VMenu:it["a"],VRow:rt["a"],VSelect:ot["a"],VSpacer:Qe["a"],VTextField:ue["a"],VTextarea:Q["a"],VToolbar:Ze["a"]});var un=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"purchases flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h1",[e._v("Покупки")]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.push({name:"Purchases"})}}},[a("span",[e._v("К списку чеков")]),a("back-icon")],1)]),a("div",{staticClass:"purchases__content"},[-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("div",{staticClass:"open__actions"},[a("div",{staticClass:"addition-btn",on:{click:function(t){e.addForm=!0}}},[a("edit-icon"),e._v(" Редактировать ")],1),a("div",{staticClass:"addition-btn",on:{click:function(t){e.confirmDeletePhotoDialog=!0}}},[a("waste-icon"),e._v(" Удалить ")],1)]):e._e(),a("div",[e._v("Ответственный: "+e._s(e.currentPurchase.user_profile.lastname)+" "+e._s(e.currentPurchase.user_profile.name))]),a("div",{staticClass:"document_date"},[e._v("Дата получения: "+e._s(e.currentPurchase.date_receipt))]),a("div",{staticClass:"document_date"},[e._v("Дата покупки: "+e._s(e.currentPurchase.date))]),a("div",[e._v("Категория: "+e._s(e.currentPurchase.category.name))]),a("div",[e._v("Налог: "+e._s(e.currentPurchase.tax.tax))]),a("div",[e._v("Способ оплаты: "+e._s(e.currentPurchase.payment_method))]),a("div",[e._v("Номер счета: "+e._s(e.currentPurchase.number))]),a("div",[e._v("Место покупки: "+e._s(e.currentPurchase.place))]),a("div",[e._v("Сумма покупки: "+e._s(e.currentPurchase.price))]),a("div",[e._v("Количество чеков: "+e._s(e.currentPurchase.bundle))]),a("div",[e._v("Заметки: "+e._s(e.currentPurchase.comment))]),a("div",{staticClass:"unit-title"},[a("h3",[e._v("Документы:")]),a("v-btn",{attrs:{color:"primary",fab:"","x-small":""},on:{click:function(t){e.addPhotoDialog=!0}}},[a("v-icon",[e._v("mdi-plus")])],1)],1),a("v-list",{staticClass:"documents"},[e._l(e.photos,(function(t){return[a("v-list-item",{key:t.id},[a("a",{on:{click:function(a){return e.downloadFile(t.path)}}},[e._v(e._s(t.path.substr(t.path.lastIndexOf("/")+1)))]),a("v-list-item-action",[a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:function(a){e.photoId=t.id,e.confirmDeletePhotoDialog=!0}}},[e._v(" mdi-close ")])],1)],1),"jpg"===t.path.substr(t.path.lastIndexOf(".")+1).toLowerCase()||"png"===t.path.substr(t.path.lastIndexOf(".")+1).toLowerCase()?a("v-img",{key:t.path,attrs:{width:"200",height:"200",src:e.$hostname+"media"+t.path}}):e._e()]}))],2)],1)]),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v("Редактирование")]),a("v-card-text",[a("v-form",{ref:"form",attrs:{model:e.currentPurchase}},[e.$parent.$parent.admin?a("v-autocomplete",{attrs:{outlined:"",label:"Ответственный",items:e.users,"item-text":"label","item-value":"id"},model:{value:e.currentPurchase.user_profile,callback:function(t){e.$set(e.currentPurchase,"user_profile",t)},expression:"currentPurchase.user_profile"}}):e._e(),a("v-row",[a("v-autocomplete",{attrs:{items:e.categories,"item-text":"name","item-value":"id",label:"Категория",rules:e.reqRules,required:"",outlined:""},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-title",[e._v(" Категория не найдена ")])],1)]},proxy:!0}]),model:{value:e.currentPurchase.category,callback:function(t){e.$set(e.currentPurchase,"category",t)},expression:"currentPurchase.category"}}),a("v-autocomplete",{attrs:{items:e.taxes,"item-text":"tax","item-value":"id",label:"Налог",rules:e.reqRules,required:"",outlined:""},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-title",[e._v(" Налог не найден ")])],1)]},proxy:!0}]),model:{value:e.currentPurchase.tax,callback:function(t){e.$set(e.currentPurchase,"tax",t)},expression:"currentPurchase.tax"}})],1),a("v-select",{attrs:{label:"Способ оплаты",items:["Банковская карта","Банковский перевод","Наличные"],outlined:""},model:{value:e.currentPurchase.payment_method,callback:function(t){e.$set(e.currentPurchase,"payment_method",t)},expression:"currentPurchase.payment_method"}}),a("v-text-field",{attrs:{label:"Номер счета",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentPurchase.number,callback:function(t){e.$set(e.currentPurchase,"number",t)},expression:"currentPurchase.number"}}),a("v-row",[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата получения",readonly:"",outlined:""},model:{value:e.currentPurchase.date_receipt,callback:function(t){e.$set(e.currentPurchase,"date_receipt",t)},expression:"currentPurchase.date_receipt"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.dateReceiptMenu,callback:function(t){e.$set(e.menus,"dateReceiptMenu",t)},expression:"menus.dateReceiptMenu"}},[a("v-date-picker",{on:{input:function(t){e.menus.dateReceiptMenu=!1}},model:{value:e.currentPurchase.date_receipt,callback:function(t){e.$set(e.currentPurchase,"date_receipt",t)},expression:"currentPurchase.date_receipt"}})],1),a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата покупки",readonly:"",outlined:""},model:{value:e.currentPurchase.date,callback:function(t){e.$set(e.currentPurchase,"date",t)},expression:"currentPurchase.date"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.dateMenu,callback:function(t){e.$set(e.menus,"dateMenu",t)},expression:"menus.dateMenu"}},[a("v-date-picker",{on:{input:function(t){e.menus.dateMenu=!1}},model:{value:e.currentPurchase.date,callback:function(t){e.$set(e.currentPurchase,"date",t)},expression:"currentPurchase.date"}})],1)],1),a("v-text-field",{attrs:{label:"Место покупки",rules:e.reqRules,required:"",outlined:""},model:{value:e.currentPurchase.place,callback:function(t){e.$set(e.currentPurchase,"place",t)},expression:"currentPurchase.place"}}),a("v-text-field",{attrs:{type:"number",label:"Сумма покупок",rules:e.numRules,required:"",outlined:""},model:{value:e.currentPurchase.price,callback:function(t){e.$set(e.currentPurchase,"price",t)},expression:"currentPurchase.price"}}),a("v-select",{attrs:{label:"Набор чеков",items:["Один чек","2 и более"],outlined:""},model:{value:e.currentPurchase.bundle,callback:function(t){e.$set(e.currentPurchase,"bundle",t)},expression:"currentPurchase.bundle"}}),a("v-textarea",{attrs:{label:"Заметки",outlined:""},model:{value:e.currentPurchase.comment,callback:function(t){e.$set(e.currentPurchase,"comment",t)},expression:"currentPurchase.comment"}})],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.putPurchase}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление чеков ")]),a("v-card-text",[e._v("Вы действительно хотите удалить выбранные чеки? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deletePurchase}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeletePhotoDialog,callback:function(t){e.confirmDeletePhotoDialog=t},expression:"confirmDeletePhotoDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление докуметов ")]),a("v-card-text",[e._v("Вы действительно хотите удалить выбранный документ? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeletePhotoDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteChequeDocument}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.addPhotoDialog,callback:function(t){e.addPhotoDialog=t},expression:"addPhotoDialog"}},[a("v-card",[a("v-card-title",[e._v(" Добавить документ ")]),a("v-card-text",[a("v-file-input",{attrs:{placeholder:"Документы",accept:"*",multiple:"",counter:"","prepend-icon":"",outlined:""},model:{value:e.newPhotos,callback:function(t){e.newPhotos=t},expression:"newPhotos"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.addPhotoDialog=!1,e.newPhotos=""}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.addChequeDocuments}},[e._v("Сохранить")])],1)],1)],1)],1)},dn=[],mn={name:"PurchaseOpen",components:{WasteIcon:De,EditIcon:Te,BackIcon:qe,Header:R},props:{id:[String,Number]},data:function(){return{taxes:[],categories:[],users:[],photos:[],currentPurchase:{id:0,user_profile:"",date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),date_receipt:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),category:"",tax:"",payment_method:"",number:"",place:"",price:"",bundle:"",comment:"",photo:""},photoId:0,menus:{dateMenu:!1,dateReceiptMenu:!1},newPhotos:"",addForm:!1,addPhotoDialog:!1,confirmDeleteDialog:!1,confirmDeletePhotoDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}],numRules:[function(e){return e>=0||"Необходимо заполнить поле"}]}},created:function(){console.log("init Purchases open"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),-1===this.$parent.$parent.read.indexOf("Бухгалтерия")&&this.$router.push({name:"Index"}),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadCategories(),this.loadTax(),this.loadActiveUsers()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/cheque/purchases/"+this.id,type:"GET",success:function(t){e.currentPurchase=t.data.data[0],e.photos=t.data.photos[e.id]},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadCategories:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/cheque/categories",type:"GET",success:function(t){e.categories=t.data.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadTax:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/accounting/taxes",type:"GET",success:function(t){e.taxes=t.data.data},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadActiveUsers:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/profiles/active",type:"GET",success:function(t){e.users=t.data.data,e.users.forEach((function(e){e.label=e.lastname+" "+e.name}))},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},addChequeDocuments:function(){var e=this,t=a("bc3a"),n=new FormData,s=0;this.newPhotos.forEach((function(e){s++,n.append("document"+s,e)})),n.append("sales",""),n.append("purchases",this.currentPurchase.id),t({method:"post",url:this.$hostname+"time-tracking/cheque/documents",headers:{Authorization:"Token "+(sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token"))},data:n}).then((function(){e.loadData(),e.addPhotoDialog=!1,e.newPhotos=""}))},putPurchase:function(){var e=this;this.$refs.form.validate()?o.a.ajax({url:this.$hostname+"time-tracking/cheque/purchases",type:"PUT",data:this.currentPurchase,success:function(){e.loadData(),e.addForm=!1},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}}):(this.alertMsg="Заполните все необходимые поля",this.alertError=!0)},deletePurchase:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/cheque/purchases",type:"DELETE",data:{id:this.id},success:function(){e.confirmDeleteDialog=!1,e.$router.push({name:"Purchases"})},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},deleteChequeDocument:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/cheque/documents",type:"DELETE",data:{id:this.photoId},success:function(){e.loadData(),e.confirmDeletePhotoDialog=!1},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},downloadFile:function(e){console.log(this.$hostname+"media"+e);var t=a("bc3a");t({url:this.$hostname+"media"+e,method:"GET",responseType:"blob"}).then((function(t){var a=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=a,n.setAttribute("download",e),document.body.appendChild(n),n.click()}))}}},fn=mn,vn=Object(m["a"])(fn,un,dn,!1,null,"968ec4ea",null),hn=vn.exports;v()(vn,{VAutocomplete:Ha["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VDatePicker:at["a"],VDialog:H["a"],VFileInput:He["a"],VForm:ce["a"],VIcon:h["a"],VImg:p["a"],VList:_["a"],VListItem:g["a"],VListItemAction:st["a"],VListItemTitle:k["c"],VMenu:it["a"],VRow:rt["a"],VSelect:ot["a"],VSpacer:Qe["a"],VTextField:ue["a"],VTextarea:Q["a"],VToolbar:Ze["a"]});var pn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"purchases flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("h1",[e._v("Продажи")]),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.openAddForm}},[e._v(" Добавить ")]),a("v-menu",{ref:"filterMenu",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Месяц","prepend-icon":"mdi-calendar",readonly:"",outlined:""},model:{value:e.filter.month,callback:function(t){e.$set(e.filter,"month",t)},expression:"filter.month"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.filterMenu,callback:function(t){e.$set(e.menus,"filterMenu",t)},expression:"menus.filterMenu"}},[a("v-date-picker",{attrs:{type:"month",max:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),min:"1950-01-01"},on:{change:function(t){e.$refs.filterMenu.save(e.filter.month),e.loadData()}},model:{value:e.filter.month,callback:function(t){e.$set(e.filter,"month",t)},expression:"filter.month"}})],1),a("div",{staticClass:"sales__content"},[a("div",[a("h3",[e._v("Статистика")]),a("div",[e._v("Счетов за месяц: "+e._s(e.sales.length))]),a("div",[e._v("Клиентов: "+e._s(e.statistic.count_clients))]),a("div",[e._v("Сумма без налога "+e._s(e.statistic.sum))]),a("div",[e._v("Сумма с налогом "+e._s(e.statistic.sum_tax))])]),e._l(e.sales,(function(t){return[a("div",{key:t.id,staticClass:"purchases-single"},[0!==e.photos[t.id].length?a("v-img",{attrs:{width:"50",height:"50",src:e.$hostname+"media"+e.photos[t.id][0].path}}):e._e(),a("div",{staticClass:"purchases-single__btns"},[a("v-btn",{attrs:{float:"",color:"primary"},on:{click:function(a){return e.$router.push({name:"SalesOpen",params:{id:t.id}})}}},[a("v-icon",[e._v("mdi-format-list-bulleted-square")])],1),-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("v-btn",{attrs:{float:"",color:"primary"},on:{click:function(a){return e.openEditForm(t)}}},[a("v-icon",[e._v("mdi-pencil")])],1):e._e(),-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("v-btn",{attrs:{float:"",color:"primary"},on:{click:function(a){e.currentSale=t.id,e.confirmDeleteDialog=!0}}},[a("v-icon",[e._v("mdi-delete")])],1):e._e()],1),a("ul",[a("li",[e._v("Клиент: "+e._s(t.client.name))]),a("li",[e._v("Объект: "+e._s(t.object_number))]),a("li",[e._v("Дата создания: "+e._s(t.create_date))]),a("li",[e._v("Статус: "+e._s(t.status))])])],1)]}))],2)],1),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"form",attrs:{model:e.newSale}},[a("v-text-field",{attrs:{label:"Номер квитанции",disabled:""},model:{value:e.newSale.id,callback:function(t){e.$set(e.newSale,"id",t)},expression:"newSale.id"}}),a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата",readonly:"",outlined:""},model:{value:e.newSale.create_date,callback:function(t){e.$set(e.newSale,"create_date",t)},expression:"newSale.create_date"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.dateMenu,callback:function(t){e.$set(e.menus,"dateMenu",t)},expression:"menus.dateMenu"}},[a("v-date-picker",{on:{input:function(t){e.menus.dateMenu=!1}},model:{value:e.newSale.create_date,callback:function(t){e.$set(e.newSale,"create_date",t)},expression:"newSale.create_date"}})],1),a("v-row",[a("v-autocomplete",{attrs:{items:e.clients,"item-text":"name","item-value":"id",label:"Клиент",rules:e.reqRules,required:"",outlined:""},on:{change:e.loadObjectsByCLient},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-title",[e._v(" Клиенты не найдены ")])],1)]},proxy:!0}]),model:{value:e.newSale.client,callback:function(t){e.$set(e.newSale,"client",t)},expression:"newSale.client"}}),a("v-autocomplete",{attrs:{items:e.objects,"item-text":"label","item-value":"id",label:"Объект",rules:e.reqRules,required:"",outlined:""},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[""===e.newSale.client.name?a("v-list-item-title",[e._v(" Выберите клиента ")]):a("v-list-item-title",[e._v(" Объекты не найдены ")])],1)]},proxy:!0}]),model:{value:e.newSale.object,callback:function(t){e.$set(e.newSale,"object",t)},expression:"newSale.object"}})],1),a("v-text-field",{attrs:{label:"Номер объекта",outlined:""},model:{value:e.newSale.object_number,callback:function(t){e.$set(e.newSale,"object_number",t)},expression:"newSale.object_number"}}),a("v-select",{attrs:{label:"Срок оплаты",items:e.terms,"item-value":"id","item-text":"days",outlined:""},model:{value:e.newSale.payment_terms,callback:function(t){e.$set(e.newSale,"payment_terms",t)},expression:"newSale.payment_terms"}}),a("v-text-field",{attrs:{label:"Номер ссылки",outlined:""},model:{value:e.newSale.number_link,callback:function(t){e.$set(e.newSale,"number_link",t)},expression:"newSale.number_link"}}),"Добавление"===e.formTitle?a("v-file-input",{attrs:{multiple:"",counter:"",label:"Фото или документы",outlined:"","prepend-icon":""},model:{value:e.newPhotos,callback:function(t){e.newPhotos=t},expression:"newPhotos"}}):e._e(),"Редактирование"===e.formTitle?a("v-select",{attrs:{label:"Статус",items:["Выставлен","Оплачен"],outlined:""},model:{value:e.newSale.status,callback:function(t){e.$set(e.newSale,"status",t)},expression:"newSale.status"}}):e._e(),a("v-row",[a("v-col",{attrs:{cols:"11"}},[a("h3",[e._v("Товары/услуги")])]),a("v-col",{attrs:{cols:"1"}},[a("v-btn",{attrs:{color:"primary",fab:"","x-small":""},on:{click:e.addNewItem}},[a("v-icon",[e._v("mdi-plus")])],1)],1)],1),e._l(e.itemsQuantity,(function(t){return[a("div",{key:t},[a("v-row",[a("v-col",{attrs:{cols:"1"}},[a("strong",{staticStyle:{"font-size":"20px"}},[e._v(e._s(t))])]),a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"Название",rules:e.reqRules,outlined:""},model:{value:e.newItems[t-1].name,callback:function(a){e.$set(e.newItems[t-1],"name",a)},expression:"newItems[i-1].name"}})],1),a("v-col",{attrs:{cols:"1"}},[a("v-btn",{attrs:{icon:""},on:{click:function(a){return e.deleteNewItem(t)}}},[a("v-icon",[e._v("mdi-close")])],1)],1)],1),a("v-row",[a("v-col",[a("v-text-field",{attrs:{type:"number",label:"Стоимость без налога",rules:e.reqRules,outlined:""},model:{value:e.newItems[t-1].price,callback:function(a){e.$set(e.newItems[t-1],"price",a)},expression:"newItems[i-1].price"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{type:"number",label:"Налог",rules:e.reqRules,outlined:""},model:{value:e.newItems[t-1].tax,callback:function(a){e.$set(e.newItems[t-1],"tax",a)},expression:"newItems[i-1].tax"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-text-field",{attrs:{type:"number",label:"Стоимость с налогом",outlined:"",disabled:""},domProps:{textContent:e._s((e.newItems[t-1].price*(1+e.newItems[t-1].tax/100)).toFixed(2))}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"Скидка",outlined:""},model:{value:e.newItems[t-1].discount,callback:function(a){e.$set(e.newItems[t-1],"discount",a)},expression:"newItems[i-1].discount"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-text-field",{attrs:{type:"number",label:"Стоимость со скидкой",outlined:"",disabled:""},domProps:{textContent:e._s((e.newItems[t-1].price*(1+e.newItems[t-1].tax/100)*(1-e.newItems[t-1].discount/100)).toFixed(2))}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"6"}},[a("v-text-field",{attrs:{type:"number",label:"Количество",outlined:"",rules:e.reqRules},model:{value:e.newItems[t-1].quantity,callback:function(a){e.$set(e.newItems[t-1],"quantity",a)},expression:"newItems[i-1].quantity"}})],1),a("v-col",{attrs:{cols:"6"}},[a("v-text-field",{attrs:{label:"Единицы измерения",outlined:"",rules:e.reqRules},model:{value:e.newItems[t-1].measurement,callback:function(a){e.$set(e.newItems[t-1],"measurement",a)},expression:"newItems[i-1].measurement"}})],1)],1)],1)]})),a("v-textarea",{attrs:{label:"Пояснение к счету",outlined:""},model:{value:e.newSale.description,callback:function(t){e.$set(e.newSale,"description",t)},expression:"newSale.description"}}),a("v-textarea",{attrs:{label:"Заметки",outlined:""},model:{value:e.newSale.comment,callback:function(t){e.$set(e.newSale,"comment",t)},expression:"newSale.comment"}})],2),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.addSale}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление чеков ")]),a("v-card-text",[e._v("Вы действительно хотите удалить выбранные чеки? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteSale}},[e._v("Подтвердить")])],1)],1)],1)],1)},_n=[],bn=a("53ca"),gn=(a("a434"),{name:"Sales",components:{Header:R},data:function(){return{sales:[],clients:[],objects:[],terms:[],items:[],photos:[],statistic:{count_clients:0,sum:0,sum_tax:0},newSale:{id:0,client:{name:""},create_date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),object_number:"",object:{},payment_terms:"",number_link:"",description:"",comment:"",status:"Выставлен"},newPhotos:null,itemsQuantity:0,newItems:[],deletedItems:[],currentSale:0,filter:{month:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,7)},menus:{filterMenu:!1,dateMenu:!1},edit:!1,formTitle:"Добавление",addForm:!1,confirmDeleteDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}],numRules:[function(e){return e>=0||"Необходимо заполнить поле"}]}},created:function(){console.log("init Sales"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),-1===this.$parent.$parent.read.indexOf("Бухгалтерия")&&this.$router.push({name:"Index"}),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadClients(),this.loadTerms()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/cheque/sales",type:"GET",data:{year:this.filter.month.substr(0,4),month:this.filter.month.substr(5,2)},success:function(t){e.sales=t.data.data,e.photos=t.data.photos,e.items=t.data.items,e.statistic=t.data.statistic,e.sales.forEach((function(e){e.object.label=e.object.city+" "+e.object.street+" "+e.object.house})),0!==e.sales.length?e.newSale.id=e.sales[0].id+1:e.newSale.id=1e4},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadClients:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"GET",success:function(t){e.clients=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadTerms:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/accounting/terms",type:"GET",success:function(t){e.terms=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadObjectsByCLient:function(){var e,t=this;e="object"===Object(bn["a"])(this.newSale.client)?this.newSale.client.id:this.newSale.client,o.a.ajax({url:this.$hostname+"time-tracking/objects/"+e,type:"GET",success:function(e){t.objects=e.data.data,t.objects.forEach((function(e){e.label=e.city+" "+e.street+" "+e.house}))},error:function(e){switch(e.status){case 500:t.alertMsg="Ошибка соединения с сервером";break;case 400:t.alertMsg="Ошибка в данных";break;case 401:t.$refresh();break;case 403:t.alertMsg="Нет доступа";break;default:t.alertMsg="Непредвиденная ошибка"}t.alertError=!0}})},addSale:function(){var e=this;this.$refs.form.validate()?this.edit?this.putSale():(this.newSale.items=JSON.stringify(this.newItems),o.a.ajax({url:this.$hostname+"time-tracking/cheque/sales",type:"POST",data:this.newSale,success:function(t){e.newPhotos.length>0?e.addChequeDocuments(t.data.id):(e.loadData(),e.addForm=!1)},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})):(this.alertMsg="Заполните все необходимые поля",this.alertError=!0)},addChequeDocuments:function(e){var t=this;console.log("Добавление фото");var n=a("bc3a"),s=new FormData,i=0;this.newPhotos.forEach((function(e){i++,s.append("document"+i,e)})),s.append("sales",e),s.append("purchases",""),n({method:"post",url:this.$hostname+"time-tracking/cheque/documents",headers:{Authorization:"Token "+(sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token"))},data:s}).then((function(){t.loadData(),t.addForm=!1}))},putSale:function(){var e=this;this.newSale.items=JSON.stringify(this.newItems),o.a.ajax({url:this.$hostname+"time-tracking/cheque/sales",type:"PUT",data:this.newSale,success:function(){e.putItems(),null!==e.newPhotos?e.addChequeDocuments(e.newSale.id):(e.loadData(),e.addForm=!1)},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},putItems:function(){var e=this;this.newItems.forEach((function(t){void 0!==t.id&&o.a.ajax({url:e.$hostname+"time-tracking/item",type:"PUT",data:t,success:function(){console.log("товар отредактирован")},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})})),this.deletedItems.forEach((function(t){e.deleteItem(t)}))},deleteSale:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/cheque/sales",type:"DELETE",data:{id:this.currentSale},success:function(){e.loadData(),e.confirmDeleteDialog=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},deleteItem:function(e){var t=this;o.a.ajax({url:this.$hostname+"time-tracking/item",type:"DELETE",data:{sale_id:this.newSale.id,id:e.id},success:function(){console.log("товар удален")},error:function(e){switch(e.status){case 500:t.alertMsg="Ошибка соединения с сервером";break;case 400:t.alertMsg="Ошибка в данных";break;case 401:t.$refresh();break;case 403:t.alertMsg="Нет доступа";break;default:t.alertMsg="Непредвиденная ошибка"}t.alertError=!0}})},addNewItem:function(){this.itemsQuantity+=1,this.newItems.push({name:"",price:"",tax:"",discount:"",quantity:"",measurement:""})},deleteNewItem:function(e){void 0!==this.newItems[e-1].id&&this.deletedItems.push(this.newItems[e-1]),this.itemsQuantity=this.itemsQuantity-1,this.newItems.splice(e-1,1)},openAddForm:function(){this.formTitle="Добавление",this.edit=!1,this.addForm=!0,this.itemsQuantity=0,this.newItems=[],this.newPhotos=null,this.newSale={id:0,client:{name:""},create_date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),object_number:"",object:"",payment_terms:"",number_link:"",description:"",comment:""},0!==this.sales.length?this.newSale.id=this.sales[0].id+1:this.newSale.id=1e4},openEditForm:function(e){this.newSale=e,this.loadObjectsByCLient(),this.itemsQuantity=this.items[e.id].length,this.newItems=this.items[e.id],this.formTitle="Редактирование",this.edit=!0,this.addForm=!0}}}),kn=gn,wn=(a("fc28"),a("62ad")),xn=Object(m["a"])(kn,pn,_n,!1,null,"36646482",null),Cn=xn.exports;v()(xn,{VAlert:te["a"],VAutocomplete:Ha["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCol:wn["a"],VDatePicker:at["a"],VDialog:H["a"],VFileInput:He["a"],VForm:ce["a"],VIcon:h["a"],VImg:p["a"],VListItem:g["a"],VListItemTitle:k["c"],VMenu:it["a"],VRow:rt["a"],VSelect:ot["a"],VSpacer:Qe["a"],VTextField:ue["a"],VTextarea:Q["a"],VToolbar:Ze["a"]});var yn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"purchases flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h1",[e._v("Продажи")]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.push({name:"Sales"})}}},[a("span",[e._v("К списку чеков")]),a("back-icon")],1)]),a("div",{staticClass:"purchases__content"},[-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("div",{staticClass:"open__actions"},[a("div",{staticClass:"addition-btn",on:{click:function(t){e.addForm=!0}}},[a("edit-icon"),e._v(" Редактировать ")],1),a("div",{staticClass:"addition-btn",on:{click:function(t){e.confirmDeletePhotoDialog=!0}}},[a("waste-icon"),e._v(" Удалить ")],1)]):e._e(),a("div",[e._v("Номер счета: "+e._s(e.currentSale.id+9999))]),a("div",{staticClass:"document_date"},[e._v("Дата создания: "+e._s(e.currentSale.create_date))]),a("div",{staticClass:"document_date"},[e._v("Клиент: "+e._s(e.currentSale.client.name))]),a("div",[e._v("Объект: "+e._s(e.currentSale.object.city)+" "+e._s(e.currentSale.object.street)+" "+e._s(e.currentSale.object.house))]),a("div",[e._v("Номер объекта: "+e._s(e.currentSale.object_number))]),a("div",[e._v("Срок оплаты: "+e._s(e.currentSale.payment_terms.days)+" дней")]),a("div",[e._v("Номер ссылки: "+e._s(e.currentSale.number_link))]),a("div",[e._v("Пояснение: "+e._s(e.currentSale.description))]),a("div",[e._v("Заметки: "+e._s(e.currentSale.comment))]),a("div",{staticClass:"unit-title"},[a("h3",[e._v("Документы:")]),a("v-btn",{attrs:{color:"primary",fab:"","x-small":""},on:{click:function(t){e.addPhotoDialog=!0}}},[a("v-icon",[e._v("mdi-plus")])],1)],1),a("v-list",{staticClass:"documents"},[e._l(e.photos,(function(t){return[a("v-list-item",{key:t.id},[a("a",{on:{click:function(a){return e.downloadFile(t.path)}}},[e._v(e._s(t.path.substr(t.path.lastIndexOf("/")+1)))]),a("v-list-item-action",[a("v-icon",{attrs:{color:"grey lighten-1"},on:{click:function(a){e.photoId=t.id,e.confirmDeletePhotoDialog=!0}}},[e._v(" mdi-close ")])],1)],1),"jpg"===t.path.substr(t.path.lastIndexOf(".")+1).toLowerCase()||"png"===t.path.substr(t.path.lastIndexOf(".")+1).toLowerCase()?a("v-img",{key:t.path,attrs:{width:"200",height:"200",src:e.$hostname+"media"+t.path}}):e._e()]}))],2),a("h3",[e._v("Товары:")]),a("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[e._v("№")]),a("th",{staticClass:"text-left"},[e._v("Название")]),a("th",{staticClass:"text-left"},[e._v("Стоимость без налога")]),a("th",{staticClass:"text-left"},[e._v("Налог")]),a("th",{staticClass:"text-left"},[e._v("Стоимость")]),a("th",{staticClass:"text-left"},[e._v("Скидка")]),a("th",{staticClass:"text-left"},[e._v("Количество")]),a("th",{staticClass:"text-left"},[e._v("Единицы измерения")]),a("th",{staticClass:"text-left"},[e._v("Итого")])])]),a("tfoot",[a("tr",[a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"},[e._v("Итого")]),a("th",{staticClass:"text-left"},[e._v(e._s(e.sum.price.toFixed(2)))])]),a("tr",[a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"},[e._v("Итого с налогом")]),a("th",{staticClass:"text-left"},[e._v(e._s(e.sum.tax.toFixed(2)))])]),a("tr",[a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"},[e._v("Итого со скидкой")]),a("th",{staticClass:"text-left"},[e._v(e._s(e.sum.discount.toFixed(2)))])])]),a("tbody",e._l(e.items,(function(t,n){return a("tr",{key:t.name},[a("td",[e._v(e._s(n+1))]),a("td",[e._v(e._s(t.name))]),a("td",[e._v(e._s(t.price))]),a("td",[e._v(e._s(t.tax))]),a("td",[e._v(e._s((t.price*(1+t.tax/100)).toFixed(2)))]),a("td",[e._v(e._s(t.discount))]),a("td",[e._v(e._s(t.quantity))]),a("td",[e._v(e._s(t.measurement))]),a("td",[e._v(e._s((t.price*(1+t.tax/100)*(1-t.discount/100)*t.quantity).toFixed(2)))])])})),0)]},proxy:!0}])})],1)]),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v("Редактирование")]),a("v-card-text",[a("v-form",{ref:"form",attrs:{model:e.currentSale}},[a("v-text-field",{attrs:{label:"Номер квитанции",disabled:""},model:{value:e.currentSale.id,callback:function(t){e.$set(e.currentSale,"id",t)},expression:"currentSale.id"}}),a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата",readonly:"",outlined:""},model:{value:e.currentSale.create_date,callback:function(t){e.$set(e.currentSale,"create_date",t)},expression:"currentSale.create_date"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.dateMenu,callback:function(t){e.$set(e.menus,"dateMenu",t)},expression:"menus.dateMenu"}},[a("v-date-picker",{on:{input:function(t){e.menus.dateMenu=!1}},model:{value:e.currentSale.create_date,callback:function(t){e.$set(e.currentSale,"create_date",t)},expression:"currentSale.create_date"}})],1),a("v-row",[a("v-autocomplete",{attrs:{items:e.clients,"item-text":"name","item-value":"id",label:"Клиент",rules:e.reqRules,required:"",outlined:""},on:{change:e.loadObjectsByCLient},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-title",[e._v(" Клиенты не найдены ")])],1)]},proxy:!0}]),model:{value:e.currentSale.client,callback:function(t){e.$set(e.currentSale,"client",t)},expression:"currentSale.client"}}),a("v-autocomplete",{attrs:{items:e.objects,"item-text":"label","item-value":"id",label:"Объект",rules:e.reqRules,required:"",outlined:""},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[""===e.currentSale.client.name?a("v-list-item-title",[e._v(" Выберите клиента ")]):a("v-list-item-title",[e._v(" Объекты не найдены ")])],1)]},proxy:!0}]),model:{value:e.currentSale.object,callback:function(t){e.$set(e.currentSale,"object",t)},expression:"currentSale.object"}})],1),a("v-text-field",{attrs:{label:"Номер объекта",required:"",outlined:""},model:{value:e.currentSale.object_number,callback:function(t){e.$set(e.currentSale,"object_number",t)},expression:" currentSale.object_number\n                  "}}),a("v-select",{attrs:{label:"Срок оплаты",items:e.terms,"item-value":"id","item-text":"days",outlined:""},model:{value:e.currentSale.payment_terms,callback:function(t){e.$set(e.currentSale,"payment_terms",t)},expression:"currentSale.payment_terms"}}),a("v-text-field",{attrs:{label:"Номер ссылки",required:"",outlined:""},model:{value:e.currentSale.number_link,callback:function(t){e.$set(e.currentSale,"number_link",t)},expression:"currentSale.number_link"}}),a("v-row",[a("v-col",{attrs:{cols:"11"}},[a("h3",[e._v("Товары/услуги")])]),a("v-col",{attrs:{cols:"1"}},[a("v-btn",{attrs:{color:"primary",fab:"","x-small":""},on:{click:e.addNewItem}},[a("v-icon",[e._v("mdi-plus")])],1)],1)],1),e._l(e.itemsQuantity,(function(t){return[a("div",{key:t},[a("v-row",[a("v-col",{attrs:{cols:"1"}},[a("strong",{staticStyle:{"font-size":"20px"}},[e._v(e._s(t))])]),a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"Название",rules:e.reqRules,outlined:""},model:{value:e.newItems[t-1].name,callback:function(a){e.$set(e.newItems[t-1],"name",a)},expression:"newItems[i-1].name"}})],1),a("v-col",{attrs:{cols:"1"}},[a("v-btn",{attrs:{icon:""},on:{click:function(a){return e.deleteNewItem(t)}}},[a("v-icon",[e._v("mdi-close")])],1)],1)],1),a("v-row",[a("v-col",[a("v-text-field",{attrs:{type:"number",label:"Стоимость без налога",rules:e.reqRules,outlined:""},model:{value:e.newItems[t-1].price,callback:function(a){e.$set(e.newItems[t-1],"price",a)},expression:"newItems[i-1].price"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{type:"number",label:"Налог",rules:e.reqRules,outlined:""},model:{value:e.newItems[t-1].tax,callback:function(a){e.$set(e.newItems[t-1],"tax",a)},expression:"newItems[i-1].tax"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-text-field",{attrs:{type:"number",label:"Стоимость с налогом",outlined:"",disabled:""},domProps:{textContent:e._s((e.newItems[t-1].price*(1+e.newItems[t-1].tax/100)).toFixed(2))}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"Скидка",outlined:""},model:{value:e.newItems[t-1].discount,callback:function(a){e.$set(e.newItems[t-1],"discount",a)},expression:"newItems[i-1].discount"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-text-field",{attrs:{type:"number",label:"Стоимость со скидкой",outlined:"",disabled:""},domProps:{textContent:e._s((e.newItems[t-1].price*(1+e.newItems[t-1].tax/100)*(1-e.newItems[t-1].discount/100)).toFixed(2))}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"6"}},[a("v-text-field",{attrs:{type:"number",label:"Количество",outlined:"",rules:e.reqRules},model:{value:e.newItems[t-1].quantity,callback:function(a){e.$set(e.newItems[t-1],"quantity",a)},expression:"newItems[i-1].quantity"}})],1),a("v-col",{attrs:{cols:"6"}},[a("v-text-field",{attrs:{label:"Единицы измерения",outlined:"",rules:e.reqRules},model:{value:e.newItems[t-1].measurement,callback:function(a){e.$set(e.newItems[t-1],"measurement",a)},expression:"newItems[i-1].measurement"}})],1)],1)],1)]})),a("v-textarea",{attrs:{label:"Пояснение к счету",outlined:""},model:{value:e.currentSale.description,callback:function(t){e.$set(e.currentSale,"description",t)},expression:"currentSale.description"}}),a("v-textarea",{attrs:{label:"Заметки",outlined:""},model:{value:e.currentSale.comment,callback:function(t){e.$set(e.currentSale,"comment",t)},expression:"currentSale.comment"}})],2)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.putSale}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление чеков ")]),a("v-card-text",[e._v("Вы действительно хотите удалить выбранные чеки? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteSale}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.addPhotoDialog,callback:function(t){e.addPhotoDialog=t},expression:"addPhotoDialog"}},[a("v-card",[a("v-card-title",[e._v(" Добавить документ ")]),a("v-card-text",[a("v-file-input",{attrs:{placeholder:"Документы",accept:"*",multiple:"",counter:"","prepend-icon":"",outlined:""},model:{value:e.newPhotos,callback:function(t){e.newPhotos=t},expression:"newPhotos"}})],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.addPhotoDialog=!1,e.newPhotos=""}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.addChequeDocuments}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeletePhotoDialog,callback:function(t){e.confirmDeletePhotoDialog=t},expression:"confirmDeletePhotoDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление докуметов ")]),a("v-card-text",[e._v("Вы действительно хотите удалить выбранный документ? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeletePhotoDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteChequeDocument}},[e._v("Подтвердить")])],1)],1)],1)],1)},$n=[],Dn={name:"SalesOpen",components:{WasteIcon:De,EditIcon:Te,Header:R,BackIcon:qe},props:{id:[String,Number]},data:function(){return{clients:[],objects:[],terms:[],items:[],photos:[],currentSale:{id:0,client:{id:"",name:""},create_date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),object_number:"",object:{city:"",street:"",house:""},payment_terms:"",number_link:"",description:"",comment:"",items:[1]},sum:{price:0,tax:0,discount:0},photoId:0,menus:{dateMenu:!1},newPhotos:null,newItems:[],deletedItems:[],itemsQuantity:0,addForm:!1,addPhotoDialog:!1,confirmDeleteDialog:!1,confirmDeletePhotoDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}],numRules:[function(e){return e>=0||"Необходимо заполнить поле"}]}},created:function(){console.log("init Sales open"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),-1===this.$parent.$parent.read.indexOf("Бухгалтерия")&&this.$router.push({name:"Index"}),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadClients(),this.loadTerms()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/cheque/sales/"+this.id,type:"GET",success:function(t){e.currentSale=t.data.data[0],e.photos=t.data.photos[e.id],e.items=t.data.items[e.id],e.newItems=t.data.items[e.id],e.itemsQuantity=t.data.items[e.id].length,e.currentSale.object.label=e.currentSale.object.city+" "+e.currentSale.object.street+" "+e.currentSale.object.house,e.sum={price:0,tax:0,discount:0},e.items.forEach((function(t){e.sum.price+=t.price*t.quantity,e.sum.tax+=t.price*(1+t.tax/100)*t.quantity,e.sum.discount+=t.price*(1+t.tax/100)*(1-t.discount/100)*t.quantity})),e.loadObjectsByCLient()},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadClients:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"GET",success:function(t){e.clients=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadTerms:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/accounting/terms",type:"GET",success:function(t){e.terms=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadObjectsByCLient:function(){var e=this,t="";t=this.currentSale.client.id?this.$hostname+"time-tracking/objects/"+this.currentSale.client.id:this.$hostname+"time-tracking/objects/"+this.currentSale.client,o.a.ajax({url:t,type:"GET",success:function(t){e.objects=t.data.data,e.objects.forEach((function(e){e.label=e.city+" "+e.street+" "+e.house}))},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},addChequeDocuments:function(){var e=this,t=a("bc3a"),n=new FormData,s=0;this.newPhotos.forEach((function(e){s++,n.append("document"+s,e)})),n.append("sales",this.currentSale.id),n.append("purchases",""),t({method:"post",url:this.$hostname+"time-tracking/cheque/documents",headers:{Authorization:"Token "+(sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token"))},data:n}).then((function(){e.loadData(),e.addPhotoDialog=!1,e.newPhotos=""}))},putSale:function(){var e=this;this.currentSale.items=JSON.stringify(this.newItems),o.a.ajax({url:this.$hostname+"time-tracking/cheque/sales",type:"PUT",data:this.currentSale,success:function(){e.putItems(),null!==e.newPhotos?e.addChequeDocuments(e.currentSale.id):(e.loadData(),e.addForm=!1)},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},putItems:function(){var e=this;this.newItems.forEach((function(t){void 0!==t.id&&o.a.ajax({url:e.$hostname+"time-tracking/item",type:"PUT",data:t,success:function(){console.log("товар отредактирован")},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})})),this.deletedItems.forEach((function(t){e.deleteItem(t)}))},deleteSale:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/cheque/sales",type:"DELETE",data:{id:this.id},success:function(){e.confirmDeleteDialog=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},deleteItem:function(e){var t=this;o.a.ajax({url:this.$hostname+"time-tracking/item",type:"DELETE",data:{sale_id:this.newSale.id,id:e.id},success:function(){console.log("товар удален")},error:function(e){switch(e.status){case 500:t.alertMsg="Ошибка соединения с сервером";break;case 400:t.alertMsg="Ошибка в данных";break;case 401:t.$refresh();break;case 403:t.alertMsg="Нет доступа";break;default:t.alertMsg="Непредвиденная ошибка"}t.alertError=!0}})},deleteChequeDocument:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/cheque/documents",type:"DELETE",data:{id:this.photoId},success:function(){e.loadData(),e.confirmDeletePhotoDialog=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},downloadFile:function(e){console.log(this.$hostname+"media"+e);var t=a("bc3a");t({url:this.$hostname+"media"+e,method:"GET",responseType:"blob"}).then((function(t){var a=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=a,n.setAttribute("download",e),document.body.appendChild(n),n.click()}))},addNewItem:function(){this.itemsQuantity+=1,this.newItems.push({name:"",price:"",tax:"",discount:"",quantity:"",measurement:""})},deleteNewItem:function(e){void 0!==this.newItems[e-1].id&&this.deletedItems.push(this.newItems[e-1]),this.itemsQuantity=this.itemsQuantity-1,this.newItems.splice(e-1,1)}}},Pn=Dn,En=a("1f4f"),Mn=Object(m["a"])(Pn,yn,$n,!1,null,"4e232040",null),In=Mn.exports;v()(Mn,{VAutocomplete:Ha["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCol:wn["a"],VDatePicker:at["a"],VDialog:H["a"],VFileInput:He["a"],VForm:ce["a"],VIcon:h["a"],VImg:p["a"],VList:_["a"],VListItem:g["a"],VListItemAction:st["a"],VListItemTitle:k["c"],VMenu:it["a"],VRow:rt["a"],VSelect:ot["a"],VSimpleTable:En["a"],VSpacer:Qe["a"],VTextField:ue["a"],VTextarea:Q["a"],VToolbar:Ze["a"]});var Sn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"offers flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("h1",[e._v("Ценовые предложения")]),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(t){e.formTitle="Добавление",e.addForm=!0}}},[e._v("Добавить")]),a("div",{staticClass:"offers__content"},[e._l(e.offers,(function(t){return[a("div",{key:t.id,staticClass:"offers-single"},[a("div",{staticClass:"purchases-single__btns"},[a("v-btn",{attrs:{float:"",color:"primary"},on:{click:function(a){return e.$router.push({name:"OffersOpen",params:{id:t.id}})}}},[a("v-icon",[e._v("mdi-format-list-bulleted-square")])],1),-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("v-btn",{attrs:{float:"",color:"primary"},on:{click:function(a){return e.openEditForm(t)}}},[a("v-icon",[e._v("mdi-pencil")])],1):e._e(),-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("v-btn",{attrs:{float:"",color:"primary"},on:{click:function(a){e.currentOffer=t.id,e.confirmDeleteDialog=!0}}},[a("v-icon",[e._v("mdi-delete")])],1):e._e()],1),a("ul",[a("li",[e._v("Дата создания: "+e._s(t.create_date))]),a("li",[e._v("Клиент: "+e._s(t.client.name))]),a("li",[e._v("Срок: "+e._s(t.term.days)+" дней")])])])]}))],2)],1),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"form",attrs:{model:e.newOffer}},[a("v-row",[a("v-autocomplete",{attrs:{items:e.clients,"item-text":"name","item-value":"id",label:"Клиент",rules:e.reqRules,required:"",outlined:""},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-title",[e._v(" Клиенты не найдены ")])],1)]},proxy:!0}]),model:{value:e.newOffer.client,callback:function(t){e.$set(e.newOffer,"client",t)},expression:"newOffer.client"}}),a("v-autocomplete",{attrs:{items:e.terms,"item-text":"days","item-value":"id",label:"Срок предложения",rules:e.reqRules,required:"",outlined:""},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-title",[e._v(" Сроки не найдены ")])],1)]},proxy:!0}]),model:{value:e.newOffer.term,callback:function(t){e.$set(e.newOffer,"term",t)},expression:"newOffer.term"}})],1),a("v-row",[a("v-col",{attrs:{cols:"11"}},[a("h3",[e._v("Товары/услуги")])]),a("v-col",{attrs:{cols:"1"}},[a("v-btn",{attrs:{color:"primary",fab:"","x-small":""},on:{click:e.addNewItem}},[a("v-icon",[e._v("mdi-plus")])],1)],1)],1),e._l(e.itemsQuantity,(function(t){return[a("div",{key:t},[a("v-row",[a("v-col",{attrs:{cols:"1"}},[a("strong",{staticStyle:{"font-size":"20px"}},[e._v(e._s(t))])]),a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"Название",rules:e.reqRules,outlined:""},model:{value:e.newItems[t-1].name,callback:function(a){e.$set(e.newItems[t-1],"name",a)},expression:"newItems[i-1].name"}})],1),a("v-col",{attrs:{cols:"1"}},[a("v-btn",{attrs:{icon:""},on:{click:function(a){return e.deleteNewItem(t)}}},[a("v-icon",[e._v("mdi-close")])],1)],1)],1),a("v-row",[a("v-col",[a("v-text-field",{attrs:{type:"number",label:"Стоимость без налога",rules:e.reqRules,outlined:""},model:{value:e.newItems[t-1].price,callback:function(a){e.$set(e.newItems[t-1],"price",a)},expression:"newItems[i-1].price"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{type:"number",label:"Налог",rules:e.reqRules,outlined:""},model:{value:e.newItems[t-1].tax,callback:function(a){e.$set(e.newItems[t-1],"tax",a)},expression:"newItems[i-1].tax"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-text-field",{attrs:{type:"number",label:"Стоимость с налогом",outlined:"",disabled:""},domProps:{textContent:e._s((e.newItems[t-1].price*(1+e.newItems[t-1].tax/100)).toFixed(2))}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"Скидка",outlined:""},model:{value:e.newItems[t-1].discount,callback:function(a){e.$set(e.newItems[t-1],"discount",a)},expression:"newItems[i-1].discount"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-text-field",{attrs:{type:"number",label:"Стоимость со скидкой",outlined:"",disabled:""},domProps:{textContent:e._s((e.newItems[t-1].price*(1+e.newItems[t-1].tax/100)*(1-e.newItems[t-1].discount/100)).toFixed(2))}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"6"}},[a("v-text-field",{attrs:{type:"number",label:"Количество",outlined:"",rules:e.reqRules},model:{value:e.newItems[t-1].quantity,callback:function(a){e.$set(e.newItems[t-1],"quantity",a)},expression:"newItems[i-1].quantity"}})],1),a("v-col",{attrs:{cols:"6"}},[a("v-text-field",{attrs:{label:"Единицы измерения",outlined:"",rules:e.reqRules},model:{value:e.newItems[t-1].measurement,callback:function(a){e.$set(e.newItems[t-1],"measurement",a)},expression:"newItems[i-1].measurement"}})],1)],1)],1)]}))],2),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.addOffer}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление чеков ")]),a("v-card-text",[e._v("Вы действительно хотите удалить выбранные чеки? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteOffer}},[e._v("Подтвердить")])],1)],1)],1)],1)},Tn=[],Vn={name:"Offers",components:{Header:R},data:function(){return{offers:[],items:[],terms:[],clients:[],newOffer:{id:0,create_date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),active:!0,term:"",client:""},itemsQuantity:0,newItems:[],deletedItems:[],currentOffer:0,formTitle:"Добавление",addForm:!1,confirmDeleteDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}]}},created:function(){console.log("init Offers"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),-1===this.$parent.$parent.read.indexOf("Бухгалтерия")&&this.$router.push({name:"Index"}),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadClients(),this.loadTerms()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/offer",type:"GET",success:function(t){e.offers=t.data.data,e.items=t.data.items},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadClients:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"GET",success:function(t){e.clients=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadTerms:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/accounting/terms",type:"GET",success:function(t){e.terms=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},addOffer:function(){var e=this;this.$refs.form.validate()?(this.newOffer.items=JSON.stringify(this.newItems),0!==this.newOffer.id?this.putOffer():o.a.ajax({url:this.$hostname+"time-tracking/offer",type:"POST",data:this.newOffer,success:function(){e.loadData(),e.addForm=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})):(this.alertMsg="Заполните все необходимые поля",this.alertError=!0)},putOffer:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/offer",type:"PUT",data:this.newOffer,success:function(){e.putItems(),e.loadData(),e.addForm=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},deleteOffer:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/offer",type:"DELETE",data:{id:this.currentOffer},success:function(){e.loadData(),e.confirmDeleteDialog=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},putItems:function(){var e=this;this.newItems.forEach((function(t){void 0!==t.id&&o.a.ajax({url:e.$hostname+"time-tracking/item",type:"PUT",data:t,success:function(){console.log("товар отредактирован")},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})})),this.deletedItems.forEach((function(t){e.deleteItem(t)}))},deleteItem:function(e){var t=this;o.a.ajax({url:this.$hostname+"time-tracking/item",type:"DELETE",data:{sale_id:this.newSale.id,id:e.id},success:function(){console.log("товар удален")},error:function(e){switch(e.status){case 500:t.alertMsg="Ошибка соединения с сервером";break;case 400:t.alertMsg="Ошибка в данных";break;case 401:t.$refresh();break;case 403:t.alertMsg="Нет доступа";break;default:t.alertMsg="Непредвиденная ошибка"}t.alertError=!0}})},addNewItem:function(){this.itemsQuantity+=1,this.newItems.push({name:"",price:"",tax:"",discount:"",quantity:"",measurement:""})},deleteNewItem:function(e){void 0!==this.newItems[e-1].id&&this.deletedItems.push(this.newItems[e-1]),this.itemsQuantity=this.itemsQuantity-1,this.newItems.splice(e-1,1)},openAddForm:function(){this.newOffer={id:0,active:!0,term:"",client:""},this.itemsQuantity=0,this.newItems=[],this.formTitle="Добавление",this.addForm=!0},openEditForm:function(e){this.newOffer=e,this.itemsQuantity=this.items[e.id].length,this.newItems=this.items[e.id],this.formTitle="Редактирование",this.addForm=!0}}},jn=Vn,Fn=Object(m["a"])(jn,Sn,Tn,!1,null,"b2b99230",null),On=Fn.exports;v()(Fn,{VAlert:te["a"],VAutocomplete:Ha["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCol:wn["a"],VDialog:H["a"],VForm:ce["a"],VIcon:h["a"],VListItem:g["a"],VListItemTitle:k["c"],VRow:rt["a"],VSpacer:Qe["a"],VTextField:ue["a"],VToolbar:Ze["a"]});var An=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"offers flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("div",{staticClass:"summary-box__title"},[a("h1",[e._v("Ценовое предложение")]),a("div",{staticClass:"addition-btn",on:{click:function(t){return e.$router.push({name:"Offers"})}}},[a("span",[e._v("К списку предложений")]),a("back-icon")],1)]),a("div",{staticClass:"offers__content"},[-1!==e.$parent.$parent.edit.indexOf("Бухгалтерия")?a("div",{staticClass:"open__actions"},[a("div",{staticClass:"addition-btn",on:{click:function(t){e.addForm=!0}}},[a("edit-icon"),e._v(" Редактировать ")],1),a("div",{staticClass:"addition-btn",on:{click:function(t){e.confirmDeletePhotoDialog=!0}}},[a("waste-icon"),e._v(" Удалить ")],1)]):e._e(),a("div",{staticClass:"document_date"},[e._v("Дата создания: "+e._s(e.currentOffer.create_date))]),a("div",{staticClass:"document_date"},[e._v("Предложение "),e.currentOffer.active?e._e():a("span",[e._v("не")]),e._v(" "),a("span",[e._v("действует")])]),a("div",{staticClass:"document_date"},[e._v("Клиент: "+e._s(e.currentOffer.client.name))]),a("div",[e._v("Срок: "+e._s(e.currentOffer.term.days)+" дней")]),a("h3",[e._v("Товары:")]),a("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[e._v("№")]),a("th",{staticClass:"text-left"},[e._v("Название")]),a("th",{staticClass:"text-left"},[e._v("Стоимость без налога")]),a("th",{staticClass:"text-left"},[e._v("Налог")]),a("th",{staticClass:"text-left"},[e._v("Стоимость")]),a("th",{staticClass:"text-left"},[e._v("Скидка")]),a("th",{staticClass:"text-left"},[e._v("Количество")]),a("th",{staticClass:"text-left"},[e._v("Единицы измерения")]),a("th",{staticClass:"text-left"},[e._v("Итого")])])]),a("tfoot",[a("tr",[a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"},[e._v("Итого")]),a("th",{staticClass:"text-left"},[e._v(e._s(e.sum.price.toFixed(2)))])]),a("tr",[a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"},[e._v("Итого с налогом")]),a("th",{staticClass:"text-left"},[e._v(e._s(e.sum.tax.toFixed(2)))])]),a("tr",[a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"}),a("th",{staticClass:"text-left"},[e._v("Итого со скидкой")]),a("th",{staticClass:"text-left"},[e._v(e._s(e.sum.discount.toFixed(2)))])])]),a("tbody",e._l(e.items,(function(t,n){return a("tr",{key:t.name},[a("td",[e._v(e._s(n+1))]),a("td",[e._v(e._s(t.name))]),a("td",[e._v(e._s(t.price))]),a("td",[e._v(e._s(t.tax))]),a("td",[e._v(e._s((t.price*(1+t.tax/100)).toFixed(2)))]),a("td",[e._v(e._s(t.discount))]),a("td",[e._v(e._s(t.quantity))]),a("td",[e._v(e._s(t.measurement))]),a("td",[e._v(e._s((t.price*(1+t.tax/100)*(1-t.discount/100)*t.quantity).toFixed(2)))])])})),0)]},proxy:!0}])})],1)]),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"form",attrs:{model:e.currentOffer}},[a("v-row",[a("v-text-field",{attrs:{label:"Дата создания",disabled:""},model:{value:e.currentOffer.create_date,callback:function(t){e.$set(e.currentOffer,"create_date",t)},expression:"currentOffer.create_date"}}),a("v-checkbox",{attrs:{label:"Предложение действует"},model:{value:e.currentOffer.active,callback:function(t){e.$set(e.currentOffer,"active",t)},expression:"currentOffer.active"}})],1),a("v-row",[a("v-autocomplete",{attrs:{items:e.clients,"item-text":"name","item-value":"id",label:"Клиент",rules:e.reqRules,required:"",outlined:""},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-title",[e._v(" Клиенты не найдены ")])],1)]},proxy:!0}]),model:{value:e.currentOffer.client,callback:function(t){e.$set(e.currentOffer,"client",t)},expression:"currentOffer.client"}}),a("v-autocomplete",{attrs:{items:e.terms,"item-text":"days","item-value":"id",label:"Срок предложения",rules:e.reqRules,required:"",outlined:""},scopedSlots:e._u([{key:"no-data",fn:function(){return[a("v-list-item",[a("v-list-item-title",[e._v(" Сроки не найдены ")])],1)]},proxy:!0}]),model:{value:e.currentOffer.term,callback:function(t){e.$set(e.currentOffer,"term",t)},expression:"currentOffer.term"}})],1),a("v-row",[a("v-col",{attrs:{cols:"11"}},[a("h3",[e._v("Товары/услуги")])]),a("v-col",{attrs:{cols:"1"}},[a("v-btn",{attrs:{color:"primary",fab:"","x-small":""},on:{click:e.addNewItem}},[a("v-icon",[e._v("mdi-plus")])],1)],1)],1),e._l(e.itemsQuantity,(function(t){return[a("div",{key:t},[a("v-row",[a("v-col",{attrs:{cols:"1"}},[a("strong",{staticStyle:{"font-size":"20px"}},[e._v(e._s(t))])]),a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"Название",rules:e.reqRules,outlined:""},model:{value:e.newItems[t-1].name,callback:function(a){e.$set(e.newItems[t-1],"name",a)},expression:"newItems[i-1].name"}})],1),a("v-col",{attrs:{cols:"1"}},[a("v-btn",{attrs:{icon:""},on:{click:function(a){return e.deleteNewItem(t)}}},[a("v-icon",[e._v("mdi-close")])],1)],1)],1),a("v-row",[a("v-col",[a("v-text-field",{attrs:{type:"number",label:"Стоимость без налога",rules:e.reqRules,outlined:""},model:{value:e.newItems[t-1].price,callback:function(a){e.$set(e.newItems[t-1],"price",a)},expression:"newItems[i-1].price"}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{type:"number",label:"Налог",rules:e.reqRules,outlined:""},model:{value:e.newItems[t-1].tax,callback:function(a){e.$set(e.newItems[t-1],"tax",a)},expression:"newItems[i-1].tax"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-text-field",{attrs:{type:"number",label:"Стоимость с налогом",outlined:"",disabled:""},domProps:{textContent:e._s((e.newItems[t-1].price*(1+e.newItems[t-1].tax/100)).toFixed(2))}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"10"}},[a("v-text-field",{attrs:{label:"Скидка",outlined:""},model:{value:e.newItems[t-1].discount,callback:function(a){e.$set(e.newItems[t-1],"discount",a)},expression:"newItems[i-1].discount"}})],1),a("v-col",{attrs:{cols:"2"}},[a("v-text-field",{attrs:{type:"number",label:"Стоимость со скидкой",outlined:"",disabled:""},domProps:{textContent:e._s((e.newItems[t-1].price*(1+e.newItems[t-1].tax/100)*(1-e.newItems[t-1].discount/100)).toFixed(2))}})],1)],1),a("v-row",[a("v-col",{attrs:{cols:"6"}},[a("v-text-field",{attrs:{type:"number",label:"Количество",outlined:"",rules:e.reqRules},model:{value:e.newItems[t-1].quantity,callback:function(a){e.$set(e.newItems[t-1],"quantity",a)},expression:"newItems[i-1].quantity"}})],1),a("v-col",{attrs:{cols:"6"}},[a("v-text-field",{attrs:{label:"Единицы измерения",outlined:"",rules:e.reqRules},model:{value:e.newItems[t-1].measurement,callback:function(a){e.$set(e.newItems[t-1],"measurement",a)},expression:"newItems[i-1].measurement"}})],1)],1)],1)]}))],2),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.putOffer}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление чеков ")]),a("v-card-text",[e._v("Вы действительно хотите удалить выбранные чеки? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteOffer}},[e._v("Подтвердить")])],1)],1)],1)],1)},qn=[],Ln={name:"OffersOpen",components:{WasteIcon:De,EditIcon:Te,Header:R,BackIcon:qe},props:{id:[String,Number]},data:function(){return{items:[],terms:[],clients:[],currentOffer:{id:0,create_date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),active:!0,term:"",client:""},itemsQuantity:0,newItems:[],deletedItems:[],sum:{price:0,tax:0,discount:0},formTitle:"Добавление",addForm:!1,confirmDeleteDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}]}},created:function(){console.log("init Offer open"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),-1===this.$parent.$parent.read.indexOf("Бухгалтерия")&&this.$router.push({name:"Index"}),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadClients(),this.loadTerms()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/offer/"+this.id,type:"GET",success:function(t){e.currentOffer=t.data.data[0],e.items=t.data.items[e.id],e.newItems=t.data.items[e.id],e.itemsQuantity=t.data.items[e.id].length,e.sum={price:0,tax:0,discount:0},e.items.forEach((function(t){e.sum.price+=t.price*t.quantity,e.sum.tax+=t.price*(1+t.tax/100)*t.quantity,e.sum.discount+=t.price*(1+t.tax/100)*(1-t.discount/100)*t.quantity}))},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadClients:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/clients",type:"GET",success:function(t){e.clients=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadTerms:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/accounting/terms",type:"GET",success:function(t){e.terms=t.data.data},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},putOffer:function(){var e=this;this.$refs.form.validate()?(this.currentOffer.items=JSON.stringify(this.newItems),o.a.ajax({url:this.$hostname+"time-tracking/offer",type:"PUT",data:this.currentOffer,success:function(){e.putItems(),e.addForm=!1,e.loadData()},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})):(this.alertMsg="Заполните все необходимые поля",this.alertError=!0)},deleteOffer:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/offer",type:"DELETE",data:{id:this.currentOffer},success:function(){e.loadData(),e.confirmDeleteDialog=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},putItems:function(){var e=this;this.newItems.forEach((function(t){void 0!==t.id&&o.a.ajax({url:e.$hostname+"time-tracking/item",type:"PUT",data:t,success:function(){console.log("товар отредактирован")},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})})),this.deletedItems.forEach((function(t){e.deleteItem(t)}))},deleteItem:function(e){var t=this;o.a.ajax({url:this.$hostname+"time-tracking/item",type:"DELETE",data:{sale_id:this.newSale.id,id:e.id},success:function(){console.log("товар удален")},error:function(e){switch(e.status){case 500:t.alertMsg="Ошибка соединения с сервером";break;case 400:t.alertMsg="Ошибка в данных";break;case 401:t.$refresh();break;case 403:t.alertMsg="Нет доступа";break;default:t.alertMsg="Непредвиденная ошибка"}t.alertError=!0}})},addNewItem:function(){this.itemsQuantity+=1,this.newItems.push({name:"",price:"",tax:"",discount:"",quantity:"",measurement:""})},deleteNewItem:function(e){void 0!==this.newItems[e-1].id&&this.deletedItems.push(this.newItems[e-1]),this.itemsQuantity=this.itemsQuantity-1,this.newItems.splice(e-1,1)}}},Rn=Ln,Wn=Object(m["a"])(Rn,An,qn,!1,null,"2a082761",null),Nn=Wn.exports;v()(Wn,{VAlert:te["a"],VAutocomplete:Ha["a"],VBtn:G["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCheckbox:ae["a"],VCol:wn["a"],VDialog:H["a"],VForm:ce["a"],VIcon:h["a"],VListItem:g["a"],VListItemTitle:k["c"],VRow:rt["a"],VSimpleTable:En["a"],VSpacer:Qe["a"],VTextField:ue["a"],VToolbar:Ze["a"]});var Gn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("h1",[e._v("Календарь")]),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(t){e.formTitle="Добавление",e.addForm=!0}}},[e._v("Добавить событие")]),a("div",{staticClass:"calendar"},[a("v-row",{staticClass:"fill-height"},[a("v-col",[a("v-sheet",{attrs:{height:"64"}},[a("v-toolbar",{attrs:{flat:""}},[a("v-btn",{staticClass:"mr-4",attrs:{outlined:"",color:"grey darken-2"},on:{click:e.setToday}},[e._v(" Сегодня ")]),a("v-btn",{attrs:{fab:"",text:"",small:"",color:"grey darken-2"},on:{click:function(t){return e.$refs.calendar.prev()}}},[a("v-icon",{attrs:{small:""}},[e._v(" mdi-chevron-left")])],1),a("v-btn",{attrs:{fab:"",text:"",small:"",color:"grey darken-2"},on:{click:function(t){return e.$refs.calendar.next()}}},[a("v-icon",{attrs:{small:""}},[e._v(" mdi-chevron-right")])],1),e.$refs.calendar?a("v-toolbar-title",[e._v(" "+e._s(e.$refs.calendar.title)+" ")]):e._e(),a("v-spacer"),a("v-menu",{attrs:{bottom:"",right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({attrs:{outlined:"",color:"grey darken-2"}},"v-btn",s,!1),n),[a("span",[e._v(e._s(e.typeToLabel[e.type]))]),a("v-icon",{attrs:{right:""}},[e._v(" mdi-menu-down")])],1)]}}])},[a("v-list",[a("v-list-item",{on:{click:function(t){e.type="day"}}},[a("v-list-item-title",[e._v(" День")])],1),a("v-list-item",{on:{click:function(t){e.type="month"}}},[a("v-list-item-title",[e._v("Месяц")])],1)],1)],1)],1)],1),a("v-sheet",{attrs:{height:"600"}},[a("v-calendar",{ref:"calendar",attrs:{color:"primary",events:e.events,type:e.type},on:{"click:event":e.showEvent,"click:more":e.viewDay,"click:date":e.viewDay},model:{value:e.focus,callback:function(t){e.focus=t},expression:"focus"}}),a("v-menu",{attrs:{"close-on-content-click":!1,activator:e.selectedElement,"offset-x":""},model:{value:e.selectedOpen,callback:function(t){e.selectedOpen=t},expression:"selectedOpen"}},[a("v-card",{attrs:{color:"grey lighten-4","min-width":"350px",flat:""}},[a("v-toolbar",{attrs:{color:e.selectedEvent.color,dark:""}},[a("v-toolbar-title",{domProps:{innerHTML:e._s(e.selectedEvent.name)}}),a("v-spacer"),e.selectedEvent.edit?a("v-btn",{attrs:{icon:""},on:{click:e.openEditForm}},[a("v-icon",[e._v("mdi-pencil")])],1):e._e(),e.selectedEvent.edit?a("v-btn",{attrs:{icon:""},on:{click:function(t){e.confirmDeleteDialog=!0}}},[a("v-icon",[e._v("mdi-delete")])],1):e._e()],1),a("v-card-text",[a("div",{domProps:{innerHTML:e._s(e.selectedEvent.description)}})]),a("v-card-actions",[a("v-btn",{attrs:{text:"",color:"secondary"},on:{click:function(t){e.selectedOpen=!1}}},[e._v(" Закрыть ")])],1)],1)],1)],1)],1)],1)],1)],1),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"form",attrs:{model:e.newEvent}},[e.$parent.$parent.admin?a("h3",[e._v("Для кого событие")]):e._e(),a("v-row",[e.$parent.$parent.admin?a("v-checkbox",{attrs:{label:"Для себя",disabled:null!==e.newEvent.group||null!==e.newEvent.profile||e.newEvent.all},model:{value:e.newEvent.self,callback:function(t){e.$set(e.newEvent,"self",t)},expression:"newEvent.self"}}):e._e(),e.$parent.$parent.admin?a("v-checkbox",{attrs:{label:"Для всех",disabled:null!==e.newEvent.group||null!==e.newEvent.profile||e.newEvent.self},model:{value:e.newEvent.all,callback:function(t){e.$set(e.newEvent,"all",t)},expression:"newEvent.all"}}):e._e()],1),a("v-row",[e.$parent.$parent.admin?a("v-autocomplete",{attrs:{label:"Для группы",items:e.groups,"item-text":"name","item-value":"id",rules:e.userGroupRules,disabled:null!==e.newEvent.profile||e.newEvent.self||e.newEvent.all,clearable:""},model:{value:e.newEvent.group,callback:function(t){e.$set(e.newEvent,"group",t)},expression:"newEvent.group"}}):e._e(),e.$parent.$parent.admin?a("v-autocomplete",{attrs:{label:"Для пользователя",items:e.profiles,"item-text":"label","item-value":"id",rules:e.userGroupRules,disabled:null!==e.newEvent.group||e.newEvent.self||e.newEvent.all,clearable:""},model:{value:e.newEvent.profile,callback:function(t){e.$set(e.newEvent,"profile",t)},expression:"newEvent.profile"}}):e._e()],1),a("v-text-field",{attrs:{label:"Название",rules:e.reqRules},model:{value:e.newEvent.name,callback:function(t){e.$set(e.newEvent,"name",t)},expression:"newEvent.name"}}),a("h3",[e._v("Сроки")]),a("v-checkbox",{attrs:{label:"Весь день"},model:{value:e.newEvent.allDay,callback:function(t){e.$set(e.newEvent,"allDay",t)},expression:"newEvent.allDay"}}),a("v-row",[a("v-menu",{ref:"dateStartMenu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата",readonly:"",outlined:"",rules:e.reqRules},model:{value:e.newEvent.date_start,callback:function(t){e.$set(e.newEvent,"date_start",t)},expression:"newEvent.date_start"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.dateStartMenu,callback:function(t){e.$set(e.menus,"dateStartMenu",t)},expression:"menus.dateStartMenu"}},[a("v-date-picker",{on:{input:function(t){e.menus.dateStartMenu=!1}},model:{value:e.newEvent.date_start,callback:function(t){e.$set(e.newEvent,"date_start",t)},expression:"newEvent.date_start"}})],1),e.newEvent.allDay?e._e():a("v-menu",{ref:"menuStartTime",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.newEvent.time_start,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.newEvent,"time_start",t)},"update:return-value":function(t){return e.$set(e.newEvent,"time_start",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Время",readonly:"",outlined:"",rules:e.reqRules,required:""},model:{value:e.newEvent.time_start,callback:function(t){e.$set(e.newEvent,"time_start",t)},expression:"newEvent.time_start"}},"v-text-field",s,!1),n))]}}],null,!1,416351944),model:{value:e.menus.timeStartMenu,callback:function(t){e.$set(e.menus,"timeStartMenu",t)},expression:"menus.timeStartMenu"}},[e.menus.timeStartMenu?a("v-time-picker",{attrs:{"full-width":"",format:"24hr"},on:{"click:minute":function(t){return e.$refs.menuStartTime.save(e.newEvent.time_start)}},model:{value:e.newEvent.time_start,callback:function(t){e.$set(e.newEvent,"time_start",t)},expression:"newEvent.time_start"}}):e._e()],1)],1),a("v-row",[a("v-menu",{ref:"dateEndMenu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата конца",readonly:"",outlined:""},model:{value:e.newEvent.date_end,callback:function(t){e.$set(e.newEvent,"date_end",t)},expression:"newEvent.date_end"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.dateEndMenu,callback:function(t){e.$set(e.menus,"dateEndMenu",t)},expression:"menus.dateEndMenu"}},[a("v-date-picker",{on:{input:function(t){e.menus.dateEndMenu=!1}},model:{value:e.newEvent.date_end,callback:function(t){e.$set(e.newEvent,"date_end",t)},expression:"newEvent.date_end"}})],1),e.newEvent.allDay?e._e():a("v-menu",{ref:"menuEndTime",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.newEvent.time_end,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.newEvent,"time_end",t)},"update:return-value":function(t){return e.$set(e.newEvent,"time_end",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Время конца",readonly:"",outlined:"",required:""},model:{value:e.newEvent.time_end,callback:function(t){e.$set(e.newEvent,"time_end",t)},expression:"newEvent.time_end"}},"v-text-field",s,!1),n))]}}],null,!1,2658553592),model:{value:e.menus.timeEndMenu,callback:function(t){e.$set(e.menus,"timeEndMenu",t)},expression:"menus.timeEndMenu"}},[e.menus.timeEndMenu?a("v-time-picker",{attrs:{"full-width":"",format:"24hr"},on:{"click:minute":function(t){return e.$refs.menuEndTime.save(e.newEvent.time_end)}},model:{value:e.newEvent.time_end,callback:function(t){e.$set(e.newEvent,"time_end",t)},expression:"newEvent.time_end"}}):e._e()],1)],1),a("v-autocomplete",{attrs:{items:e.colors,label:"Цвет",rules:e.reqRules},scopedSlots:e._u([{key:"item",fn:function(t){return[a("v-list-item-avatar",[a("v-chip",{attrs:{color:t.item}})],1),a("v-list-item-content",[a("v-list-item-title",[e._v(e._s(t.item))])],1)]}}]),model:{value:e.newEvent.color,callback:function(t){e.$set(e.newEvent,"color",t)},expression:"newEvent.color"}}),a("v-textarea",{attrs:{label:"Описание"},model:{value:e.newEvent.description,callback:function(t){e.$set(e.newEvent,"description",t)},expression:"newEvent.description"}})],1),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.addEvent}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление события ")]),a("v-card-text",[e._v("Вы действительно хотите удалить выбранное событие? Отменить это действие будет невозможно ")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteEvent}},[e._v("Подтвердить")])],1)],1)],1)],1)},Bn=[],zn=(a("99af"),a("a4d3"),a("e01a"),{name:"Calendar",components:{Header:R},data:function(){return{events:[],groups:[],profiles:[],focus:"",type:"month",typeToLabel:{month:"Месяц",day:"День"},selectedEvent:{},selectedElement:null,selectedOpen:!1,colors:["blue","indigo","deep-purple","cyan","green","orange","grey darken-1"],newEvent:{id:0,self:!1,all:!1,group:null,profile:null,name:"",date_start:"",time_start:"",date_end:"",time_end:"",allDay:!1,color:"",description:""},menus:{dateStartMenu:!1,dateEndMenu:!1,timeStartMenu:!1,timeEndMenu:!1},formTitle:"Добавление",addForm:!1,confirmDeleteDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}]}},computed:{userGroupRules:function(){var e=this,t=[],a=function(t){return!!t||!!e.newEvent.group||!!e.newEvent.profile||e.newEvent.self||e.newEvent.all||"Выберите для кого событие"};return t.push(a),t}},mounted:function(){this.$refs.calendar.checkChange()},created:function(){console.log("init Calendar"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadGroups(),this.loadProfiles()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{loadData:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/calendar",type:"GET",success:function(t){var a=t.data.edit;a.forEach((function(e){e.edit=!0}));var n=t.data.data;n.forEach((function(e){e.edit=!1})),e.events=a.concat(n),e.events.forEach((function(e){e.allDay?(e.start=e.start.substr(0,10),null===e.end?e.end=e.start.substr(0,10):e.end=e.end.substr(0,10)):(e.start=e.start.substr(0,10)+" "+e.start.substr(11,5),null!==e.end&&(e.end=e.end.substr(0,10)+" "+e.end.substr(11,5))),e.timed=!e.allDay}))},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadGroups:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/groups",type:"GET",success:function(t){e.groups=t.data.groups},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},loadProfiles:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/profiles/active",type:"GET",success:function(t){e.profiles=t.data.data,e.profiles.forEach((function(e){e.label=e.lastname+" "+e.name+", "+e.position.name}))},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},addEvent:function(){var e=this;this.$refs.form.validate()?((this.newEvent.self||this.newEvent.all)&&(this.newEvent.group=null,this.newEvent.profile=null),this.newEvent.start=null,this.newEvent.end=null,this.newEvent.allDay?(this.newEvent.start=this.newEvent.date_start+" 00:00",""!==this.newEvent.date_end&&(this.newEvent.end=this.newEvent.date_end+" 00:00")):(this.newEvent.start=this.newEvent.date_start+" "+this.newEvent.time_start,""!==this.newEvent.date_end&&(this.newEvent.end=this.newEvent.date_end+" "+this.newEvent.time_end)),this.newEvent.id?this.putEvent():o.a.ajax({url:this.$hostname+"time-tracking/calendar",type:"POST",data:{self:this.newEvent.self,group:this.newEvent.group,profile:this.newEvent.profile,name:this.newEvent.name,start:this.newEvent.start,end:this.newEvent.end,allDay:this.newEvent.allDay,color:this.newEvent.color,description:this.newEvent.description},success:function(){e.loadData(),e.addForm=!1,e.newEvent={self:!1,group:null,profile:null,name:"",date_start:"",time_start:"",date_end:"",time_end:"",allDay:!1,color:"",description:""}},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})):(this.alertMsg="Заполните все необходимые поля",this.alertError=!0)},putEvent:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/calendar",type:"PUT",data:{id:this.newEvent.id,group:this.newEvent.group,profile:this.newEvent.profile,name:this.newEvent.name,start:this.newEvent.start,end:this.newEvent.end,allDay:this.newEvent.allDay,color:this.newEvent.color,description:this.newEvent.description},success:function(){e.loadData(),e.addForm=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},deleteEvent:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/calendar",type:"DELETE",data:{id:this.selectedEvent.id},success:function(){e.loadData(),e.confirmDeleteDialog=!1},error:function(t){switch(t.status){case 500:e.alertMsg="Ошибка соединения с сервером";break;case 400:e.alertMsg="Ошибка в данных";break;case 401:e.$refresh();break;case 403:e.alertMsg="Нет доступа";break;default:e.alertMsg="Непредвиденная ошибка"}e.alertError=!0}})},openEditForm:function(){this.newEvent=this.selectedEvent,this.newEvent.date_start=this.newEvent.start.substr(0,10),this.newEvent.time_start=this.newEvent.start.substr(11,5),null!==this.newEvent.end?(this.newEvent.date_end=this.newEvent.end.substr(0,10),this.newEvent.time_end=this.newEvent.end.substr(11,5)):(this.newEvent.date_end="",this.newEvent.time_end=""),null==this.newEvent.group&&null==this.newEvent.profile&&(this.newEvent.all=!0),this.addForm=!0},viewDay:function(e){var t=e.date;this.focus=t,this.type="day"},getEventColor:function(e){return e.color},setToday:function(){this.focus=""},showEvent:function(e){var t=this,a=e.nativeEvent,n=e.event,s=function(){t.selectedEvent=n,t.selectedElement=a.target,requestAnimationFrame((function(){return requestAnimationFrame((function(){return t.selectedOpen=!0}))}))};this.selectedOpen?(this.selectedOpen=!1,requestAnimationFrame((function(){return requestAnimationFrame((function(){return s()}))}))):s(),a.stopPropagation()}}}),Un=zn,Hn=a("a4f6"),Qn=a("cc20"),Zn=a("8dd9"),Yn=a("2a7f"),Kn=Object(m["a"])(Un,Gn,Bn,!1,null,"13f2fdc2",null),Xn=Kn.exports;v()(Kn,{VAlert:te["a"],VAutocomplete:Ha["a"],VBtn:G["a"],VCalendar:Hn["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCheckbox:ae["a"],VChip:Qn["a"],VCol:wn["a"],VDatePicker:at["a"],VDialog:H["a"],VForm:ce["a"],VIcon:h["a"],VList:_["a"],VListItem:g["a"],VListItemAvatar:ht["a"],VListItemContent:k["a"],VListItemTitle:k["c"],VMenu:it["a"],VRow:rt["a"],VSheet:Zn["a"],VSpacer:Qe["a"],VTextField:ue["a"],VTextarea:Q["a"],VTimePicker:Qa["a"],VToolbar:Ze["a"],VToolbarTitle:Yn["a"]});var Jn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"timing flex-content"},[a("Header"),a("section",{staticClass:"summary-box"},[a("h1",[e._v("Отчетность по проделанной работе")]),void 0===e.id?a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:function(t){e.addForm=!0,e.formTitle="Добавление"}}},[e._v(" Добавить ")]):e._e(),a("div",{staticClass:"calendar"},[a("v-row",{staticClass:"fill-height"},[a("v-col",[a("v-sheet",{attrs:{height:"64"}},[a("v-toolbar",{attrs:{flat:""}},[a("v-btn",{attrs:{fab:"",text:"",small:"",color:"grey darken-2"},on:{click:function(t){return e.$refs.calendar.prev()}}},[a("v-icon",{attrs:{small:""}},[e._v(" mdi-chevron-left")])],1),a("v-btn",{attrs:{fab:"",text:"",small:"",color:"grey darken-2"},on:{click:function(t){return e.$refs.calendar.next()}}},[a("v-icon",{attrs:{small:""}},[e._v(" mdi-chevron-right")])],1),e.$refs.calendar?a("v-toolbar-title",[e._v(" "+e._s(e.$refs.calendar.title)+" ")]):e._e(),a("v-spacer"),"all"===e.id?a("v-menu",{attrs:{bottom:"",right:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({attrs:{outlined:"",color:"grey darken-2"}},"v-btn",s,!1),n),[a("span",[e._v(e._s(e.typeToLabel[e.type]))]),a("v-icon",{attrs:{right:""}},[e._v(" mdi-menu-down")])],1)]}}],null,!1,998467913)},[a("v-list",[a("v-list-item",{on:{click:function(t){e.type="day"}}},[a("v-list-item-title",[e._v(" День")])],1),a("v-list-item",{on:{click:function(t){e.type="month"}}},[a("v-list-item-title",[e._v("Месяц")])],1)],1)],1):e._e()],1)],1),a("v-sheet",{attrs:{height:"600"}},[a("v-calendar",{ref:"calendar",attrs:{color:e.colors,events:e.timings,type:e.type},on:{"click:event":e.showEvent,"click:more":e.viewDay,"click:date":e.viewDay},model:{value:e.focus,callback:function(t){e.focus=t},expression:"focus"}}),a("v-menu",{attrs:{"close-on-content-click":!1,activator:e.selectedElement,"offset-x":""},model:{value:e.selectedOpen,callback:function(t){e.selectedOpen=t},expression:"selectedOpen"}},[a("v-card",{attrs:{color:"grey lighten-4","min-width":"350px",flat:""}},[a("v-toolbar",{attrs:{color:"primary",dark:""}},[a("v-toolbar-title",{domProps:{innerHTML:e._s(e.selectedEvent.position)}}),a("v-spacer"),e.$parent.$parent.admin?a("v-btn",{attrs:{icon:""},on:{click:function(t){e.newTiming=e.selectedEvent,e.addForm=!0,e.formTitle="Редактирование"}}},[a("v-icon",[e._v("mdi-pencil")])],1):e._e(),e.$parent.$parent.admin?a("v-btn",{attrs:{icon:""},on:{click:function(t){e.confirmDeleteDialog=!0}}},[a("v-icon",[e._v("mdi-delete")])],1):e._e()],1),a("v-card-text",[a("div",[e._v(e._s(e.selectedEvent.date)+" "+e._s(e.selectedEvent.time_start)+"-"+e._s(e.selectedEvent.time_end))]),a("span",{domProps:{innerHTML:e._s(e.selectedEvent.comment)}})]),a("v-card-actions",[a("v-btn",{attrs:{text:"",color:"secondary"},on:{click:function(t){e.selectedOpen=!1}}},[e._v(" Закрыть ")])],1)],1)],1)],1)],1)],1)],1)],1),a("v-dialog",{model:{value:e.addForm,callback:function(t){e.addForm=t},expression:"addForm"}},[a("v-card",[a("v-toolbar",{attrs:{flat:""}},[a("v-spacer"),a("v-btn",{attrs:{icon:""},on:{click:function(t){e.addForm=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1),a("h3",[e._v(e._s(e.formTitle))]),a("v-card-text",[a("v-form",{ref:"form",attrs:{model:e.newTiming}},[a("v-row",[a("v-menu",{ref:"dateMenu",attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Дата",readonly:"",outlined:"",rules:e.reqRules},model:{value:e.newTiming.date,callback:function(t){e.$set(e.newTiming,"date",t)},expression:"newTiming.date"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.dateMenu,callback:function(t){e.$set(e.menus,"dateMenu",t)},expression:"menus.dateMenu"}},[a("v-date-picker",{attrs:{"allowed-dates":e.allowedDates},on:{input:function(t){e.menus.dateMenu=!1}},model:{value:e.newTiming.date,callback:function(t){e.$set(e.newTiming,"date",t)},expression:"newTiming.date"}})],1)],1),a("v-autocomplete",{attrs:{label:"Выберите объект",items:e.objects,"item-text":"label","item-value":"id",rules:e.reqRules},model:{value:e.newTiming.objects_id,callback:function(t){e.$set(e.newTiming,"objects_id",t)},expression:"newTiming.objects_id"}}),a("v-combobox",{attrs:{label:"Профиль работ",items:e.positions,rules:e.reqRules},model:{value:e.newTiming.position,callback:function(t){e.$set(e.newTiming,"position",t)},expression:"newTiming.position"}}),a("v-row",[a("v-menu",{ref:"menuStartTime",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.newTiming.time_start,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.newTiming,"time_start",t)},"update:return-value":function(t){return e.$set(e.newTiming,"time_start",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Время начала",readonly:"",outlined:"",rules:e.reqRules,required:""},model:{value:e.newTiming.time_start,callback:function(t){e.$set(e.newTiming,"time_start",t)},expression:"newTiming.time_start"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.timeStartMenu,callback:function(t){e.$set(e.menus,"timeStartMenu",t)},expression:"menus.timeStartMenu"}},[e.menus.timeStartMenu?a("v-time-picker",{attrs:{"full-width":"",format:"24hr"},on:{"click:minute":function(t){return e.$refs.menuStartTime.save(e.newTiming.time_start)}},model:{value:e.newTiming.time_start,callback:function(t){e.$set(e.newTiming,"time_start",t)},expression:"newTiming.time_start"}}):e._e()],1),a("v-menu",{ref:"menuEndTime",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":e.newTiming.time_end,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(t){return e.$set(e.newTiming,"time_end",t)},"update:return-value":function(t){return e.$set(e.newTiming,"time_end",t)}},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,s=t.attrs;return[a("v-text-field",e._g(e._b({attrs:{label:"Время окончания",readonly:"",outlined:"",required:""},model:{value:e.newTiming.time_end,callback:function(t){e.$set(e.newTiming,"time_end",t)},expression:"newTiming.time_end"}},"v-text-field",s,!1),n))]}}]),model:{value:e.menus.timeEndMenu,callback:function(t){e.$set(e.menus,"timeEndMenu",t)},expression:"menus.timeEndMenu"}},[e.menus.timeEndMenu?a("v-time-picker",{attrs:{"full-width":"",format:"24hr",min:e.newTiming.time_start},on:{"click:minute":function(t){return e.$refs.menuEndTime.save(e.newTiming.time_end)}},model:{value:e.newTiming.time_end,callback:function(t){e.$set(e.newTiming,"time_end",t)},expression:"newTiming.time_end"}}):e._e()],1)],1),a("v-textarea",{attrs:{label:"Описание"},model:{value:e.newTiming.comment,callback:function(t){e.$set(e.newTiming,"comment",t)},expression:"newTiming.comment"}})],1),a("v-alert",{attrs:{"close-text":"Закрыть",color:"error",dismissible:""},model:{value:e.alertError,callback:function(t){e.alertError=t},expression:"alertError"}},[e._v(" "+e._s(e.alertMsg)+" ")])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"action-btn",attrs:{color:"primary"},on:{click:e.openConfirmAdd}},[e._v("Сохранить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmAddDialog,callback:function(t){e.confirmAddDialog=t},expression:"confirmAddDialog"}},[a("v-card",[a("v-card-title",[e._v(" Подтверждение ")]),a("v-card-text",[e._v("Проверьте корректность всех данных. Внести изменения сможет только администратор")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmAddDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.addTiming}},[e._v("Подтвердить")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500"},model:{value:e.confirmDeleteDialog,callback:function(t){e.confirmDeleteDialog=t},expression:"confirmDeleteDialog"}},[a("v-card",[a("v-card-title",[e._v(" Удаление путевого листа ")]),a("v-card-text",[e._v("Вы действительно хотите удалить часовой отчет? Отменить это действие будет невозможно")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"secondary",text:""},on:{click:function(t){e.confirmDeleteDialog=!1}}},[e._v("Отменить")]),a("v-btn",{attrs:{color:"primary",text:""},on:{click:e.deleteTiming}},[e._v("Подтвердить")])],1)],1)],1)],1)},es=[],ts={name:"Timing",components:{Header:R},props:{id:[String,Number,void 0]},data:function(){return{timings:[],objects:[],positions:[],newTiming:{id:0,date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),time_start:"",time_end:"",position:"",objects_id:"",user_profile_id:null,comment:""},colors:["blue","indigo","deep-purple","cyan","green","orange","grey darken-1","yellow","pink","lime"],focus:"",type:"month",selectedEvent:{},selectedOpen:!1,selectedElement:null,typeToLabel:{month:"Месяц",day:"День"},menus:{dateMenu:!1,timeStartMenu:!1,timeEndMenu:!1},formTitle:"",addForm:!1,confirmAddDialog:!1,confirmDeleteDialog:!1,alertError:!1,alertMsg:"",reqRules:[function(e){return!!e||"Необходимо заполнить поле"}]}},created:function(){console.log("init Timing"),localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")?(this.$emit("set-auth"),this.$emit("load-functions"),o.a.ajaxSetup({headers:{Authorization:"Token "+(localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token"))}}),this.loadData(),this.loadObjects(),this.loadPositions()):(this.$emit("set-not-auth"),this.$router.push({name:"Index"}))},methods:{allowedDates:function(e){return e<=(new Date).toISOString()},loadData:function(){var e=this,t="time-tracking/time-reports";switch(this.id){case void 0:this.colors="primary";break;case"all":t+="/all",this.colors="primary";break;default:t+="/"+this.id,this.colors="primary";break}o.a.ajax({url:this.$hostname+t,type:"GET",success:function(t){e.timings=t.data.data,e.timings.forEach((function(t){t.start=t.date+" "+t.time_start,t.end=t.date+" "+t.time_end,"all"===e.id&&(t.name=t.user_profile_id.lastname+" "+t.user_profile_id.name+" ("+t.user_profile_id.position.name+")")}))},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadObjects:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/objects",type:"GET",success:function(t){e.objects=t.data.data,e.objects.forEach((function(e){e.label=e.city+" "+e.street+" "+e.house}))},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},loadPositions:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/time-reports-positions",type:"GET",success:function(t){e.positions=t.data.positions},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},openConfirmAdd:function(){this.$refs.form.validate()?this.$parent.$parent.admin?this.addTiming():this.confirmAddDialog=!0:(this.alertMsg="Заполните все необходимые поля",this.alertError=!0)},addTiming:function(){var e=this;0!==this.newTiming.id?this.putTiming():o.a.ajax({url:this.$hostname+"time-tracking/time-reports",type:"POST",data:this.newTiming,success:function(){e.loadData(),e.loadPositions(),e.addForm=!1,e.confirmAddDialog=!1,e.newTiming={date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),time_start:"",time_end:"",position:"",objects_id:"",user_profile_id:"",comment:""}},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},putTiming:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/time-reports",type:"PUT",data:this.newTiming,success:function(){e.loadData(),e.loadPositions(),e.addForm=!1,e.confirmAddDialog=!1,e.newTiming={date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),time_start:"",time_end:"",position:"",objects_id:"",user_profile_id:"",comment:""}},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},deleteTiming:function(){var e=this;o.a.ajax({url:this.$hostname+"time-tracking/time-reports",type:"DELETE",data:{id:this.selectedEvent.id},success:function(){e.loadData(),e.loadPositions(),e.confirmDeleteDialog=!1},error:function(t){500===t.status?e.alertMsg="Ошибка соединения с сервером":401===t.status?e.$refresh():e.alertMsg="Непредвиденная ошибка",e.alertError=!0}})},viewDay:function(e){var t=e.date;"all"===this.id&&(this.focus=t,this.type="day")},showEvent:function(e){var t=this,a=e.nativeEvent,n=e.event,s=function(){t.selectedEvent=n,t.selectedElement=a.target,requestAnimationFrame((function(){return requestAnimationFrame((function(){return t.selectedOpen=!0}))}))};this.selectedOpen?(this.selectedOpen=!1,requestAnimationFrame((function(){return requestAnimationFrame((function(){return s()}))}))):s(),a.stopPropagation()},getEventColor:function(e){return e.color}}},as=ts,ns=Object(m["a"])(as,Jn,es,!1,null,"bcd21bb4",null),ss=ns.exports;v()(ns,{VAlert:te["a"],VAutocomplete:Ha["a"],VBtn:G["a"],VCalendar:Hn["a"],VCard:B["a"],VCardActions:z["a"],VCardText:z["b"],VCardTitle:z["c"],VCol:wn["a"],VCombobox:vt["a"],VDatePicker:at["a"],VDialog:H["a"],VForm:ce["a"],VIcon:h["a"],VList:_["a"],VListItem:g["a"],VListItemTitle:k["c"],VMenu:it["a"],VRow:rt["a"],VSheet:Zn["a"],VSpacer:Qe["a"],VTextField:ue["a"],VTextarea:Q["a"],VTimePicker:Qa["a"],VToolbar:Ze["a"],VToolbarTitle:Yn["a"]}),n["a"].use(T["a"]);var is=[{path:"/",name:"Index",component:Y},{path:"/login",name:"Login",component:me},{path:"/recover",name:"RecoverPassword",component:be},{path:"/profile",name:"Profile",component:se},{path:"/time-reports",name:"Timing",component:ss},{path:"/time-reports/:id",name:"ProfileTiming",component:ss,props:!0},{path:"/news",name:"News",component:Ke},{path:"/objects",name:"Objects",component:ct},{path:"/workers",name:"Workers",component:_t},{path:"/workers/:id",name:"WorkerOpen",component:ya,props:!0},{path:"/documents/:type&:id",name:"Documents",component:yt,props:!0},{path:"/documents/:type",name:"DocumentsOwn",component:yt,props:!0},{path:"/news/:id",name:"NewOpen",component:It,props:!0},{path:"/clients",name:"Clients",component:Ot},{path:"/clients/:id",name:"ClientOpen",component:Qt,props:!0},{path:"/contacts",name:"Contacts",component:ea},{path:"/clients/contacts/:idClient",name:"ClientsEmployees",component:ea,props:!0},{path:"/contacts/:id",name:"ContactOpen",component:ra,props:!0},{path:"/calendar",name:"Calendar",component:Xn},{path:"/settings",name:"Settings",component:ba},{path:"/groups",name:"Groups",component:ma},{path:"/waybill",name:"Waybill",component:Ya},{path:"/waybill/:id",name:"WaybillOpen",component:an,props:!0},{path:"/purchases",name:"Purchases",component:cn},{path:"/purchases/:id",name:"PurchaseOpen",component:hn,props:!0},{path:"/sales",name:"Sales",component:Cn},{path:"/sales/:id",name:"SalesOpen",component:In,props:!0},{path:"/offers",name:"Offers",component:On},{path:"/offers/:id",name:"OffersOpen",component:Nn,props:!0},{path:"/positions-:table",name:"Positions",component:Ia,props:!0},{path:"/categories-:table",name:"Categories",component:Ia,props:!0},{path:"/goals-:table",name:"Goals",component:Ia,props:!0},{path:"/accounting/:type",name:"Accounting",component:Oa,props:!0},{path:"/accounting/:type/:id",name:"AccountingOpen",component:Na,props:!0},{path:"/add-:table",name:"IntegerField",component:Ia,props:!0}],rs=new T["a"]({routes:is}),os=rs,ls=a("f309"),cs={badge:"знак",close:"Закрыть",dataIterator:{noResultsText:"Не найдено подходящих записей",loadingText:"Запись загружается..."},dataTable:{itemsPerPageText:"Строк на странице:",ariaLabel:{sortDescending:"Упорядочено по убыванию.",sortAscending:"Упорядочено по возрастанию.",sortNone:"Не упорядочено.",activateNone:"Активируйте, чтобы убрать сортировку.",activateDescending:"Активируйте для упорядочивания убыванию.",activateAscending:"Активируйте для упорядочивания по возрастанию."},sortBy:"Сортировать по"},dataFooter:{itemsPerPageText:"Записей на странице:",itemsPerPageAll:"Все",nextPage:"Следующая страница",prevPage:"Предыдущая страница",firstPage:"Первая страница",lastPage:"Последняя страница",pageText:"{0}-{1} из {2}"},datePicker:{itemsSelected:"{0} выбран",nextMonthAriaLabel:"Следующий месяц",nextYearAriaLabel:"Следующий год",prevMonthAriaLabel:"Прошлый месяц",prevYearAriaLabel:"Предыдущий год"},noDataText:"Отсутствуют данные",carousel:{prev:"Предыдущий слайд",next:"Следующий слайд",ariaLabel:{delimiter:"Слайд {0} из {1}"}},calendar:{moreEvents:"Еще {0}"},fileInput:{counter:"Файлов: {0}",counterSize:"Файлов: {0} (всего {1})"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{wrapper:"Навигация по страницам",next:"Следующая страница",previous:"Предыдущая страница",page:"Перейти на страницу {0}",currentPage:"Текущая страница, Страница {0}"}},rating:{ariaLabel:{icon:"Rating {0} of {1}"}},index:{h1Label:"Главная",hello:"Добро пожаловать, ",todayLabel:"На сегодня",statistics:{news:{label:"Новости: ",text:"новостей"},workers:{label:"Работники: ",all:"работников",new:"Новых на сегодня",text:"Работает: "},clients:{label:"Клиенты: ",all:"клиентов",new:"Новых на сегодня"},objects:{label:"Объекты: ",all:"обектов",text:"В работе"},calendar:{label:"Календарь: ",all:"событий",week:"На этой неделе",today:"Сегодня"}}},widgets:{h1Label:"Виджеты",noteLabel:"Блокнот",lastSave:"Последнее сохранение"},settings:{h1Label:"Настройки",selectThemeLabel:"Тема",selectLangLabel:"Язык"}},us={badge:"Badge",close:"Close",dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},datePicker:{itemsSelected:"{0} selected",nextMonthAriaLabel:"Next month",nextYearAriaLabel:"Next year",prevMonthAriaLabel:"Previous month",prevYearAriaLabel:"Previous year"},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{wrapper:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Goto Page {0}",currentPage:"Current Page, Page {0}"}},rating:{ariaLabel:{icon:"Rating {0} of {1}"}},index:{h1Label:"Main",hello:"Welcome, ",todayLabel:"Today",statistics:{news:{label:"News: ",text:"news"},workers:{label:"Workers: ",all:"workers",new:"New for today",text:"At work: "},clients:{label:"Clients: ",all:"clients",new:"New for today"},objects:{label:"Objects: ",all:"objects",text:"At work"},calendar:{label:"Calendar: ",all:"events",week:"This week",today:"Today"}}},widgets:{h1Label:"Widgets",noteLabel:"Note",lastSave:"Last save"},settings:{h1Label:"Settings",selectThemeLabel:"Theme",selectLangLabel:"Language"}},ds=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{attrs:{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M32.1563 26.8481L26.467 23.1502L28.6119 19.2178C29.1119 18.2995 29.3742 17.2707 29.375 16.2251V10C29.375 7.67936 28.4531 5.45376 26.8122 3.81282C25.1712 2.17187 22.9456 1.25 20.625 1.25C18.3044 1.25 16.0788 2.17187 14.4378 3.81282C12.7969 5.45376 11.875 7.67936 11.875 10V16.2251C11.8758 17.2707 12.1381 18.2996 12.6381 19.2179L14.7831 23.1502L9.09376 26.8481C8.21939 27.4142 7.50093 28.1904 7.00413 29.1059C6.50733 30.0214 6.24805 31.0468 6.25001 32.0884V38.75H35V32.0884C35.002 31.0469 34.7427 30.0214 34.2459 29.1059C33.7491 28.1904 33.0306 27.4142 32.1563 26.8481ZM32.5 36.25H8.75001V32.0884C8.74884 31.4635 8.90442 30.8482 9.20252 30.2989C9.50061 29.7496 9.9317 29.2838 10.4563 28.9442L18.086 23.9849L14.8329 18.0208C14.5329 17.4698 14.3755 16.8525 14.375 16.2251V10C14.375 8.3424 15.0335 6.75269 16.2056 5.58058C17.3777 4.40848 18.9674 3.75 20.625 3.75C22.2826 3.75 23.8723 4.40848 25.0444 5.58058C26.2165 6.75269 26.875 8.3424 26.875 10V16.2251C26.8745 16.8525 26.7171 17.4698 26.4171 18.0208L23.1641 23.9849L30.7939 28.9442C31.3185 29.2839 31.7495 29.7496 32.0476 30.2989C32.3457 30.8482 32.5012 31.4635 32.5 32.0884V36.25Z",fill:"#333333"}})])},ms=[],fs={name:"loginIcon"},vs=fs,hs=Object(m["a"])(vs,ds,ms,!1,null,"3fd92f9f",null),ps=hs.exports,_s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{attrs:{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M30 15.625V11.25C30 8.59784 28.9464 6.0543 27.0711 4.17893C25.1957 2.30357 22.6522 1.25 20 1.25C17.3478 1.25 14.8043 2.30357 12.9289 4.17893C11.0536 6.0543 10 8.59784 10 11.25V15.625H6.875V25.625C6.875 32.8621 12.7628 38.75 20 38.75C27.2372 38.75 33.125 32.8621 33.125 25.625V15.625H30ZM12.5 11.25C12.5 9.26088 13.2902 7.35322 14.6967 5.9467C16.1032 4.54018 18.0109 3.75 20 3.75C21.9891 3.75 23.8968 4.54018 25.3033 5.9467C26.7098 7.35322 27.5 9.26088 27.5 11.25V15.625H12.5V11.25ZM30.625 25.625C30.625 31.4836 25.8586 36.25 20 36.25C14.1414 36.25 9.375 31.4836 9.375 25.625V18.125H30.625V25.625Z",fill:"#333333"}})])},bs=[],gs={name:"passwordIcon"},ks=gs,ws=Object(m["a"])(ks,_s,bs,!1,null,"3d899d96",null),xs=ws.exports,Cs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{attrs:{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M19 1L1 19M1 1L19 19",stroke:"#616161","stroke-linecap":"round"}})])},ys=[],$s={name:"deleteIcon"},Ds=$s,Ps=Object(m["a"])(Ds,Cs,ys,!1,null,"66f72e37",null),Es=Ps.exports,Ms=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M10.3338 18.3501C10.1038 18.3501 9.94877 18.3726 9.86877 18.3951V19.8676C9.96377 19.8901 10.0825 19.8963 10.2463 19.8963C10.845 19.8963 11.2138 19.5938 11.2138 19.0826C11.2138 18.6251 10.8963 18.3501 10.3338 18.3501ZM14.6925 18.3651C14.4425 18.3651 14.28 18.3876 14.1838 18.4101V21.6726C14.28 21.6951 14.435 21.6951 14.575 21.6951C15.5963 21.7026 16.2613 21.1401 16.2613 19.9501C16.2688 18.9126 15.6625 18.3651 14.6925 18.3651Z",fill:"#616161"}}),a("path",{attrs:{d:"M17.5 2.5H7.5C6.83696 2.5 6.20107 2.76339 5.73223 3.23223C5.26339 3.70107 5 4.33696 5 5V25C5 25.663 5.26339 26.2989 5.73223 26.7678C6.20107 27.2366 6.83696 27.5 7.5 27.5H22.5C23.163 27.5 23.7989 27.2366 24.2678 26.7678C24.7366 26.2989 25 25.663 25 25V10L17.5 2.5ZM11.8725 20.2375C11.4863 20.6 10.9162 20.7625 10.2525 20.7625C10.1238 20.7639 9.99516 20.7564 9.8675 20.74V22.5225H8.75V17.6025C9.25432 17.5273 9.7639 17.493 10.2737 17.5C10.97 17.5 11.465 17.6325 11.7987 17.8988C12.1163 18.1513 12.3312 18.565 12.3312 19.0525C12.33 19.5425 12.1675 19.9563 11.8725 20.2375ZM16.6313 21.9313C16.1063 22.3675 15.3075 22.575 14.3313 22.575C13.7463 22.575 13.3325 22.5375 13.0513 22.5V17.6038C13.5558 17.5301 14.0652 17.4954 14.575 17.5C15.5212 17.5 16.1363 17.67 16.6163 18.0325C17.135 18.4175 17.46 19.0313 17.46 19.9125C17.46 20.8663 17.1112 21.525 16.6313 21.9313ZM21.25 18.4625H19.335V19.6013H21.125V20.5188H19.335V22.5238H18.2025V17.5375H21.25V18.4625ZM17.5 11.25H16.25V5L22.5 11.25H17.5Z",fill:"#616161"}})])},Is=[],Ss={name:"pdfIcon"},Ts=Ss,Vs=Object(m["a"])(Ts,Ms,Is,!1,null,"6bec5be6",null),js=Vs.exports,Fs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{attrs:{width:"74",height:"74",viewBox:"0 0 74 74",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M37 1V73M73 37L1 37",stroke:"#616161","stroke-width":"2","stroke-linecap":"round"}})])},Os=[],As={name:"addNewIcon"},qs=As,Ls=Object(m["a"])(qs,Fs,Os,!1,null,"432a762a",null),Rs=Ls.exports,Ws=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{attrs:{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M7.5 1.25009C4.05375 1.25009 1.25 4.05384 1.25 7.50009V10.0895C1.25 10.7295 2.43562 11.2501 3.125 11.2501H3.75C3.91576 11.2501 4.07473 11.1842 4.19194 11.067C4.30915 10.9498 4.375 10.7909 4.375 10.6251V7.41072C4.375 7.24496 4.30915 7.08598 4.19194 6.96877C4.07473 6.85156 3.91576 6.78572 3.75 6.78572H3.1825C3.53 4.36697 4.98625 3.12509 7.5 3.12509C10.0138 3.12509 11.47 4.36697 11.8175 6.78572H11.25C11.0842 6.78572 10.9253 6.85156 10.8081 6.96877C10.6908 7.08598 10.625 7.24496 10.625 7.41072V11.2501C10.625 11.9395 10.0644 11.8751 9.375 11.8751H8.75V11.2501H6.25V13.1251H9.375C10.7537 13.1251 11.875 12.6288 11.875 11.2501C12.5644 11.2501 13.75 10.7295 13.75 10.0895V7.50009C13.75 4.05384 10.9462 1.25009 7.5 1.25009Z",fill:"white"}})])},Ns=[],Gs={name:"supportIcon"},Bs=Gs,zs=Object(m["a"])(Bs,Ws,Ns,!1,null,"6a6441d6",null),Us=zs.exports,Hs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("svg",{attrs:{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M7.03125 2.8125V6.5625C7.03129 6.62407 7.01919 6.68504 6.99565 6.74193C6.9721 6.79882 6.93758 6.85051 6.89404 6.89404C6.85051 6.93758 6.79882 6.9721 6.74193 6.99565C6.68504 7.01919 6.62407 7.03129 6.5625 7.03125H2.8125C2.75093 7.03129 2.68996 7.01919 2.63307 6.99565C2.57618 6.9721 2.52449 6.93758 2.48096 6.89404C2.43742 6.85051 2.4029 6.79882 2.37935 6.74193C2.35581 6.68504 2.34371 6.62407 2.34375 6.5625V2.8125C2.34371 2.75093 2.35581 2.68996 2.37935 2.63307C2.4029 2.57618 2.43742 2.52449 2.48096 2.48096C2.52449 2.43742 2.57618 2.4029 2.63307 2.37935C2.68996 2.35581 2.75093 2.34371 2.8125 2.34375H6.5625C6.62407 2.34371 6.68504 2.35581 6.74193 2.37935C6.79882 2.4029 6.85051 2.43742 6.89404 2.48096C6.93758 2.52449 6.9721 2.57618 6.99565 2.63307C7.01919 2.68996 7.03129 2.75093 7.03125 2.8125ZM12.1875 2.34375H8.4375C8.37593 2.34371 8.31496 2.35581 8.25807 2.37935C8.20118 2.4029 8.14949 2.43742 8.10596 2.48096C8.06242 2.52449 8.0279 2.57618 8.00435 2.63307C7.98081 2.68996 7.96871 2.75093 7.96875 2.8125V6.5625C7.96871 6.62407 7.98081 6.68504 8.00435 6.74193C8.0279 6.79882 8.06242 6.85051 8.10596 6.89404C8.14949 6.93758 8.20118 6.9721 8.25807 6.99565C8.31496 7.01919 8.37593 7.03129 8.4375 7.03125H12.1875C12.2491 7.03129 12.31 7.01919 12.3669 6.99565C12.4238 6.9721 12.4755 6.93758 12.519 6.89404C12.5626 6.85051 12.5971 6.79882 12.6206 6.74193C12.6442 6.68504 12.6563 6.62407 12.6562 6.5625V2.8125C12.6563 2.75093 12.6442 2.68996 12.6206 2.63307C12.5971 2.57618 12.5626 2.52449 12.519 2.48096C12.4755 2.43742 12.4238 2.4029 12.3669 2.37935C12.31 2.35581 12.2491 2.34371 12.1875 2.34375ZM6.5625 7.96875H2.8125C2.75093 7.96871 2.68996 7.98081 2.63307 8.00435C2.57618 8.0279 2.52449 8.06242 2.48096 8.10596C2.43742 8.14949 2.4029 8.20118 2.37935 8.25807C2.35581 8.31496 2.34371 8.37593 2.34375 8.4375V12.1875C2.34371 12.2491 2.35581 12.31 2.37935 12.3669C2.4029 12.4238 2.43742 12.4755 2.48096 12.519C2.52449 12.5626 2.57618 12.5971 2.63307 12.6206C2.68996 12.6442 2.75093 12.6563 2.8125 12.6562H6.5625C6.62407 12.6563 6.68504 12.6442 6.74193 12.6206C6.79882 12.5971 6.85051 12.5626 6.89404 12.519C6.93758 12.4755 6.9721 12.4238 6.99565 12.3669C7.01919 12.31 7.03129 12.2491 7.03125 12.1875V8.4375C7.03129 8.37593 7.01919 8.31496 6.99565 8.25807C6.9721 8.20118 6.93758 8.14949 6.89404 8.10596C6.85051 8.06242 6.79882 8.0279 6.74193 8.00435C6.68504 7.98081 6.62407 7.96871 6.5625 7.96875ZM12.1875 7.96875H8.4375C8.37593 7.96871 8.31496 7.98081 8.25807 8.00435C8.20118 8.0279 8.14949 8.06242 8.10596 8.10596C8.06242 8.14949 8.0279 8.20118 8.00435 8.25807C7.98081 8.31496 7.96871 8.37593 7.96875 8.4375V12.1875C7.96871 12.2491 7.98081 12.31 8.00435 12.3669C8.0279 12.4238 8.06242 12.4755 8.10596 12.519C8.14949 12.5626 8.20118 12.5971 8.25807 12.6206C8.31496 12.6442 8.37593 12.6563 8.4375 12.6562H12.1875C12.2491 12.6563 12.31 12.6442 12.3669 12.6206C12.4238 12.5971 12.4755 12.5626 12.519 12.519C12.5626 12.4755 12.5971 12.4238 12.6206 12.3669C12.6442 12.31 12.6563 12.2491 12.6562 12.1875V8.4375C12.6563 8.37593 12.6442 8.31496 12.6206 8.25807C12.5971 8.20118 12.5626 8.14949 12.519 8.10596C12.4755 8.06242 12.4238 8.0279 12.3669 8.00435C12.31 7.98081 12.2491 7.96871 12.1875 7.96875Z",fill:"white"}})])},Qs=[],Zs={name:"tileIcon"},Ys=Zs,Ks=Object(m["a"])(Ys,Hs,Qs,!1,null,"6bf1ee0b",null),Xs=Ks.exports;n["a"].use(ls["a"]);var Js=new ls["a"]({lang:{locales:{ru:cs,en:us},current:"ru"},theme:{themes:{options:{customProperties:!0},light:{primary:"#3D6FB6",secondary:"#616161",text:{primary:"#333333",secondary:"#616161"}},dark:{primary:"#2A3C52",secondary:"#344D69",text:{primary:"#FFFFFF"}}}},icons:{values:{addNew:{component:Rs},addPhoto:{component:Be},archive:{component:Bt},deleteIcon:{component:Es},edit:{component:Te},login:{component:ps},password:{component:xs},pdf:{component:js},support:{component:Us},tile:{component:Xs},waste:{component:De}}}}),ei=a("2004"),ti=a.n(ei);n["a"].config.productionTip=!1,new n["a"]({router:os,vuetify:Js,render:function(e){return e(S)}}).$mount("#app"),n["a"].use(ti.a,{name:"v-editor",editorConfig:{uploadImgUrl:"/api/upload",printLog:!1,useLang:"en"},uploadHandler:function(e,t){if("success"===e){var a=JSON.parse(t);return 1!==a.status?null:a.data}return"error"===e?alert("Ошибка загрузки"):"timeout"===e&&alert("Время ожидания превышено"),"upload failed__"}})},"6d44":function(e,t){throw new Error("Module parse failed: Unexpected character '�' (1:0)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n(Source code omitted for this binary file)")},"742d":function(e,t,a){},"75a7":function(e,t){throw new Error("Module parse failed: Unexpected character '' (1:2)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n(Source code omitted for this binary file)")},"7f19":function(e,t,a){e.exports=a.p+"img/about.png"},8083:function(e,t,a){e.exports=a.p+"img/reviews1.png"},8396:function(e,t){throw new Error("Module parse failed: Unexpected token (1:3)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n> 1. Надо ли отрасли добавлять как специальности?\n| \n| 1. Обязательно несколько файлов - посмотреть, как парсяться из file-input")},"85ec":function(e,t,a){},"8b2d":function(e,t,a){e.exports=a.p+"img/9445bb5d2187e2812c79db70cf.jpg"},"937c":function(e,t,a){e.exports=a.p+"img/avatar.jpg"},"98c6":function(e,t,a){e.exports=a.p+"img/20211226_153257 - Гендальф Серый.jpg"},a0e2:function(e,t,a){e.exports=a.p+"img/pic_1.jpg"},a42f:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAABcCAYAAABtNZskAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAveSURBVHgB7V0NcBRnGX4C4UdIaaAhQBrIBQppxBIqpdjyk/CnFIeKMkBpmYEwVgYo4IiKipBMiQoOKrWOSgoGUKx1xkZkOiClTToOScAWYvnRIk0o/lVaE5pUoKRwfZ9+u5PrsXe7l5/b3eN7Zp65u91vN3f77vt+799+ATQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQSGLeEvO8ivNV4NdFd2BM+QFckBiiQq2HbUoSXhVnCJOF14TXhUOP9/cYYXoM+wiZhD2FfYTKUUP8PDyAJ/gUv5PsW2wdCackg4cegLvwnhGeFd0EJ5U/C4cLzwtHGMTnCNGE1lNB3C5uN4xrhIvwsJBO88PwdQWFvKKHw81HhOOEA4UnhEmEqlJCoNfVQGsXxdwtbhLcb72kWewn/JqwUviD8M5SWnUSc4WchDYMSEO98ahUFQM3ihX4Qyqw9Jfwk1IWdAKUp56BMHX87tYkaR8G9AyWwM8b5uhvnojbyBmgwSOE/ASW0uMCPQuomnCZ8XRiA0gje4elQF5/adNV4/SeU4KgVr0KZrveEecKPC4cY++40zk3BU1AtxvaLUMKnkEKvFc9ZI1wqPI1Ohl+ExO+ZKcyAMlV/NbZz7rgPygHgHT9G+Avh36Eu5DWH579NOFWYbZwjH0qTUqMcQ8FR4N8XlkFp6E0Lel68iKZL3d94pZlaISwUFgj7oeMwA0rYFESL8WrHx3ETgmaNAkkP2ca5gwKjeZpsvO9M0H3fBGdCIotwE4HmjXOKGWxSi2jSBgtH4KOCiwcCwgNwJqifQs1nNxUoGE7o9NI4/3SDe/ge1JwYLpjrYZ/XogPh5YwDtYVxzni0ZgHoSTXDPTBeoodIM5sdsj3cAaMTwgD4CDoAXvPuqCWMZcwYiN4TPbm/CC/BO2AMRoEFoox5AypeexXthJeERHd3LpQ3xfiEweUF4Sl4EwHh76DMcCQwFLgX6vf4HoyBdgrLoTSmVLgKKvbxMgJQwXQ0R+JbSADQcysTLhAegjIP34XKBvgBAeEJRBdUIXwMZhDmQKVpmAj9IZRjcC/8hVwoRyGSkN5G9OyFp5EF9eXzhaOEzwlXw5/4EqJr0y60EW664BQOgz6zahqAcm2fgXIY/IZXoObQCRH2c979LXzkRDB7YEblrN9QOM9CmT4/g0nZ44isTc+gDXBLkx6CEhTjIAaFDP6oUU9CRe9+BbPudH6+COvMCK0H61HnEQO6IP5gVpulaubmOCexj4B1oJdhXQ73G1jn2hxhH4uIdyBGuCEk5uKqoITE7AIF8z/h80gc/Bgq42CFDYgRbgiJtvkKWuclvrKS+l8kDugc7Iywj+Y9HzEg3kKiutOTozb9QzhS+BvhXiQetiKyJ/dZxIB4C4kCosbQzN1u/H2augokHiig7RH23YcYEG8hscctAFVA+zdUdfUAEhfsfwhabM9GDIi3kDgX0e1mMyJTP6wTRYvER6ekpBQkJydPys/Pn1hSUnJPWVlZAO3A3LlzRweDwVsdDqfL/A3hnh49ehzKycmpmDJlyu7NmzfPlnM4qb6+JXzJYjutyGB4FJ+GisinC38v/GOUsawp1c6aNSu4cOHCx1JTU1mbeaRLly4lgUDgufT09OPjxo0rX7FixUNywQbBGV6aPZvXNzjdbuCAAQNWr1mz5tDBgwfHm9tEwIwrvyzfoX7GjBnn9+/fvwL2oJNgFdjeBY/iASgTx2CWgesjNuN3rly5skUuaqTkJPNl/1q0aFG9jCmIfirkZmVlBQcNGkQhrYk2cNKkSdt37dq1UcZFsjQB4YuLFy8OHj169H7Yg82Z4UJ6EB4EXW0GsguhgtdfCx+2OWbu/PnzeVEnRhnDZsaX5S5/Q8aNjzRI7v4fVVdX/0pM55nS0lIKNdlqXJ8+fYqOHTv2S9iDJqtp27ZtDQ7Gfh03CukBeBDsWaAGsU70GeGLwi/YHFPIu1WQYzNurDB49uzZsgj7A2vXrqUQA/J+yZgxY3jOz1mN27Bhw9vGOCfYKnMUzzXWZhwD9/BSRh48CE7W1CSakNnCPVAaFQ2zV61adU0uwgjYo7GioqLWasfYsWNLT58+vT5kU0N5eXmlxdDdtbW1kQRthYdpQgVOyiuMm0wBmX3njhBP744VWCYdM42/y8dR7EzFlVGjRp1LSko6A3tcbG5ubrHYni2Ox/Tc3NySkG1P7Nu3L18ubujdnCRaMSsvL68czrG/f//+jIfedDCWWf4rxnveCO/Bg2DllV02VP1vCr8Kezc0x/DGRtuMS5e5JFhfX18avmPmzJnlcvwNaZh+/fqdq6qqejJkU4G4+ZHMYCSkdO3atUKOKXYwlprDMjrNnp15/AjiqUm9jb/HRhO2abFA1t3mGKeu9Yx58+ZdFNc89KJDLuCjRUVFl0QTb4hVGhoaSvfs2fNYiOd46cKFD2uNsXTHpknsxBvohM04/k5qDjUogDg+NhMr2Nd9m8FZUGVyOyHcXVBQcF0u5OQoY5Ik0KwTzy08/zdHYqvg0KFDTwifX7Bgwc8yMzOLxLsrkn0bRKCvyPbGurq6jcZ4zpmNNTU1f4BzfGXLli3nHIzrDZ+Apo53HWtIP4fqsbNT+9Rp06a9JUKaGWF/ckZGxnYJOivCPbKePXsWHzlyZHu0k8uY76xbt+5yiDZVy/xFR2UC7BEoLCysd2geTSFxTnbsMLgBCofxApvwqe6PCifaHDNcLkRjhDlphLjSL2zdunWTRbA7VFxpBsFpNue/Iy0t7U2ZyzYZn/OpfUuXLq2yccMDMn+9durUqaWIDWxGvQUeBp0Emhbm62ia9kF5eNEwceTIkZzMF4dsK5CUzA/mzJnzrKRsLB0KmSeOHz58uBjOsLe4uLg+RNDLhMH169cfsxBUryFDhqyU2O2AmMlJcA6a+l4GPS0k4vNQTZAsT9QJ74kylhmKn8i8EZw6derTgwcP3iKas2v58uWPNzU13RnluI1hF90Oq8Vk8kb4Wsi2xQMHDjwwbNiw63TJs7Ozvy0sWbZs2VOVlZWTERv6Gq/mYzxOk7uugU2EzDYw7cJy+bhog2XOCAizduzYkQHnSI1BQB+ONzLjVseMFkejQFJTeTFkzsNBz65vyOeY56R4N+zzy7IRg3EL4ya64SthXXNJFPA308wxPmI3UcxBbLxbuhhxMxhZjtamSH5pJxkFv4JZEN6MFBK1KuaOKDcaUQJQyVVOoBRSLKbMj+DvNF3wy2gD3BAS83XUJua8mDilI5EIK7NYwVzT6HW0A24IifV9xkwsofPOomuei8QDBcQSi5lUHY42wo02Y9M2MyXE7DGfpuCcdByJBfPRUjND7qQ4aAk3hMSJ06yp0NthLwMDQyZB/fg0hRVoocybsAXthFsN+xQSfwRjBiZc+aPYxVqDxAB/H5cSaLeA3AaXmTHXC3oaqlkj5mZ2H6DdCVU3HAcT9Hrehept4wKAXChwL3z82KKB0Mw+U0HtrsC6KSS64Iwh2BP+GtR6QXxuZwn8i0+hdZVJ5h6voAPg9oootNtMmdDzYYsVHwBmA2U9YnzQygNgYM5OKK47QYfoKhIQdMv5YPN8qLV5PNuGawHe7CybdEoZwktrC/HuYxM/q6K043ws5iQ82lUTBgqIms+wghahQx8pdXNOsgJjJbqt/4FyKjLhffDBbC5PYwarHf5IqRdX6eKDv3TLmTJivYlmjwtwvAPvgd4b13nt1PnHi0KiJrFqS8HQO6K2Z4V8drquameCeTneSHFZL9yLQjKfpWVKhfMRXXTesSwSmubPzQUrKCAW8pjCYu9Cpy/x5kUh0XSYdRdqD5cQ4GTMWIrLRJvfuQnxh5nC4vfhd/TSGnyuI7xPQMOjMJ8nSjFe4+GZJoX8PY0YQY/PXBaGHqCVq27XZ24FT3aX+rVsTQFw7qIzwVQSGz3eNfZxzqJppCCvGfvZY8C0DWMZOiL0IFmQ64fW/0XBOa9byHk0OghWvXDRUjMUaoYxxmuBfEKjZ9h7Woe2eK167vEItIeooaGhoaGhERXmQk10u+n9hTsPnvfqPgATmDq6CwvgbQAAAABJRU5ErkJggg=="},a637:function(e,t,a){e.exports=a.p+"img/9445bb5d2187e2812c79db70cf.jpg"},b153:function(e,t){throw new Error("Module parse failed: Unexpected token (1:0)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n(Source code omitted for this binary file)")},b700:function(e,t,a){e.exports=a.p+"img/itmo_logo_white_rus.png"},bc3f:function(e,t){throw new Error("Module parse failed: Unexpected token (1:0)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n(Source code omitted for this binary file)")},c5df:function(e,t){throw new Error("Module parse failed: Unexpected token (1:7)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n(Source code omitted for this binary file)")},c887:function(e,t,a){e.exports=a.p+"img/9445bb5d2187e2812c79db70cf.jpg"},cf05:function(e,t,a){e.exports=a.p+"img/logo.png"},d40c:function(e,t){throw new Error("Module parse failed: Unexpected token (1:0)\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\n(Source code omitted for this binary file)")},e7d2:function(e,t,a){"use strict";a("f262")},f262:function(e,t,a){},fc28:function(e,t,a){"use strict";a("742d")}});
//# sourceMappingURL=app.js.map